<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">
    
    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-refinancing-pinjaman/" />
    
    <meta name="description" content="Loan Refinance Calculator. Calculate potential savings, monthly difference, and break-even points when replacing your existing loan with a new one featuring lower interest rates." />
    <meta name="keywords" content="Loan Refinance Calculator, Mortgage Refinancing Tool, Debt Consolidation Calculator, Kalkulator Refinancing Pinjaman, Oper Kredit Rumah, Take Over Kredit, Hitung Penghematan Bunga, Simulasi Ganti Bank, should I refinance, cara hitung keuntungan take over kredit, is refinancing worth it">
    
    <link rel="icon" href="data:,">
 
    <title id="appTitle">Loan Refinance Calculator</title>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>
    
    <style>
        /* STANDAR TAMPILAN: Hard Lock 50% untuk Desktop */
        @media (min-width: 1024px) {
            .layout-article-fixed {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 50% !important;
                margin-left: auto;
                margin-right: auto;
            }
        }

        /* Transisi Hasil */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 3000px; 
            padding: 1.5rem; 
        }
        
        /* Tombol Utama */
        .calculate-button {
            box-shadow: 0 4px #15803d; /* green-700 */
            background-color: #16a34a; /* green-600 */
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px #15803d;
            background-color: #22c55e; /* green-500 */
        }
        .calculate-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #15803d;
        }

        /* Gaya Khusus untuk Kartu Input */
        .loan-card {
            border-top-width: 4px;
            padding: 1.25rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .old-loan-border { border-top-color: #f97316; background-color: #fff7ed; } /* orange-500 / orange-50 */
        .new-loan-border { border-top-color: #3b82f6; background-color: #eff6ff; } /* blue-500 / blue-50 */
        
        /* Gaya untuk tampilan hasil (Savings Card) */
        .savings-card {
            background-color: #ecfdf5; /* green-50 */
            border: 2px solid #34d399; /* green-400 */
        }
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <script>window.headerCategory = 'finance';</script>
    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex flex-col items-center">
        <div class="w-full layout-article-fixed bg-white shadow-xl rounded-xl p-6 sm:p-8">
            
            <h1 id="headerTitle" class="text-3xl font-extrabold text-gray-900 mb-3 text-center">Loan Refinance Calculator</h1>
            
            <p id="toolSubtitle" class="text-sm text-gray-700 font-medium mb-6 leading-relaxed text-justify">
                Calculate the potential savings and break-even point when refinancing your existing loan (e.g., KPR or Auto Loan) with a new loan.
            </p>
            
            <form id="refinanceForm" onsubmit="calculateRefinance(event)" class="space-y-6">
                
                <div class="loan-card old-loan-border">
                    <h2 class="text-xl font-bold mb-4 text-orange-600" id="headerOldLoan">1. Existing Loan Details</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        <div class="relative">
                            <label for="oldBalance" class="block text-sm font-medium text-gray-700 mb-1">
                                <span id="labelOldBalance">Current Outstanding Balance</span> <span class="currency-label font-normal text-gray-500">(Rp/$)</span>
                            </label>
                            <input type="text" id="oldBalance" inputmode="numeric" value="300.000.000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descOldBalance">Principal balance to pay off.</p>
                        </div>
                        
                        <div class="relative">
                            <label for="oldRate" class="block text-sm font-medium text-gray-700 mb-1" id="labelOldRate">Current Annual Interest Rate (%)</label>
                            <input type="number" id="oldRate" min="0" step="0.1" value="10" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descOldRate">Effective annual rate.</p>
                        </div>
                        
                        <div class="relative">
                            <label for="oldPayment" class="block text-sm font-medium text-gray-700 mb-1">
                                <span id="labelOldPayment">Current Monthly Payment</span> <span class="currency-label font-normal text-gray-500">(Rp/$)</span>
                            </label>
                            <input type="text" id="oldPayment" inputmode="numeric" value="3.200.000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descOldPayment">Your current monthly installment.</p>
                        </div>
                        
                        <div class="relative">
                            <label for="oldTermMonthsRemaining" class="block text-sm font-medium text-gray-700 mb-1" id="labelOldTerm">Remaining Term (Months)</label>
                            <input type="number" id="oldTermMonthsRemaining" min="1" step="1" value="180" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descOldTerm">Months left on old loan.</p>
                        </div>
                    </div>
                </div>

                <div class="loan-card new-loan-border mt-6">
                    <h2 class="text-xl font-bold mb-4 text-blue-600" id="headerNewLoan">2. Proposed New Loan Details</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

                        <div class="relative">
                            <label for="newRate" class="block text-sm font-medium text-gray-700 mb-1" id="labelNewRate">New Annual Interest Rate (%)</label>
                            <input type="number" id="newRate" min="0" step="0.1" value="8" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descNewRate">Proposed effective annual rate.</p>
                        </div>
                        
                        <div class="relative">
                            <label for="newTermMonths" class="block text-sm font-medium text-gray-700 mb-1" id="labelNewTerm">New Loan Term (Months)</label>
                            <input type="number" id="newTermMonths" min="1" step="1" value="240" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descNewTerm">Duration of the new loan.</p>
                        </div>
                        
                        <div class="relative md:col-span-2">
                            <label for="refinanceCosts" class="block text-sm font-medium text-gray-700 mb-1">
                                <span id="labelRefinanceCosts">Total Refinancing Costs</span> <span class="currency-label font-normal text-gray-500">(Rp/$)</span>
                            </label>
                            <input type="text" id="refinanceCosts" inputmode="numeric" value="5.000.000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                            <p class="text-xs text-gray-500 mt-1" id="descRefinanceCosts">Total upfront costs (origination, notary, penalty, etc.).</p>
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full text-white font-semibold py-3 rounded-xl text-lg">
                    Calculate Refinance Savings
                </button>
                
                <div id="errorAlert" class="hidden mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative">
                    <span id="errorText">Please complete all fields.</span>
                </div>
            </form>

            <div id="resultBox" class="result-box mt-8 bg-gray-50 border border-gray-200 rounded-xl shadow-lg">
                
                <h3 id="resultHeader" class="text-2xl font-bold mb-6 text-gray-800 border-b pb-2">Refinance Analysis Results</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    
                    <div class="savings-card p-4 rounded-lg col-span-1 md:col-span-3 text-center shadow-sm">
                        <p id="labelNetSavings" class="text-lg font-bold text-green-800 mb-1">Net Savings Over Remaining Term</p>
                        <p id="netSavingsResult" class="text-4xl font-extrabold text-green-600">0</p>
                        <p id="recommendationText" class="text-sm font-medium mt-2 text-green-700">Refinancing is highly recommended!</p>
                    </div>

                    <div class="p-4 bg-white rounded-lg shadow-md border-t-2 border-orange-500">
                        <p id="labelOldPaymentSummary" class="text-sm font-medium text-gray-700 mb-1 text-orange-600">Old Monthly Payment</p>
                        <p id="oldPaymentSummary" class="text-2xl font-bold text-orange-600">0</p>
                    </div>
                    
                    <div class="p-4 bg-white rounded-lg shadow-md border-t-2 border-blue-500">
                        <p id="labelNewPaymentSummary" class="text-sm font-medium text-gray-700 mb-1 text-blue-600">New Monthly Payment</p>
                        <p id="newPaymentSummary" class="text-2xl font-bold text-blue-600">0</p>
                    </div>
                    
                    <div class="p-4 bg-white rounded-lg shadow-md border-t-2 border-green-500">
                        <p id="labelMonthlyDifference" class="text-sm font-medium text-gray-700 mb-1 text-green-600">Monthly Savings/Cost</p>
                        <p id="monthlyDifferenceResult" class="text-2xl font-bold text-green-600">0</p>
                    </div>
                </div>

                <h3 id="detailHeader" class="text-xl font-bold text-gray-800 border-b pb-2 mb-4">Detailed Analysis</h3>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-100 p-4 rounded-lg space-y-2">
                        <p class="font-bold text-gray-700" id="labelTotalInterestPaid">Total Interest Paid:</p>
                        <p class="text-sm flex justify-between">
                            <span id="labelOldInterest">Old Loan Interest:</span>
                            <span id="oldInterestResult" class="font-semibold text-orange-600">0</span>
                        </p>
                         <p class="text-sm flex justify-between">
                            <span id="labelNewInterest">New Loan Interest:</span>
                            <span id="newInterestResult" class="font-semibold text-blue-600">0</span>
                        </p>
                        <p class="text-sm flex justify-between border-t pt-2 mt-2">
                            <span id="labelInterestSavings" class="font-bold">Interest Savings:</span>
                            <span id="interestSavingsResult" class="font-bold text-green-600">0</span>
                        </p>
                    </div>

                    <div class="bg-gray-100 p-4 rounded-lg space-y-2">
                        <p class="font-bold text-gray-700" id="labelBreakEven">Break-Even Point</p>
                         <p class="text-base flex justify-between">
                            <span id="labelRefinanceCost">Refinancing Cost:</span>
                            <span id="refinanceCostSummary" class="font-semibold text-red-600">0</span>
                        </p>
                        <p class="text-base flex justify-between border-t pt-2 mt-2">
                            <span id="labelBreakEvenMonths" class="font-bold">Break-Even Point (Months):</span>
                            <span id="breakEvenMonthsResult" class="text-xl font-extrabold text-gray-800">0</span>
                        </p>
                        <p class="text-xs text-gray-600 italic" id="breakEvenNote">
                           Time until your monthly savings cover the upfront costs.
                        </p>
                    </div>
                </div>
            </div>
            
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Understanding Loan Refinancing</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>

                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">The Critical Break-Even Point</h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>

                <h3 id="sectionHeader3" class="text-lg font-bold text-gray-800 mb-2">Key Factors to Consider</h3>
                <ul id="content3" class="text-gray-600 text-sm leading-relaxed text-justify mb-6 list-disc ml-6 space-y-1">
                    <li id="tip1"></li>
                    <li id="tip2"></li>
                    <li id="tip3"></li>
                </ul>

                <h3 id="sectionHeader4" class="text-lg font-bold text-gray-800 mb-2">Disclaimer</h3>
                <p id="content4" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>
            </section>

        </div>
    </main>
    
    <section id="related-tools-section" class="layout-article-fixed w-full px-4 py-8 mb-4">
        <div class="flex items-center mb-5">
            <div class="w-1 h-7 mr-3 bg-green-600 dynamic-bg"></div> 
            <h2 class="text-xl font-bold text-gray-800" data-en="Finance Tools" data-id="Alat Keuangan">Finance Tools</h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
            <a href="../kalkulator-kpr/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-600 group-hover:text-green-700 transition-colors" data-en="Mortgage Calculator" data-id="Kalkulator KPR">Mortgage Calculator</h3>
                <p class="text-xs text-gray-600" data-en="Calculate monthly mortgage payments." data-id="Hitung cicilan KPR bulanan.">Calculate monthly mortgage payments.</p>
            </a>
            <a href="../kalkulator-pelunasan-utang/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-600 group-hover:text-green-700 transition-colors" data-en="Debt Payoff" data-id="Pelunasan Utang">Debt Payoff</h3>
                <p class="text-xs text-gray-600" data-en="Snowball vs Avalanche strategies." data-id="Strategi Snowball vs Avalanche.">Snowball vs Avalanche strategies.</p>
            </a>
            <a href="../kalkulator-perbandingan-pinjaman-pribadi/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-600 group-hover:text-green-700" data-en="Loan Comparison" data-id="Perbandingan Pinjaman">Loan Comparison</h3>
                <p class="text-xs text-gray-600" data-en="Compare Loan A vs Loan B." data-id="Bandingkan Pinjaman A vs B.">Compare Loan A vs Loan B.</p>
            </a>
        </div>

        <div class="border-t border-gray-200 pt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4" data-en="Related Articles" data-id="Artikel Terkait">Related Articles</h3>
            <ul class="space-y-3">
                <li>
                    <a href="../articles/strategi-mempercepat-pelunasan-utang.html" class="flex items-center text-sm text-blue-600 hover:underline group">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 group-hover:bg-blue-500"></span>
                        <span data-en="Strategies to Accelerate Debt Repayment" data-id="Strategi Mempercepat Pelunasan Utang">Strategies to Accelerate Debt Repayment</span>
                    </a>
                </li>
                <li>
                    <a href="../kalkulator-bunga-efektif/index.html" class="flex items-center text-sm text-blue-600 hover:underline group">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 group-hover:bg-blue-500"></span>
                        <span data-en="Understanding Effective Interest Rates" data-id="Memahami Suku Bunga Efektif">Understanding Effective Interest Rates</span>
                    </a>
                </li>
            </ul>
        </div>
    </section>

    <div id="global-footer-container"></div>
    <script src="../components.js"></script>
    
    <script>
        // **********************************************
        // LOGIKA KALKULATOR REFINANCING PINJAMAN
        // **********************************************

        let currentLang = 'en';

        const translations = {
            id: {
                appTitle: "Kalkulator Refinancing Pinjaman",
                headerTitle: "Kalkulator Refinancing Pinjaman",
                toolSubtitle: "Hitung potensi penghematan dan titik impas saat Anda mempertimbangkan untuk mengganti pinjaman lama (misalnya KPR) dengan pinjaman baru.",
                
                headerOldLoan: "1. Detail Pinjaman Lama (Pelunasan Dipercepat)",
                labelOldBalance: "Sisa Pokok Pinjaman Saat Ini",
                descOldBalance: "Sisa pokok pinjaman yang akan Anda lunasi dengan pinjaman baru.",
                labelOldRate: "Suku Bunga Tahunan Saat Ini (%)",
                descOldRate: "Suku bunga efektif tahunan pinjaman lama Anda.",
                labelOldPayment: "Angsuran Bulanan Saat Ini",
                descOldPayment: "Angsuran bulanan tetap yang Anda bayar untuk pinjaman lama.",
                labelOldTerm: "Sisa Jangka Waktu (Bulan)",
                descOldTerm: "Berapa bulan tersisa untuk pinjaman lama Anda.",
                
                headerNewLoan: "2. Detail Pinjaman Baru yang Diusulkan",
                labelNewRate: "Suku Bunga Tahunan Baru (%)",
                descNewRate: "Suku bunga efektif tahunan dari penawaran pinjaman baru.",
                labelNewTerm: "Jangka Waktu Pinjaman Baru (Bulan)",
                descNewTerm: "Total jangka waktu pinjaman baru dalam bulan.",
                labelRefinanceCosts: "Total Biaya Refinancing",
                descRefinanceCosts: "Masukkan total biaya di muka dari pinjaman baru (provisi, notaris, appraisal) dan tambahkan penalti pelunasan dipercepat pinjaman lama, jika ada.",
                calculateButton: "Hitung Penghematan Refinancing",
                inputError: "Mohon masukkan semua nilai input yang valid (Semua nilai > 0, Jangka Waktu > 0).",
                
                resultHeader: "Hasil Analisis Refinancing",
                labelNetSavings: "Total Penghematan Bersih Selama Sisa Jangka Waktu Lama",
                recommendationTextPositive: "Refinancing sangat direkomendasikan!",
                recommendationTextNegative: "Refinancing kemungkinan tidak menguntungkan.",
                recommendationTextNeutral: "Refinancing menghasilkan penghematan minimal. Pertimbangkan faktor non-finansial.",
                
                labelOldPaymentSummary: "Angsuran Bulanan Lama",
                labelNewPaymentSummary: "Angsuran Bulanan Baru",
                labelMonthlyDifference: "Selisih Angsuran Bulanan (Penghematan/Biaya Tambahan)",
                
                labelTotalInterestPaid: "Total Bunga Dibayar",
                labelOldInterest: "Bunga Pinjaman Lama (Sisa Jangka Waktu)",
                labelNewInterest: "Bunga Pinjaman Baru (Jangka Waktu Penuh)",
                labelInterestSavings: "Penghematan Bunga Bruto",
                labelBreakEven: "Titik Impas (Break-Even Point)",
                labelRefinanceCost: "Total Biaya Refinancing (Di Muka)",
                labelBreakEvenMonths: "Titik Impas (Bulan)",
                breakEvenNote: "Titik impas adalah saat total penghematan bulanan Anda menutupi total biaya refinancing di muka.",
                
                sectionHeader1: "Memahami Refinancing Pinjaman",
                content1: "Refinancing secara teknis berarti Anda melakukan <b>pelunasan dipercepat</b> atas pinjaman lama Anda dan mengambil pinjaman baru untuk menutupi sisa pokok tersebut.",
                sectionHeader2: "Titik Impas (Break-Even Point) yang Kritis",
                content2: "Titik Impas adalah jumlah bulan yang Anda perlukan agar penghematan bulanan Anda menutupi semua biaya di muka untuk refinancing.",
                sectionHeader3: "Faktor Utama yang Perlu Dipertimbangkan",
                tip1: "Suku Bunga vs. Biaya: Pinjaman baru dengan suku bunga rendah tetapi biaya tinggi mungkin tidak menguntungkan.",
                tip2: "Penalti Pelunasan Awal: Pastikan memperhitungkan penalti dari bank lama.",
                tip3: "Perubahan Tenor: Memperpanjang tenor dapat mengurangi angsuran tetapi meningkatkan total bunga.",
                sectionHeader4: "Disclaimer",
                content4: "Hasil bersifat indikatif dan tidak termasuk semua biaya potensial seperti asuransi atau pajak."
            },
            en: {
                appTitle: "Loan Refinance Calculator",
                headerTitle: "Loan Refinance Calculator",
                toolSubtitle: "Calculate the potential savings and break-even point when refinancing your existing loan (e.g., Mortgage or Auto Loan) with a new loan.",
                
                headerOldLoan: "1. Existing Loan Details (Early Repayment)",
                labelOldBalance: "Current Outstanding Balance",
                descOldBalance: "The remaining principal balance you will pay off with the new loan.",
                labelOldRate: "Current Annual Interest Rate (%)",
                descOldRate: "The effective annual interest rate of your old loan.",
                labelOldPayment: "Current Monthly Payment",
                descOldPayment: "The fixed monthly payment you currently make on the old loan.",
                labelOldTerm: "Remaining Term (Months)",
                descOldTerm: "How many months are left on your old loan.",
                
                headerNewLoan: "2. Proposed New Loan Details",
                labelNewRate: "New Annual Interest Rate (%)",
                descNewRate: "The effective annual interest rate of the proposed new loan.",
                labelNewTerm: "New Loan Term (Months)",
                descNewTerm: "The total duration of the new loan in months.",
                labelRefinanceCosts: "Total Refinancing Costs",
                descRefinanceCosts: "Enter the total upfront fees for the new loan (origination, notary, appraisal) and add the old loan prepayment penalty, if any.",
                calculateButton: "Calculate Refinance Savings",
                inputError: "Please enter all valid input values (All values > 0, Terms > 0).",

                resultHeader: "Refinance Analysis Results",
                labelNetSavings: "Net Savings Over Remaining Old Term",
                recommendationTextPositive: "Refinancing is highly recommended!",
                recommendationTextNegative: "Refinancing is likely not beneficial.",
                recommendationTextNeutral: "Refinancing yields minimal savings. Consider non-financial factors.",

                labelOldPaymentSummary: "Old Monthly Payment",
                labelNewPaymentSummary: "New Monthly Payment",
                labelMonthlyDifference: "Monthly Difference (Savings/Cost)",
                
                labelTotalInterestPaid: "Total Interest Paid:",
                labelOldInterest: "Old Loan Interest (Remaining Term):",
                labelNewInterest: "New Loan Interest (Full Term):",
                labelInterestSavings: "Gross Interest Savings",
                labelBreakEven: "Break-Even Point",
                labelRefinanceCost: "Refinancing Cost (Upfront):",
                labelBreakEvenMonths: "Break-Even Point (Months):",
                breakEvenNote: "The break-even point is when your monthly savings cover the total upfront refinancing costs.",

                sectionHeader1: "Understanding Loan Refinancing",
                content1: "Refinancing technically means you are making an <b>early repayment</b> on your old loan and taking out a new loan to cover that remaining principal.",
                sectionHeader2: "The Critical Break-Even Point",
                content2: "The Break-Even Point is the number of months it takes for your monthly savings to cover all the upfront costs of refinancing.",
                sectionHeader3: "Key Factors to Consider",
                tip1: "Rate vs. Cost: Low interest with high fees might not be worth it.",
                tip2: "Prepayment Penalty: Always account for old loan penalties.",
                tip3: "Tenor Change: Longer terms lower monthly payments but increase total interest.",
                sectionHeader4: "Disclaimer",
                content4: "Results are indicative and do not include all potential costs."
            }
        };

        function formatNumber(amount) {
            const locale = currentLang === 'id' ? 'id-ID' : 'en-US';
            return new Intl.NumberFormat(locale, {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
            }).format(amount);
        }

        function formatInput(inputElement) {
            let rawValue = inputElement.value.replace(/\D/g, ''); 
            if (rawValue) {
                const numericValue = parseInt(rawValue, 10);
                inputElement.value = formatNumber(numericValue);
            } else {
                inputElement.value = ''; 
            }
        }
        
        function cleanInput(formattedValue) {
            return parseFloat(formattedValue.replace(/\D/g, '')) || 0;
        }

        function calculateLoanMetrics(L, R_annual, N_months) {
            if (L <= 0 || N_months <= 0) {
                return { monthlyPayment: 0, totalInterest: 0 };
            }
            const R_monthly = R_annual / 12;
            let monthlyPayment;
            if (R_monthly > 0) {
                const powerFactor = Math.pow(1 + R_monthly, N_months);
                monthlyPayment = L * (R_monthly * powerFactor) / (powerFactor - 1);
            } else {
                monthlyPayment = L / N_months;
            }
            const totalInterest = (monthlyPayment * N_months) - L;
            return { monthlyPayment, totalInterest };
        }

        function calculateRefinance(event) {
            event.preventDefault();
            const L_old = cleanInput(document.getElementById('oldBalance').value);
            const M_old_input = cleanInput(document.getElementById('oldPayment').value);
            const N_months_old = parseInt(document.getElementById('oldTermMonthsRemaining').value) || 0;
            
            const R_annual_new = parseFloat(document.getElementById('newRate').value) / 100;
            const N_months_new = parseInt(document.getElementById('newTermMonths').value) || 0;
            const Costs_refinance = cleanInput(document.getElementById('refinanceCosts').value);

            const resultBox = document.getElementById('resultBox');
            const errorAlert = document.getElementById('errorAlert');

            if (L_old <= 0 || M_old_input <= 0 || N_months_old <= 0 || R_annual_new < 0 || N_months_new <= 0 || Costs_refinance < 0) {
                document.getElementById('errorText').textContent = translations[currentLang].inputError;
                errorAlert.classList.remove('hidden');
                resultBox.classList.remove('visible');
                return;
            }
            
            errorAlert.classList.add('hidden');
            const newMetrics = calculateLoanMetrics(L_old, R_annual_new, N_months_new);
            const M_new = newMetrics.monthlyPayment;
            const Interest_new = newMetrics.totalInterest;

            const Interest_old_remaining = (M_old_input * N_months_old) - L_old;
            const M_difference = M_old_input - M_new;
            const Interest_new_paid_during_old_term = (M_new * N_months_old) - L_old;
            const Interest_Savings_Gross = Interest_old_remaining - Interest_new_paid_during_old_term;
            const Net_Savings = Interest_Savings_Gross - Costs_refinance;
            
            let BreakEven_Months = 0;
            if (M_difference > 0) {
                BreakEven_Months = Costs_refinance / M_difference;
            } else {
                BreakEven_Months = 9999;
            }
            
            let recommendationText;
            const netSavingsEl = document.getElementById('netSavingsResult');
            if (Net_Savings > 0 && BreakEven_Months < N_months_old) {
                 recommendationText = translations[currentLang].recommendationTextPositive;
                 netSavingsEl.className = "text-4xl font-extrabold text-green-600";
            } else if (Net_Savings < 0) {
                 recommendationText = translations[currentLang].recommendationTextNegative;
                 netSavingsEl.className = "text-4xl font-extrabold text-red-600";
            } else {
                 recommendationText = translations[currentLang].recommendationTextNeutral;
                 netSavingsEl.className = "text-4xl font-extrabold text-gray-600";
            }
            document.getElementById('recommendationText').textContent = recommendationText;

            document.getElementById('netSavingsResult').textContent = formatNumber(Math.round(Net_Savings));
            document.getElementById('oldPaymentSummary').textContent = formatNumber(Math.round(M_old_input));
            document.getElementById('newPaymentSummary').textContent = formatNumber(Math.round(M_new));
            document.getElementById('monthlyDifferenceResult').textContent = formatNumber(Math.round(M_difference));
            
            document.getElementById('oldInterestResult').textContent = formatNumber(Math.round(Interest_old_remaining));
            document.getElementById('newInterestResult').textContent = formatNumber(Math.round(Interest_new));
            document.getElementById('interestSavingsResult').textContent = formatNumber(Math.round(Interest_Savings_Gross));
            document.getElementById('refinanceCostSummary').textContent = formatNumber(Math.round(Costs_refinance));
            
            if (BreakEven_Months === 9999 || M_difference <= 0) {
                document.getElementById('breakEvenMonthsResult').textContent = "N/A";
            } else {
                document.getElementById('breakEvenMonthsResult').textContent = formatNumber(Math.ceil(BreakEven_Months));
            }

            resultBox.classList.add('visible');
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            ['appTitle', 'headerTitle', 'toolSubtitle', 'headerOldLoan', 'labelOldBalance', 'descOldBalance', 'labelOldRate', 'descOldRate', 
             'labelOldPayment', 'descOldPayment', 'labelOldTerm', 'descOldTerm', 'headerNewLoan', 'labelNewRate', 'descNewRate', 
             'labelNewTerm', 'descNewTerm', 'labelRefinanceCosts', 'descRefinanceCosts', 'calculateButton', 'resultHeader', 'labelNetSavings', 
             'labelOldPaymentSummary', 'labelNewPaymentSummary', 'labelMonthlyDifference', 'detailHeader', 'labelTotalInterestPaid', 
             'labelOldInterest', 'labelNewInterest', 'labelInterestSavings', 'labelBreakEven', 'labelRefinanceCost', 'labelBreakEvenMonths', 
             'breakEvenNote', 'sectionHeader1', 'sectionHeader2', 'sectionHeader3', 'tip1', 'tip2', 'tip3', 'sectionHeader4'].forEach(id => {
                 const el = document.getElementById(id);
                 if(el) el.textContent = t[id];
            });
            
            ['content1', 'content2', 'content4'].forEach(id => {
                const el = document.getElementById(id);
                if(el) el.innerHTML = t[id];
            });

            // Related Tools Update
            document.querySelectorAll('[data-en]').forEach(el => {
                const text = el.getAttribute(`data-${lang}`);
                if (text) el.textContent = text;
            });
            
            const resultElement = document.getElementById('netSavingsResult');
            if (resultElement.textContent !== '0') {
                 calculateRefinance({ preventDefault: () => {} });
            }
            if (!document.getElementById('errorAlert').classList.contains('hidden')) {
                document.getElementById('errorText').textContent = t.inputError;
            }
        }
        
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((m) => {
                if (m.type === 'attributes' && m.attributeName === 'lang') {
                    setLanguage(document.documentElement.lang || 'en');
                }
            });
        });
        observer.observe(document.documentElement, { attributes: true });

        document.addEventListener('DOMContentLoaded', () => {
            setLanguage(document.documentElement.lang || 'en');
        });
    </script>
</body>
</html>