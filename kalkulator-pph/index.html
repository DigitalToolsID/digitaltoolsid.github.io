<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">

    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-pph/" />
    
    <meta name="description" content="Indonesia Income Tax (PPh 21) Calculator. Calculate monthly tax deduction and annual tax return for employees and freelancers based on latest PTKP and progressive rates (UU HPP).">
    <meta name="keywords" content="Income Tax Calculator Indonesia, PPh 21 Calculator, Tax Return Calculator, Kalkulator PPh 21, Hitung Pajak Penghasilan, Pajak Karyawan, Pajak Freelancer, PTKP Terbaru 2025, how to calculate PPh 21, cara lapor SPT tahunan">
 
    <link rel="icon" href="data:,">

    <title id="appTitle">Kalkulator Pajak Penghasilan (PPh) 21 Indonesia</title>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>
    
    <style>
        /* STANDAR TAMPILAN: Hard Lock 50% untuk Desktop */
        @media (min-width: 1024px) {
            .layout-article-fixed {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 50% !important;
                margin-left: auto;
                margin-right: auto;
            }
        }

        /* CSS LOKAL */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 2000px;
            padding: 1.5rem; 
        }
        
        /* TOMBOL HIJAU FINANCE */
        .calculate-button {
            background-color: #16a34a !important; 
            color: white !important;
            box-shadow: 0 4px #14532d; 
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calculate-button:hover {
            background-color: #15803d !important; 
            transform: translateY(-2px);
            box-shadow: 0 6px #14532d;
        }
        .calculate-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #14532d;
        }
        
        .input-description {
            font-size: 0.75rem;
            color: #6b7280; 
            margin-top: 0.25rem;
        }
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex flex-col items-center">
        <div class="w-full layout-article-fixed bg-white shadow-xl rounded-xl p-6 sm:p-8">
            
            <h1 id="headerTitle" class="text-3xl font-extrabold text-green-700 mb-3 text-center">Kalkulator Pajak Penghasilan (PPh) 21</h1>
            
            <p id="toolSubtitle" class="text-sm text-gray-700 font-medium mb-6 leading-relaxed text-justify">
                Simulasikan perhitungan PPh Pasal 21 untuk karyawan tetap dan PPh Tahunan untuk pekerja bebas (freelancer) sesuai peraturan perpajakan yang berlaku di Indonesia.
            </p>

            <form id="pphForm" onsubmit="calculatePPh(event)" class="space-y-4">
                
                <div class="relative">
                    <label for="scenario" class="block text-sm font-medium text-gray-700 mb-1" id="labelScenario">Skenario Penghasilan</label>
                    <select id="scenario" onchange="toggleInput()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150">
                        <option value="karyawan" id="optKaryawan">Karyawan Tetap (PPh 21)</option>
                        <option value="freelancer" id="optFreelancer">Pekerja Lepas/Freelancer (Penghasilan Tahunan Bruto)</option>
                    </select>
                    <p class="input-description" id="descScenario">Pilih jenis penghasilan Anda untuk menentukan metode perhitungan yang tepat.</p>
                </div>
                
                <div class="relative">
                    <label for="brutoAnnual" class="block text-sm font-medium text-gray-700 mb-1" id="labelBrutoAnnual">Gaji Bruto Tahunan</label>
                    <input type="text" id="brutoAnnual" inputmode="numeric" value="120.000.000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150" required>
                    <p class="input-description" id="descBrutoAnnual">Total penghasilan kotor (Gaji Pokok + Tunjangan) selama satu tahun.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="relative">
                        <label for="maritalStatus" class="block text-sm font-medium text-gray-700 mb-1" id="labelMarital">Status Perkawinan</label>
                        <select id="maritalStatus" onchange="updatePTKP()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150">
                            <option value="TK" id="optTK">TK (Tidak Kawin)</option>
                            <option value="K0" id="optK0">K/0 (Kawin Tanpa Tanggungan)</option>
                            <option value="K1" id="optK1">K/1 (Kawin, 1 Tanggungan)</option>
                            <option value="K2" id="optK2">K/2 (Kawin, 2 Tanggungan)</option>
                            <option value="K3" id="optK3">K/3 (Kawin, 3 Tanggungan)</option>
                        </select>
                        <p class="input-description" id="descMarital">Pilih status PTKP Anda (Maksimal K/3).</p>
                    </div>
                    
                    <div class="relative">
                        <label for="ptkpResult" class="block text-sm font-medium text-gray-700 mb-1" id="labelPTKPValue">Nilai PTKP</label>
                        <input type="text" id="ptkpResult" value="54.000.000" class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg transition duration-150" readonly>
                        <p class="input-description" id="descPTKPValue">Penghasilan Tidak Kena Pajak (Otomatis terisi).</p>
                    </div>
                </div>

                <div id="freelancerWarning" class="hidden bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 p-4" role="alert">
                    <p class="font-bold" id="freelancerWarningTitle">Perhatian Pekerja Lepas!</p>
                    <p class="text-sm" id="freelancerWarningText">Perhitungan untuk Pekerja Lepas/Freelancer menggunakan metode <span class="font-bold">Norma Penghitungan Penghasilan Neto (NPPN) 50%</span>. Ini adalah simulasi PPh Tahunan (bukan PPh 21 Bulanan).</p>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full font-semibold py-3 rounded-xl focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                    Hitung PPh
                </button>
                
                <div id="errorAlert" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                    <span id="errorText" class="block sm:inline">Mohon masukkan nilai Gaji Bruto Tahunan yang valid (> 0).</span>
                </div>
            </form>

            <div id="resultBox" class="result-box mt-6 bg-red-50 border border-red-200 rounded-xl shadow-lg">
                
                <h3 id="resultHeader" class="text-xl font-bold mb-4 text-red-800 border-b border-red-200 pb-2">Ringkasan Perhitungan PPh Tahunan</h3>
                
                <div class="space-y-3">
                    <div class="p-3 bg-white border border-gray-200 rounded-lg">
                        <p class="text-sm text-gray-800 font-medium mb-1" id="labelNetIncome">Penghasilan Neto (Setelah Pengurang)</p>
                        <p id="netIncomeResult" class="text-xl font-bold text-gray-700">0</p>
                    </div>
                    
                    <div class="p-3 bg-white border border-gray-200 rounded-lg">
                        <p class="text-sm text-gray-800 font-medium mb-1" id="labelTaxableIncome">Penghasilan Kena Pajak (PKP)</p>
                        <p id="taxableIncomeResult" class="text-xl font-bold text-gray-700">0</p>
                    </div>

                    <div class="p-4 bg-red-100 border border-red-200 rounded-lg">
                        <p class="text-sm text-red-800 font-medium mb-1" id="labelPphAnnual">PPh Terutang Tahunan</p>
                        <p id="pphAnnualResult" class="text-3xl font-extrabold text-red-700">0</p>
                    </div>
                    
                    <div id="monthlyPphBox" class="p-4 bg-red-50 border border-red-200 rounded-lg">
                        <p class="text-sm text-red-800 font-medium mb-1" id="labelPphMonthly">Estimasi PPh Pasal 21 Bulanan</p>
                        <p id="pphMonthlyResult" class="text-2xl font-bold text-red-700">0</p>
                        <p class="input-description mt-1 text-red-600" id="descPphMonthly">*Angka ini adalah pembulatan PPh Tahunan dibagi 12.</p>
                    </div>
                </div>
            </div>
            
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 class="text-xl font-bold text-gray-800 mb-3" id="disclaimerTitle">Pernyataan Penting (Disclaimer)</h2>
                <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-800 p-4 rounded-lg text-sm leading-relaxed text-justify" id="disclaimerContent"></div>
            </section>
            
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans" id="educationSection">
                <h2 class="text-2xl font-extrabold text-gray-800 mb-4 border-b pb-2" id="educationTitle1">Mengapa Anda Perlu Menghitung Pajak Penghasilan (PPh) Anda?</h2>
                <p class="text-gray-600 text-sm leading-relaxed text-justify mb-4" id="educationP1"></p>
                <h3 class="text-xl font-bold text-gray-800 mb-3" id="educationTitle2">Komponen Kunci: PTKP dan Tarif Progresif</h3>
                <p class="text-gray-600 text-sm leading-relaxed text-justify mb-4" id="educationP2"></p>
                <h3 class="text-xl font-bold text-gray-800 mb-3" id="educationTitle3">Simulasi PPh untuk Karyawan dan Pekerja Lepas (Freelancer)</h3>
                <p class="text-gray-600 text-sm leading-relaxed text-justify mb-4" id="educationP3"></p>
            </section>

        </div>
    </main>

    <section id="related-tools-section" class="layout-article-fixed w-full px-4 py-8 mb-4">
        <div class="flex items-center mb-5">
            <div class="w-1 h-7 mr-3 bg-green-600 dynamic-bg"></div> 
            <h2 class="text-xl font-bold text-gray-800" 
                data-en="Investment & Finance Tools" 
                data-id="Alat Investasi & Keuangan">
                Investment & Finance Tools
            </h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
            <a href="../kalkulator-pajak-keuntungan-modal/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Capital Gains Tax"
                    data-id="Pajak Keuntungan Modal">
                    Capital Gains Tax
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Estimate tax on investment profits."
                    data-id="Estimasi pajak atas keuntungan investasi.">
                    Estimate tax on investment profits.
                </p>
            </a>

            <a href="../kalkulator-konversi-gaji/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Salary Converter"
                    data-id="Konversi Gaji">
                    Salary Converter
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Convert between hourly, monthly, and annual salary."
                    data-id="Konversi antara gaji per jam, bulanan, dan tahunan.">
                    Convert between hourly, monthly, and annual salary.
                </p>
            </a>

            <a href="../kalkulator-anggaran-bulanan/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Monthly Budget Planner"
                    data-id="Perencana Anggaran Bulanan">
                    Monthly Budget Planner
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Plan your monthly expenses effectively."
                    data-id="Rencanakan pengeluaran bulanan Anda secara efektif.">
                    Plan your monthly expenses effectively.
                </p>
            </a>
        </div>

        <div class="border-t border-gray-100 pt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4" 
                data-en="Related Articles:" 
                data-id="Artikel Terkait:">
                Related Articles:
            </h3>
            <ul class="space-y-3">
                <li>
                    <a href="../articles/klausul-perpajakan-kontrak.html" class="flex items-center text-sm hover:underline group text-blue-600 hover:text-blue-800">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 dynamic-bg-group"></span>
                        <span data-en="Understanding Tax Clauses in Contracts" 
                              data-id="Memahami Klausul Perpajakan dalam Kontrak">
                            Understanding Tax Clauses in Contracts
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </section>

    <div id="global-footer-container"></div>

    <script src="../components.js"></script>
    <script>
        // Set Header Category untuk Finance (Hijau)
        window.headerCategory = 'finance';

        // **********************************************
        // PAJAK CONFIG (Sesuai UU HPP)
        // **********************************************
        const PajakConfig = {
            PTKP: {
                TK: 54000000,
                K0: 58500000,
                K1: 63000000,
                K2: 67500000,
                K3: 72000000,
            },
            TARIF_PROGRESIF: [
                { limit: 60000000, rate: 0.05 },    
                { limit: 250000000, rate: 0.15 },   
                { limit: 500000000, rate: 0.25 },   
                { limit: 5000000000, rate: 0.30 },  
                { limit: Infinity, rate: 0.35 }     
            ],
            PENGURANG_KARYAWAN: {
                JABATAN_RATE: 0.05,
                JABATAN_MAX_ANNUAL: 6000000,
            },
            NPPN_RATE_FREELANCER: 0.50,
        };

        const translations = {
            id: {
                appTitle: "Kalkulator Pajak Penghasilan (PPh) 21 & Tahunan Indonesia Terbaru",
                headerTitle: "Kalkulator Pajak Penghasilan (PPh) 21 & Tahunan Indonesia Terbaru",
                toolSubtitle: "Simulasikan perhitungan PPh Pasal 21 untuk karyawan tetap dan PPh Tahunan untuk pekerja bebas (freelancer) sesuai peraturan perpajakan yang berlaku di Indonesia.",
                labelScenario: "Skenario Penghasilan",
                optKaryawan: "Karyawan Tetap (PPh 21)",
                optFreelancer: "Pekerja Lepas/Freelancer (Penghasilan Tahunan Bruto)",
                descScenario: "Pilih jenis penghasilan Anda untuk menentukan metode perhitungan yang tepat.",
                labelBrutoAnnual: "Gaji Bruto Tahunan",
                descBrutoAnnual: "Total penghasilan kotor (Gaji Pokok + Tunjangan) selama satu tahun.",
                labelMarital: "Status Perkawinan",
                descMarital: "Pilih status PTKP Anda (Maksimal K/3).",
                labelPTKPValue: "Nilai PTKP",
                descPTKPValue: "Penghasilan Tidak Kena Pajak (Otomatis terisi).",
                calculateButton: "Hitung PPh",
                errorText: "Mohon masukkan nilai Gaji Bruto Tahunan yang valid (> 0).",
                resultHeader: "Ringkasan Perhitungan PPh Tahunan",
                labelNetIncome: "Penghasilan Neto (Setelah Pengurang)",
                labelTaxableIncome: "Penghasilan Kena Pajak (PKP)",
                labelPphAnnual: "PPh Terutang Tahunan",
                labelPphMonthly: "Estimasi PPh Pasal 21 Bulanan",
                descPphMonthly: "*Angka ini adalah pembulatan PPh Tahunan dibagi 12.",
                freelancerWarningTitle: "Perhatian Pekerja Lepas!",
                freelancerWarningText: "Perhitungan untuk Pekerja Lepas/Freelancer menggunakan metode <span class=\"font-bold\">Norma Penghitungan Penghasilan Neto (NPPN) 50%</span>. Ini adalah simulasi PPh Tahunan (bukan PPh 21 Bulanan).",
                
                disclaimerTitle: "Pernyataan Penting (Disclaimer)",
                disclaimerContent: `
                    <p class="mb-2">Kalkulator ini dirancang khusus berdasarkan <strong class="font-bold">Peraturan Pajak Penghasilan (PPh) di Indonesia</strong>, dengan dasar perhitungan merujuk pada <strong>UU HPP No. 7 Tahun 2021</strong> dan <strong>Peraturan Menteri Keuangan (PMK) terkait PTKP dan Tarif PPh Terbaru</strong>.</p>
                    <p class="mb-2">Perhitungan ini hanyalah <strong class="font-bold">alat simulasi</strong> dan tidak dapat menggantikan perhitungan resmi dari otoritas pajak, ataupun nasihat dari konsultan pajak profesional.</p>
                    <p class="mb-2">Admin berupaya keras untuk menjaga keakuratan data PTKP dan lapisan tarif pajak terbaru. Namun, <strong class="font-bold">pengguna wajib memverifikasi</strong> semua hasil dengan peraturan perpajakan terbaru yang berlaku atau data resmi dari DJP.</p>
                    <p>Kode PPh dikonfigurasi menggunakan nilai-nilai <strong class="font-bold">PTKP per 2025</strong> (misalnya TK/0 = Rp54.000.000).</p>
                `,
                educationTitle1: "Mengapa Anda Perlu Menghitung Pajak Penghasilan (PPh) Anda?",
                educationP1: `Memahami cara <strong class="font-bold">hitung PPh 21</strong> atau PPh Tahunan adalah langkah fundamental dalam literasi keuangan di Indonesia. Pajak Penghasilan Pasal 21 (<strong class="font-bold">PPh 21</strong>) adalah pajak yang dipotong oleh perusahaan atas gaji dan tunjangan karyawan. Bagi wajib pajak orang pribadi, ini adalah kontribusi wajib yang digunakan negara untuk pembiayaan pembangunan nasional. Dengan kalkulator pajak ini, Anda dapat menyimulasikan berapa besar kewajiban PPh Anda secara akurat dan transparan.`,
                educationTitle2: "Komponen Kunci: PTKP dan Tarif Progresif",
                educationP2: `Kunci utama perhitungan terletak pada dua komponen. Pertama, <strong class="font-bold">Penghasilan Tidak Kena Pajak (PTKP Terbaru)</strong>. PTKP adalah batas minimal penghasilan yang tidak dikenakan pajak; status perkawinan dan jumlah tanggungan (maksimal 3) sangat memengaruhi nilai PTKP Anda. Kedua, <strong class="font-bold">Tarif Progresif PPh Pasal 17</strong>. Peraturan terbaru (melalui UU HPP) menggunakan sistem lapisan tarif (layering) yang semakin tinggi seiring dengan meningkatnya Penghasilan Kena Pajak (PKP). Tarif ini dimulai dari 5% hingga 35%.`,
                educationTitle3: "Simulasi PPh untuk Karyawan dan Pekerja Lepas (Freelancer)",
                educationP3: `Kalkulator ini mencakup dua skenario populer. Untuk <strong class="font-bold">Karyawan Tetap</strong>, perhitungan menggunakan basis gaji bruto dikurangi Biaya Jabatan (maksimal Rp6.000.000 per tahun) dan PTKP untuk mendapatkan PKP. Sementara untuk <strong class="font-bold">PPh Freelancer</strong> atau pekerja lepas, kami menggunakan asumsi Norma Penghitungan Penghasilan Neto (NPPN) sebesar 50% dari omzet bruto, sebelum kemudian dikurangi PTKP untuk mendapatkan PKP. Memahami perbedaan <strong class="font-bold">cara hitung PPh</strong> ini sangat penting agar Anda dapat menyiapkan anggaran pajak tahunan dengan tepat.`
            },
            en: {
                appTitle: "Income Tax (PPh 21) Calculator Indonesia",
                headerTitle: "Income Tax (PPh 21) Calculator Indonesia",
                toolSubtitle: "Simulate PPh Article 21 (Employee) and Annual Income Tax (Freelancer) calculations based on the latest Indonesian tax regulations (UU HPP).",
                labelScenario: "Income Scenario",
                optKaryawan: "Permanent Employee (PPh 21)",
                optFreelancer: "Freelancer/Non-Employee (Gross Annual Income)",
                descScenario: "Select your income type to determine the correct calculation method.",
                labelBrutoAnnual: "Gross Annual Income",
                descBrutoAnnual: "Total gross income (Salary + Allowances) for one year.",
                labelMarital: "Marital Status (PTKP)",
                descMarital: "Select your PTKP status (Max K/3).",
                labelPTKPValue: "PTKP Value",
                descPTKPValue: "Non-Taxable Income (Auto-filled).",
                calculateButton: "Calculate PPh",
                errorText: "Please enter a valid Gross Annual Income value (> 0).",
                resultHeader: "Annual PPh Calculation Summary",
                labelNetIncome: "Net Income (After Reductions)",
                labelTaxableIncome: "Taxable Income (PKP)",
                labelPphAnnual: "Annual Income Tax Due (PPh)",
                labelPphMonthly: "Estimated Monthly PPh Article 21",
                descPphMonthly: "*Approximation: Annual PPh / 12.",
                freelancerWarningTitle: "Attention Freelancers!",
                freelancerWarningText: "The calculation uses the <span class=\"font-bold\">Net Income Calculation Norm (NPPN) of 50%</span>. This is an Annual PPh simulation.",
                
                disclaimerTitle: "Important Statement (Disclaimer)",
                disclaimerContent: `
                    <p class="mb-2">This calculator is specifically designed based on <strong class="font-bold">Income Tax (PPh) Regulations in Indonesia</strong>, with the calculation basis referring to <strong>Law HPP No. 7 Year 2021</strong> and <strong>Minister of Finance Regulations (PMK) regarding the latest PTKP and PPh Tariffs</strong>.</p>
                    <p class="mb-2">This calculation is merely a <strong class="font-bold">simulation tool</strong> and cannot substitute official calculations from tax authorities, or advice from a professional tax consultant.</p>
                    <p class="mb-2">The admin strives to maintain the accuracy of the latest PTKP data and tax tariff layers. However, <strong class="font-bold">users must verify</strong> all results with the latest applicable tax regulations or official data from the Directorate General of Taxes (DJP).</p>
                    <p>The PPh code is configured using <strong class="font-bold">PTKP per 2025</strong> values (e.g., TK/0 = Rp54,000,000).</p>
                `,
                educationTitle1: "Why Calculate Your Income Tax?",
                educationP1: `Understanding the <strong class="font-bold">method to calculate PPh 21</strong> or Annual PPh is a fundamental step in financial literacy in Indonesia. Income Tax Article 21 (<strong class="font-bold">PPh 21</strong>) is the tax withheld by companies on employee salaries and allowances. For individual taxpayers, this is a mandatory contribution used by the state for national development financing. With this tax calculator, you can simulate your PPh liability accurately and transparently.`,
                educationTitle2: "Key Components: PTKP and Progressive Tariffs",
                educationP2: `The key to calculation lies in two components. First, the <strong class="font-bold">Non-Taxable Income (PTKP Terbaru)</strong>. PTKP is the minimum income threshold not subject to tax; marital status and number of dependents (maximum 3) significantly affect your PTKP value. Second, the <strong class="font-bold">Progressive Tariff of PPh Article 17</strong>. The latest regulation (via UU HPP) uses a layered tariff system that increases as the Taxable Income (PKP) increases. This tariff starts from 5% up to 35%.`,
                educationTitle3: "Employee vs Freelancer Simulation",
                educationP3: `This calculator covers two popular scenarios. For <strong class="font-bold">Permanent Employees</strong>, the calculation uses gross salary minus Position Deduction (Biaya Jabatan, max IDR 6,000,000 annually) and PTKP to get the Taxable Income (PKP). Meanwhile, for <strong class="font-bold">Freelancer PPh</strong>, we use the assumption of Net Income Calculation Norm (NPPN) of 50% of gross turnover, before being deducted by PTKP to get the PKP. Understanding the difference in <strong class="font-bold">how to calculate PPh</strong> is crucial for setting your annual tax budget correctly.`
            }
        };

        let currentLang = 'en';

        // Utility Functions
        function formatNumber(amount) {
            if (typeof amount !== 'number') return '0';
            const locale = 'id-ID'; 
            return new Intl.NumberFormat(locale, {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
            }).format(Math.round(amount));
        }

        function cleanInput(formattedValue) {
            return parseFloat(formattedValue.replace(/\D/g, '')) || 0;
        }

        function formatInput(inputElement) {
            let rawValue = inputElement.value.replace(/\D/g, '');
            if (rawValue) {
                const numericValue = parseInt(rawValue, 10);
                inputElement.value = formatNumber(numericValue);
            } else {
                inputElement.value = '';
            }
        }

        // Logic Functions
        function updatePTKP() {
            const maritalStatus = document.getElementById('maritalStatus').value;
            const ptkpElement = document.getElementById('ptkpResult');
            const ptkpValue = PajakConfig.PTKP[maritalStatus];
            
            if (ptkpValue) {
                ptkpElement.value = formatNumber(ptkpValue);
            }
            document.getElementById('resultBox').classList.remove('visible');
        }

        function toggleInput() {
            const scenario = document.getElementById('scenario').value;
            const label = document.getElementById('labelBrutoAnnual');
            const desc = document.getElementById('descBrutoAnnual');
            const warning = document.getElementById('freelancerWarning');
            const t = translations[currentLang];

            if (scenario === 'karyawan') {
                label.textContent = t.labelBrutoAnnual;
                desc.textContent = t.descBrutoAnnual;
                warning.classList.add('hidden');
                document.getElementById('monthlyPphBox').classList.remove('hidden');
            } else { // freelancer
                label.textContent = currentLang === 'id' ? "Omzet Bruto Tahunan" : "Gross Annual Turnover";
                desc.textContent = currentLang === 'id' ? "Total omzet (pendapatan kotor) yang diterima selama satu tahun." : "Total gross turnover (gross income) received for one year.";
                warning.classList.remove('hidden');
                document.getElementById('monthlyPphBox').classList.add('hidden');
            }
             document.getElementById('resultBox').classList.remove('visible');
        }

        function calculatePphProgressive(pkp) {
            let pphTerutang = 0;
            let remainingPKP = pkp;

            for (const layer of PajakConfig.TARIF_PROGRESIF) {
                if (remainingPKP <= 0) break;
                const taxableAtLayer = Math.min(remainingPKP, layer.limit);
                pphTerutang += taxableAtLayer * layer.rate;
                remainingPKP -= taxableAtLayer;
            }

            return pphTerutang;
        }

        function calculatePPh(event) {
            event.preventDefault();
            const brutoAnnual = cleanInput(document.getElementById('brutoAnnual').value);
            const maritalStatus = document.getElementById('maritalStatus').value;
            const scenario = document.getElementById('scenario').value;
            const errorAlert = document.getElementById('errorAlert');
            const resultBox = document.getElementById('resultBox');

            if (brutoAnnual <= 0) {
                document.getElementById('errorText').textContent = translations[currentLang].errorText;
                errorAlert.classList.remove('hidden');
                resultBox.classList.remove('visible');
                return;
            }
            errorAlert.classList.add('hidden');

            const ptkp = PajakConfig.PTKP[maritalStatus];
            let penghasilanNeto = 0;
            
            if (scenario === 'karyawan') {
                const biayaJabatan = Math.min(
                    brutoAnnual * PajakConfig.PENGURANG_KARYAWAN.JABATAN_RATE,
                    PajakConfig.PENGURANG_KARYAWAN.JABATAN_MAX_ANNUAL
                );
                penghasilanNeto = brutoAnnual - biayaJabatan;
            } else { 
                penghasilanNeto = brutoAnnual * PajakConfig.NPPN_RATE_FREELANCER;
            }

            let pkp = Math.max(0, penghasilanNeto - ptkp);
            pkp = Math.floor(pkp / 1000) * 1000;
            const pphAnnual = calculatePphProgressive(pkp);
            const pphMonthly = scenario === 'karyawan' ? pphAnnual / 12 : 0;

            document.getElementById('netIncomeResult').textContent = formatNumber(penghasilanNeto);
            document.getElementById('taxableIncomeResult').textContent = formatNumber(pkp);
            document.getElementById('pphAnnualResult').textContent = formatNumber(pphAnnual);
            
            if (scenario === 'karyawan') {
                document.getElementById('pphMonthlyResult').textContent = formatNumber(pphMonthly);
                document.getElementById('monthlyPphBox').classList.remove('hidden');
            } else {
                document.getElementById('monthlyPphBox').classList.add('hidden');
            }

            resultBox.classList.add('visible');
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];

            const lValue = document.getElementById('brutoAnnual').value;

            // Update Text
            const elements = [
                'appTitle', 'headerTitle', 'toolSubtitle', 'labelScenario', 'optKaryawan', 
                'optFreelancer', 'descScenario', 'labelBrutoAnnual', 'descBrutoAnnual', 
                'labelMarital', 'descMarital', 'labelPTKPValue', 'descPTKPValue', 'calculateButton',
                'freelancerWarningTitle', 'resultHeader', 'labelNetIncome', 'labelTaxableIncome',
                'labelPphAnnual', 'labelPphMonthly', 'descPphMonthly', 'disclaimerTitle',
                'educationTitle1', 'educationTitle2', 'educationTitle3'
            ];
            
            elements.forEach(id => {
                 const el = document.getElementById(id);
                 if(el) el.textContent = t[id];
            });

            // Update InnerHTML elements
            document.getElementById('freelancerWarningText').innerHTML = t.freelancerWarningText;
            document.getElementById('disclaimerContent').innerHTML = t.disclaimerContent;
            document.getElementById('educationP1').innerHTML = t.educationP1;
            document.getElementById('educationP2').innerHTML = t.educationP2;
            document.getElementById('educationP3').innerHTML = t.educationP3;

            // Re-format Inputs
            document.getElementById('brutoAnnual').value = formatNumber(cleanInput(lValue));
            
             // Panggil toggleInput lagi agar label Bruto/Omzet disesuaikan
            toggleInput();

            // Refresh Calc if visible
            if(document.getElementById('resultBox').classList.contains('visible')){
                calculatePPh({preventDefault:()=>{}});
            }
            
            // Update Related Content Language
            updateRelatedContent(lang);
        }
        
        function updateRelatedContent(lang) {
            const translatableElements = document.querySelectorAll('#related-tools-section [data-en]');
            translatableElements.forEach(el => {
                const newText = el.getAttribute(`data-${lang}`);
                if (newText) {
                    el.textContent = newText;
                }
            });
        }

        // Observer
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'lang') {
                    const currentLang = document.documentElement.lang || 'en';
                    setLanguage(currentLang);
                }
            });
        });
        observer.observe(document.documentElement, { attributes: true });

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            const brutoInput = document.getElementById('brutoAnnual');
            if(brutoInput.value) brutoInput.value = formatNumber(cleanInput(brutoInput.value));
            setLanguage('en'); 
            updatePTKP();
        });
    </script>
</body>
</html>