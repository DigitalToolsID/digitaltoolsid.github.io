<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-kapasitas-cicilan/" />
    <meta name="description" content="Loan Affordability Calculator. Calculate your maximum safe loan limit and borrowing capacity based on net income and existing debt obligations (DSR).">
    <meta name="keywords" content="Loan Affordability Calculator, Debt Service Ratio Calculator, Max Loan Capacity, Kalkulator Kapasitas Cicilan, Hitung Batas Utang, Simulasi Plafond Kredit, how much loan can I afford, safe debt limit calculation, cara hitung maksimal cicilan">
    
    <link rel="icon" href="data:,">
    
    <title id="appTitle">Loan Affordability Calculator</title>
    
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>

    <style>
        /* STANDAR TAMPILAN: Hard Lock 50% untuk Desktop */
        @media (min-width: 1024px) {
            .layout-article-fixed {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 50% !important;
                margin-left: auto;
                margin-right: auto;
            }
        }

        /* CSS LOKAL */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 3000px; 
            padding: 1.5rem; 
        }

        /* Tombol Hijau (Finance Standard) */
        .calculate-button {
            background-color: #16a34a !important; 
            color: white !important;
        }
        .calculate-button:hover {
            background-color: #15803d !important;
        }

        /* Ratio Bar Visualizer */
        .ratio-bar {
            height: 20px;
            border-radius: 9999px;
            background-color: #e5e7eb;
            overflow: hidden;
            position: relative;
            margin-top: 10px;
            border: 1px solid #d1d5db;
        }
        .ratio-fill {
            height: 100%;
            width: 0%;
            transition: width 0.8s ease-in-out;
        }
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <script>window.headerCategory = 'finance';</script>
    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex flex-col items-center">
        <div class="w-full layout-article-fixed bg-white shadow-xl rounded-xl p-6 sm:p-8">

            <h1 id="headerTitle" class="text-3xl font-extrabold text-gray-900 mb-3 text-center">Loan Affordability Calculator</h1>
            <p id="toolSubtitle" class="text-sm text-gray-700 font-medium mb-6 leading-relaxed text-justify">
            </p>

            <form id="affordabilityForm" onsubmit="calculateAffordability(event)" class="space-y-6">

                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h2 class="text-lg font-bold text-green-700 mb-3" id="sectionIncomeHeader">1. Income & Debt Data</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        <div class="md:col-span-2">
                            <label for="monthlyIncome" class="block text-sm font-medium text-gray-700 mb-1">
                                <span id="labelMonthlyIncome">Total Net Monthly Income</span>
                                <span class="currency-label font-normal text-gray-500">($)</span>
                            </label>
                            <input type="text" id="monthlyIncome" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="10.000.000" value="10.000.000">
                        </div>

                        <div class="md:col-span-2">
                            <label for="existingDebtPayment" class="block text-sm font-medium text-gray-700 mb-1">
                                <span id="labelExistingDebtPayment">Current Monthly Debt Payments</span>
                                <span class="currency-label font-normal text-gray-500">($)</span>
                            </label>
                            <input type="text" id="existingDebtPayment" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="1.500.000" value="1.500.000">
                            <p class="text-xs text-gray-500 mt-1" id="descExistingDebtPayment">Total existing installments (Mortgage, Car, Credit Cards).</p>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h2 class="text-lg font-bold text-green-700 mb-3" id="sectionNewLoanHeader">2. New Loan Details</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="relative">
                            <label for="loanInterestRate" class="block text-sm font-medium text-gray-700 mb-1" id="labelLoanInterestRate">Annual Interest (%)</label>
                            <input type="number" id="loanInterestRate" step="0.1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="9" value="9">
                        </div>
                        <div class="relative">
                            <label for="loanTermYears" class="block text-sm font-medium text-gray-700 mb-1" id="labelLoanTermYears">Loan Term (Years)</label>
                            <input type="number" id="loanTermYears" min="1" step="1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="10" value="10">
                        </div>
                        <div class="md:col-span-2">
                            <label for="dsrLimit" class="block text-sm font-medium text-gray-700 mb-1" id="labelDSRLimit">Ideal DSR Limit (%)</label>
                            <input type="number" id="dsrLimit" step="1" min="10" max="60" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="35" value="35">
                            <p class="text-xs text-gray-500 mt-1" id="descDSRLimit">Safe bank limits are usually 30% - 40%.</p>
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full text-white font-bold py-3 rounded-xl shadow-md transition duration-300 ease-in-out transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                    Calculate Maximum Capacity
                </button>
            </form>

            <div id="errorAlert" class="hidden mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                <span id="errorText" class="block sm:inline"></span>
            </div>

            <div id="resultBox" class="result-box mt-6 bg-green-50 border border-green-200 rounded-xl shadow-lg">

                <h3 id="resultTitle" class="text-xl font-bold text-gray-800 mb-4 border-b pb-2 border-green-300">Analysis Result</h3>

                <div id="resultSummaryText" class="p-4 rounded-lg mb-6 bg-white border border-gray-200">
                    <p class="text-lg font-bold mb-2" id="summaryTitle"></p>
                    <p id="summaryText" class="text-gray-700 text-sm leading-relaxed"></p>
                </div>

                <h3 id="metricsHeader" class="text-md font-bold text-gray-800 mb-3">Maximum Capacity</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                        <p class="text-xs text-gray-500 uppercase font-bold" id="resultMaxMonthlyInstallment">Max New Monthly Installment</p>
                        <p class="text-xl font-extrabold text-green-600 mt-1" id="maxMonthlyInstallmentResult">--</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                        <p class="text-xs text-gray-500 uppercase font-bold" id="resultMaxLoanAmount">Maximum Loan Amount</p>
                        <p class="text-xl font-extrabold text-blue-600 mt-1" id="maxLoanAmountResult">--</p>
                    </div>
                </div>

                <div class="mt-4">
                    <div class="flex justify-between items-end mb-2">
                        <p class="text-sm font-bold text-gray-700" id="ratioVisualHeader">DSR Capacity Usage</p>
                        <p class="text-sm font-bold text-gray-900" id="currentDSRResult">0%</p>
                    </div>
                    <div class="ratio-bar">
                        <div id="ratioFill" class="ratio-fill"></div>
                    </div>
                    <p class="text-xs text-gray-500 mt-2" id="ratioLegend"></p>
                </div>

            </div>

            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">What is Debt Service Ratio (DSR)?</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>

                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">Why is the 35% Limit Important?</h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
            </section>
        </div>
    </main>

    <section id="related-tools-section" class="layout-article-fixed w-full px-4 py-8 mb-4">
        <div class="flex items-center mb-5">
            <div class="w-1 h-7 mr-3 bg-green-600 dynamic-bg"></div> 
            <h2 class="text-xl font-bold text-gray-800" data-en="Related Finance Tools" data-id="Alat Keuangan Terkait">Related Finance Tools</h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
            <a href="../kalkulator-pelunasan-utang/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 group-hover:text-green-700 transition-colors" data-en="Debt Payoff Calculator" data-id="Kalkulator Pelunasan Utang">Debt Payoff Calculator</h3>
                <p class="text-xs text-gray-600" data-en="Plan your debt-free journey." data-id="Rencanakan perjalanan bebas utang.">Plan your debt-free journey.</p>
            </a>
            <a href="../kalkulator-kpr/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 group-hover:text-green-700 transition-colors" data-en="Mortgage Calculator" data-id="Kalkulator KPR Rumah">Mortgage Calculator</h3>
                <p class="text-xs text-gray-600" data-en="Calculate monthly mortgage payments." data-id="Hitung estimasi cicilan rumah.">Calculate monthly mortgage payments.</p>
            </a>
        </div>
        
        <div class="border-t border-gray-100 pt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4" data-en="Related Articles:" data-id="Artikel Terkait:">Related Articles:</h3>
            <ul class="space-y-3">
                <li>
                    <a href="../articles/strategi-mempercepat-pelunasan-utang.html" class="flex items-center text-sm hover:underline group text-blue-600 hover:text-blue-800">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 group-hover:bg-green-500"></span>
                        <span data-en="Strategies to Accelerate Debt Repayment" data-id="Strategi Mempercepat Pelunasan Utang">Strategies to Accelerate Debt Repayment</span>
                    </a>
                </li>
            </ul>
        </div>
    </section>

    <div id="global-footer-container"></div>
    <script src="../components.js"></script>

    <script>
        // **********************************************
        // LOGIKA KALKULATOR KAPASITAS CICILAN
        // **********************************************

        let currentLang = 'en';

        const translations = {
            id: {
                appTitle: "Kalkulator Kapasitas Cicilan (Affordability)",
                headerTitle: "Kalkulator Kapasitas Cicilan",
                toolSubtitle: "Hindari utang berlebihan. Hitung jumlah pinjaman maksimum yang aman berdasarkan pendapatan bersih dan cicilan utang Anda saat ini.",
                
                currencyLabel: "(Rp)",
                
                sectionIncomeHeader: "1. Data Pendapatan & Utang",
                labelMonthlyIncome: "Total Pendapatan Bersih (Bulanan)",
                labelExistingDebtPayment: "Total Cicilan Utang Saat Ini",
                descExistingDebtPayment: "Total cicilan (KPR, Mobil, Kartu Kredit) yang sedang berjalan.",
                
                sectionNewLoanHeader: "2. Detail Pinjaman Baru",
                labelLoanInterestRate: "Bunga Tahunan (%)",
                labelLoanTermYears: "Jangka Waktu (Tahun)",
                labelDSRLimit: "Batas DSR Ideal (%)",
                descDSRLimit: "Batas aman bank biasanya 30% - 40%.",
                
                calculateButton: "Hitung Kapasitas Maksimum",
                
                resultTitle: "Hasil Analisis",
                metricsHeader: "Kapasitas Maksimum",
                resultMaxMonthlyInstallment: "Maksimum Cicilan Baru",
                resultMaxLoanAmount: "Plafond Pinjaman Maksimum",
                ratioVisualHeader: "Penggunaan Kapasitas DSR",
                
                // Pesan Dinamis
                ratioLegend_Safe: (currentDSR, dsrLimit) => `DSR Anda saat ini ${currentDSR}%. Masih ada ruang aman hingga ${dsrLimit}%.`,
                ratioLegend_High: (currentDSR, dsrLimit) => `DSR Anda ${currentDSR}%. Ruang pinjaman sudah sangat terbatas.`,
                ratioLegend_Over: (currentDSR, dsrLimit) => `BAHAYA! DSR Anda (${currentDSR}%) sudah melebihi batas ideal (${dsrLimit}%). Jangan ambil utang baru.`,
                
                summaryTitle_Safe: "Status: Aman (Hijau)",
                summaryTitle_Limited: "Status: Waspada (Kuning)",
                summaryTitle_Warning: "Status: Berisiko (Merah)",
                
                summaryText_Safe: (maxInstallment, maxLoanAmount) => `Keuangan Anda sehat. Anda bisa mengambil cicilan baru hingga <strong>${maxInstallment}</strong> (Setara pinjaman <strong>${maxLoanAmount}</strong>).`,
                summaryText_Limited: (maxInstallment, maxLoanAmount) => `Kapasitas Anda terbatas. Sebaiknya cicilan baru tidak melebihi <strong>${maxInstallment}</strong>.`,
                summaryText_Warning: "Sebaiknya Anda fokus melunasi utang yang ada sebelum mengambil pinjaman baru.",

                errorInput: "Harap masukkan nilai yang valid.",
                
                sectionHeader1: "Apa itu Debt Service Ratio (DSR)?",
                content1: "DSR adalah rasio total cicilan utang dibagi pendapatan bulanan. Jika DSR di atas 40%, bank menganggap risiko tinggi.",
                sectionHeader2: "Mengapa Batas 35% Penting?",
                content2: "Membatasi utang di angka 35% memastikan Anda memiliki sisa uang yang cukup untuk tabungan dan biaya hidup sehari-hari.",
            },
            en: {
                appTitle: "Loan Affordability Calculator",
                headerTitle: "Loan Affordability Calculator",
                toolSubtitle: "Avoid excessive debt. Calculate the safe maximum loan amount based on your net income and current debt obligations.",
                
                currencyLabel: "($)",
                
                sectionIncomeHeader: "1. Income & Debt Data",
                labelMonthlyIncome: "Total Net Monthly Income",
                labelExistingDebtPayment: "Current Monthly Debt Payments",
                descExistingDebtPayment: "Total existing installments (Mortgage, Car, Credit Cards).",
                
                sectionNewLoanHeader: "2. New Loan Details",
                labelLoanInterestRate: "Annual Interest (%)",
                labelLoanTermYears: "Loan Term (Years)",
                labelDSRLimit: "Ideal DSR Limit (%)",
                descDSRLimit: "Safe bank limits are usually 30% - 40%.",
                
                calculateButton: "Calculate Maximum Capacity",
                
                resultTitle: "Analysis Result",
                metricsHeader: "Maximum Capacity",
                resultMaxMonthlyInstallment: "Max New Monthly Installment",
                resultMaxLoanAmount: "Maximum Loan Amount",
                ratioVisualHeader: "DSR Capacity Usage",
                
                ratioLegend_Safe: (currentDSR, dsrLimit) => `Current DSR is ${currentDSR}%. You have safe room up to ${dsrLimit}%.`,
                ratioLegend_High: (currentDSR, dsrLimit) => `Current DSR is ${currentDSR}%. Borrowing room is very limited.`,
                ratioLegend_Over: (currentDSR, dsrLimit) => `DANGER! Your DSR (${currentDSR}%) exceeds the ideal limit (${dsrLimit}%). Do not take new debt.`,
                
                summaryTitle_Safe: "Status: Safe (Green)",
                summaryTitle_Limited: "Status: Caution (Yellow)",
                summaryTitle_Warning: "Status: Risky (Red)",
                
                summaryText_Safe: (maxInstallment, maxLoanAmount) => `Your finances are healthy. You can afford a new installment up to <strong>${maxInstallment}</strong> (Equivalent to <strong>${maxLoanAmount}</strong> loan).`,
                summaryText_Limited: (maxInstallment, maxLoanAmount) => `Your capacity is limited. New installments should not exceed <strong>${maxInstallment}</strong>.`,
                summaryText_Warning: "You should focus on paying off existing debt before taking a new loan.",

                errorInput: "Please enter valid values.",
                
                sectionHeader1: "What is Debt Service Ratio (DSR)?",
                content1: "DSR is the ratio of total debt payments to monthly income. If DSR is above 40%, banks consider it high risk.",
                sectionHeader2: "Why is the 35% Limit Important?",
                content2: "Limiting debt to 35% ensures you have enough remaining money for savings and daily living expenses.",
            }
        };

        const resultBox = document.getElementById('resultBox');
        const errorAlert = document.getElementById('errorAlert');
        const errorText = document.getElementById('errorText');
        const ratioFill = document.getElementById('ratioFill');

        // Helper Clean & Format
        function cleanInput(formattedValue) {
            if (typeof formattedValue !== 'string') return formattedValue;
            let cleaned = formattedValue.replace(/[^\d]/g, '');
            return parseFloat(cleaned) || 0;
        }

        function formatNumber(num) {
            const currencyCode = currentLang === 'id' ? 'IDR' : 'USD';
            const locale = currentLang === 'id' ? 'id-ID' : 'en-US';
            return num.toLocaleString(locale, {
                style: 'currency', currency: currencyCode, minimumFractionDigits: 0, maximumFractionDigits: 0
            });
        }

        function formatInput(inputElement) {
            let value = inputElement.value;
            let numericValue = value.replace(/[^0-9]/g, '');
            if (numericValue.length === 0) { inputElement.value = ''; return; }
            let number = parseInt(numericValue, 10);
            inputElement.value = number.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', {
                maximumFractionDigits: 0, minimumFractionDigits: 0
            });
        }

        function calculateAffordability(event) {
            if(event) event.preventDefault();
            const t = translations[currentLang];

            // 1. Ambil Input
            const monthlyIncome = cleanInput(document.getElementById('monthlyIncome').value);
            const existingDebtPayment = cleanInput(document.getElementById('existingDebtPayment').value);
            const loanInterestRate = parseFloat(document.getElementById('loanInterestRate').value) / 100;
            const loanTermYears = parseFloat(document.getElementById('loanTermYears').value);
            const dsrLimit = parseFloat(document.getElementById('dsrLimit').value);

            // 2. Validasi
            if (monthlyIncome <= 0 || loanTermYears <= 0 || dsrLimit <= 0) {
                errorText.textContent = t.errorInput;
                errorAlert.classList.remove('hidden');
                resultBox.classList.remove('visible');
                return;
            }
            errorAlert.classList.add('hidden');

            // 3. Logic Hitung
            const maxTotalPayment = monthlyIncome * (dsrLimit / 100);
            const maxNewInstallment = Math.max(0, maxTotalPayment - existingDebtPayment);
            const currentDSR = (existingDebtPayment / monthlyIncome) * 100;
            const currentDSRFormatted = currentDSR.toFixed(1);

            // Hitung Max Loan (PV Formula)
            let maxLoanAmount = 0;
            if (maxNewInstallment > 0) {
                const rateMonthly = loanInterestRate / 12;
                const nMonths = loanTermYears * 12;
                maxLoanAmount = maxNewInstallment * (1 - Math.pow(1 + rateMonthly, -nMonths)) / rateMonthly;
            }

            // 4. Status & Visualisasi
            let summaryTitleKey, summaryText, barColor;
            
            if (currentDSR > dsrLimit) {
                summaryTitleKey = 'summaryTitle_Warning';
                summaryText = t.summaryText_Warning;
                barColor = '#ef4444'; // Red-500
            } else if (maxNewInstallment < monthlyIncome * 0.10) {
                summaryTitleKey = 'summaryTitle_Limited';
                summaryText = t.summaryText_Limited(formatNumber(maxNewInstallment), formatNumber(maxLoanAmount));
                barColor = '#eab308'; // Yellow-500
            } else {
                summaryTitleKey = 'summaryTitle_Safe';
                summaryText = t.summaryText_Safe(formatNumber(maxNewInstallment), formatNumber(maxLoanAmount));
                barColor = '#22c55e'; // Green-500
            }

            // Render Output
            document.getElementById('summaryTitle').textContent = t[summaryTitleKey];
            document.getElementById('summaryText').innerHTML = summaryText;
            
            document.getElementById('maxMonthlyInstallmentResult').textContent = formatNumber(Math.round(maxNewInstallment));
            document.getElementById('maxLoanAmountResult').textContent = formatNumber(Math.round(maxLoanAmount));
            document.getElementById('currentDSRResult').textContent = currentDSRFormatted + '%';
            
            // Visual Bar
            const barWidth = Math.min(100, (currentDSR / dsrLimit) * 100);
            ratioFill.style.width = `${barWidth}%`;
            ratioFill.style.backgroundColor = barColor;
            
            // Legend Text
            if(currentDSR > dsrLimit) {
                 document.getElementById('ratioLegend').textContent = t.ratioLegend_Over(currentDSRFormatted, dsrLimit);
            } else if (barWidth > 80) {
                 document.getElementById('ratioLegend').textContent = t.ratioLegend_High(currentDSRFormatted, dsrLimit);
            } else {
                 document.getElementById('ratioLegend').textContent = t.ratioLegend_Safe(currentDSRFormatted, dsrLimit);
            }

            resultBox.classList.add('visible');
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];

            document.getElementById('appTitle').textContent = t.appTitle;
            document.getElementById('headerTitle').textContent = t.headerTitle;
            document.getElementById('toolSubtitle').textContent = t.toolSubtitle;
            
            document.querySelectorAll('.currency-label').forEach(el => el.textContent = t.currencyLabel);

            // Labels
            document.getElementById('sectionIncomeHeader').textContent = t.sectionIncomeHeader;
            document.getElementById('labelMonthlyIncome').textContent = t.labelMonthlyIncome;
            document.getElementById('labelExistingDebtPayment').textContent = t.labelExistingDebtPayment;
            document.getElementById('descExistingDebtPayment').textContent = t.descExistingDebtPayment;
            
            document.getElementById('sectionNewLoanHeader').textContent = t.sectionNewLoanHeader;
            document.getElementById('labelLoanInterestRate').textContent = t.labelLoanInterestRate;
            document.getElementById('labelLoanTermYears').textContent = t.labelLoanTermYears;
            document.getElementById('labelDSRLimit').textContent = t.labelDSRLimit;
            document.getElementById('descDSRLimit').textContent = t.descDSRLimit;
            
            document.getElementById('calculateButton').textContent = t.calculateButton;

            // Result Headers
            document.getElementById('resultTitle').textContent = t.resultTitle;
            document.getElementById('metricsHeader').textContent = t.metricsHeader;
            document.getElementById('resultMaxMonthlyInstallment').textContent = t.resultMaxMonthlyInstallment;
            document.getElementById('resultMaxLoanAmount').textContent = t.resultMaxLoanAmount;
            document.getElementById('ratioVisualHeader').textContent = t.ratioVisualHeader;

            // Edukasi
            document.getElementById('sectionHeader1').textContent = t.sectionHeader1;
            document.getElementById('content1').innerHTML = t.content1;
            document.getElementById('sectionHeader2').textContent = t.sectionHeader2;
            document.getElementById('content2').innerHTML = t.content2;

            // Re-format Inputs
            ['monthlyIncome', 'existingDebtPayment'].forEach(id => {
                const input = document.getElementById(id);
                if (input.value) {
                    const cleaned = cleanInput(input.value);
                    input.value = cleaned.toLocaleString(lang === 'id' ? 'id-ID' : 'en-US', {
                        maximumFractionDigits: 0, minimumFractionDigits: 0
                    });
                }
            });

            updateRelatedContent(lang);

            if(resultBox.classList.contains('visible')){
                calculateAffordability();
            }
        }

        function updateRelatedContent(lang) {
            document.querySelectorAll('#related-tools-section [data-en]').forEach(el => {
                const text = el.getAttribute(`data-${lang}`);
                if(text) el.textContent = text;
            });
        }

        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'lang') {
                    setLanguage(document.documentElement.lang || 'en');
                }
            });
        });
        observer.observe(document.documentElement, { attributes: true });

        document.addEventListener('DOMContentLoaded', () => {
            setLanguage(document.documentElement.lang || 'en');
        });
    </script>
</body>
</html>