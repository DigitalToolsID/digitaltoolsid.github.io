<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">

    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-pajak-keuntungan-modal/" />
    
    <meta name="description" content="Capital Gains Tax Calculator Indonesia. Calculate estimated tax liability on investment profits (Stocks, Crypto, Property, etc.) accurately based on Indonesian tax regulations.">
    <meta name="keywords" content="Capital Gains Tax Calculator, Investment Tax Calculator, Crypto Tax Calculator, Kalkulator Pajak Keuntungan Modal, Hitung Pajak Saham, Pajak Kripto Indonesia, Pajak Properti, PPh Final, Pajak Reksa Dana, how to calculate investment tax, cara hitung pajak keuntungan investasi, estimasi pajak jual aset">
 
    <link rel="icon" href="data:,">
 
    <title id="appTitle">Capital Gains Tax Calculator - Indonesia</title>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>
    
    <style>
        /* STANDAR TAMPILAN: Hard Lock 50% untuk Desktop */
        @media (min-width: 1024px) {
            .layout-article-fixed {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 50% !important;
                margin-left: auto;
                margin-right: auto;
            }
        }

        /* CSS LOKAL (Spesifik Alat Ini) */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 2000px; 
            padding: 1.5rem; 
        }
        
        .input-description {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex flex-col items-center">
        <div class="w-full layout-article-fixed bg-white shadow-xl rounded-xl p-6 sm:p-8">
            
            <h1 id="headerTitle" class="text-3xl font-extrabold text-green-700 mb-3 text-center">Capital Gains Tax Calculator</h1>
            
            <p id="toolSubtitle" class="text-sm text-gray-700 font-medium mb-6 leading-relaxed text-justify">
               Estimate your tax liability on investment profits (Stocks, Crypto, Property, etc.) based on Indonesian tax regulations.
            </p>
            
            <form id="taxForm" onsubmit="calculateTax(event)" class="space-y-6">
                
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h2 class="text-lg font-bold mb-4 text-green-800" id="headerAsset">1. Asset Type & Transaction</h2>
                    
                    <div class="space-y-4">
                        <div class="relative">
                            <label for="assetType" class="block text-sm font-medium text-gray-700 mb-1" id="labelAssetType">Investment Asset Type</label>
                            <select id="assetType" onchange="updateTaxRateInfo()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 bg-white transition duration-150">
                                <option value="stock">Stocks (Saham Bursa Efek) - Final 0.1%</option>
                                <option value="crypto">Crypto (Kripto - Terdaftar Bappebti) - Final 0.1%</option>
                                <option value="property">Property (Tanah/Bangunan) - Final 2.5%</option>
                                <option value="mutualFund">Mutual Fund (Reksa Dana) - Tax Free</option>
                                <option value="bonds">Bonds (Obligasi/SBN) - Final 10%</option>
                                <option value="other">Other Assets (Emas/Saham Luar) - Progressive</option>
                            </select>
                            <p class="input-description" id="descAssetType">Select asset type to determine the applicable Indonesian tax rate.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div class="relative">
                                <label for="buyPrice" class="block text-sm font-medium text-gray-700 mb-1" id="labelBuyPrice">Total Capital / Buy Price</label>
                                <input type="text" id="buyPrice" inputmode="numeric" placeholder="e.g. 100,000,000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150" required>
                            </div>
                            
                            <div class="relative">
                                <label for="sellPrice" class="block text-sm font-medium text-gray-700 mb-1" id="labelSellPrice">Total Revenue / Sell Price</label>
                                <input type="text" id="sellPrice" inputmode="numeric" placeholder="e.g. 150,000,000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150" required>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="taxRateInfoBox" class="bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 rounded text-sm leading-relaxed" role="alert">
                    <p class="font-bold mb-1" id="taxRateTitle">Tax Rate Information</p>
                    <p id="taxRateDesc">...</p>
                </div>

                <button type="submit" id="calculateButton" class="w-full bg-green-600 text-white font-semibold py-3 rounded-xl shadow-md hover:bg-green-700 transition duration-300 ease-in-out transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                    Calculate Tax
                </button>
                
                <div id="errorAlert" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                    <span id="errorText" class="block sm:inline"></span>
                </div>
            </form>

            <div id="resultBox" class="result-box mt-8 bg-green-50 border border-green-200 rounded-xl shadow-lg">
                
                <h3 id="resultHeader" class="text-xl font-bold mb-6 text-green-800 border-b border-green-200 pb-2">Calculation Result</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-center">
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                        <p id="labelCapitalGain" class="text-sm font-bold text-gray-600 uppercase tracking-wider">Gross Capital Gain</p>
                        <p id="resultCapitalGain" class="text-2xl font-extrabold text-green-700 mt-2">0</p>
                        <p class="text-xs text-gray-500 mt-1" id="descCapitalGain">Profit before tax</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-red-100">
                        <p id="labelEstimatedTax" class="text-sm font-bold text-gray-600 uppercase tracking-wider">Estimated Tax Due</p>
                        <p id="resultEstimatedTax" class="text-2xl font-extrabold text-red-600 mt-2">0</p>
                        <p class="text-xs text-gray-500 mt-1" id="descEstimatedTax">Tax amount to be paid</p>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-lg border border-green-200 text-center mb-6 shadow-sm">
                    <p id="labelNetProfit" class="text-lg font-bold text-green-800 mb-1">Net Profit After Tax</p>
                    <p id="resultNetProfit" class="text-4xl font-extrabold text-green-600">0</p>
                </div>

                <div class="mb-6 bg-white p-4 rounded-lg border border-gray-100" id="interpretationBox">
                    <h4 id="headerInterpretation" class="text-md font-bold text-gray-800 mb-2">Analysis</h4>
                    <p id="textInterpretation" class="text-sm text-gray-700 leading-relaxed"></p>
                </div>
                
                <h4 id="detailHeader" class="text-lg font-bold text-gray-800 mb-3">Calculation Details</h4>
                <div class="bg-white rounded-lg shadow-sm overflow-hidden border border-gray-200 text-sm">
                    <div class="p-3 grid grid-cols-2 gap-4 border-b border-gray-100">
                        <div class="text-gray-600" id="labelTaxBase">Tax Base (DPP)</div>
                        <div class="text-right font-semibold" id="valTaxBase">0</div>
                    </div>
                    <div class="p-3 grid grid-cols-2 gap-4 border-b border-gray-100">
                         <div class="text-gray-600" id="labelAppliedRate">Applied Tax Rate</div>
                         <div class="text-right font-semibold text-blue-600" id="valAppliedRate">0%</div>
                    </div>
                     <div class="p-3 grid grid-cols-2 gap-4 border-b border-gray-100 font-bold bg-red-50">
                        <div class="text-red-700" id="labelFinalTax">Tax Liability</div>
                        <div class="text-right text-red-700" id="valFinalTax">0</div>
                    </div>
                </div>

            </div>
            
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Understanding Capital Gains Tax in Indonesia</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>

                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">Final vs. Non-Final Tax</h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>

                <h3 id="sectionHeader3" class="text-lg font-bold text-gray-800 mb-2">Tax Reporting Tips</h3>
                <p id="content3" class="text-gray-600 text-sm leading-relaxed text-justify mb-2"></p>
                <ul class="text-gray-600 text-sm leading-relaxed text-justify mb-6 list-disc ml-6 space-y-1">
                    <li id="tip1"></li>
                    <li id="tip2"></li>
                    <li id="tip3"></li>
                </ul>

                <h3 id="sectionHeader4" class="text-lg font-bold text-gray-800 mb-2">Disclaimer</h3>
                <p id="content4" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>
            </section>

        </div>
    </main>

    <section id="related-tools-section" class="layout-article-fixed w-full px-4 py-8 mb-4">
        <div class="flex items-center mb-5">
            <div class="w-1 h-7 mr-3 bg-green-600 dynamic-bg"></div> 
            <h2 class="text-xl font-bold text-gray-800" 
                data-en="Investment & Finance Tools" 
                data-id="Alat Investasi & Keuangan">
                Investment & Finance Tools
            </h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
            
            <a href="../kalkulator-imbal-hasil-saham/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Stock Return Calculator"
                    data-id="Kalkulator Imbal Hasil Saham">
                    Stock Return Calculator
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Calculate Net Profit after broker fees."
                    data-id="Hitung keuntungan bersih setelah fee broker.">
                    Calculate Net Profit after broker fees.
                </p>
            </a>

            <a href="../kalkulator-pph/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Income Tax Calculator (PPh 21)"
                    data-id="Kalkulator PPh 21 (Terbaru)">
                    Income Tax Calculator (PPh 21)
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Estimate your take-home pay."
                    data-id="Estimasi gaji bersih (Take Home Pay).">
                    Estimate your take-home pay.
                </p>
            </a>

            <a href="../kalkulator-npv-irr-bep/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Business Viability (NPV & IRR)"
                    data-id="Kelayakan Bisnis (NPV & IRR)">
                    Business Viability (NPV & IRR)
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Analyze investment profitability."
                    data-id="Analisis profitabilitas investasi bisnis.">
                    Analyze investment profitability.
                </p>
            </a>

        </div>

        <div class="border-t border-gray-100 pt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4" 
                data-en="Related Articles:" 
                data-id="Artikel Terkait:">
                Related Articles:
            </h3>
            <ul class="space-y-3">
                <li>
                    <a href="../articles/klausul-perpajakan-kontrak.html" class="flex items-center text-sm hover:underline group text-blue-600 hover:text-blue-800">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 dynamic-bg-group"></span>
                        <span data-en="Understanding Tax Clauses in Contracts" 
                              data-id="Memahami Klausul Perpajakan dalam Kontrak">
                            Understanding Tax Clauses in Contracts
                        </span>
                    </a>
                </li>
                <li>
                    <a href="../articles/strategi-mempercepat-pelunasan-utang.html" class="flex items-center text-sm hover:underline group text-blue-600 hover:text-blue-800">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 dynamic-bg-group"></span>
                        <span data-en="Strategies to Accelerate Debt Repayment" 
                              data-id="Strategi Mempercepat Pelunasan Utang">
                            Strategies to Accelerate Debt Repayment
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </section>

    <div id="global-footer-container"></div>

    <script src="../components.js"></script>
    <script>
        // Set Header Category untuk Finance (Hijau)
        window.headerCategory = 'finance';

        // **********************************************
        // LOGIKA KALKULATOR PAJAK KEUNTUNGAN MODAL
        // **********************************************

        const translations = {
            id: {
                appTitle: "Kalkulator Pajak Modal",
                headerTitle: "Kalkulator Pajak Keuntungan Modal",
                toolSubtitle: "Berapa pajak yang harus Anda bayar dari keuntungan investasi? Di Indonesia, aturan pajak berbeda untuk setiap jenis aset. Saham dan properti dikenakan Pajak Final dari nilai transaksi (bukan dari keuntungan), sementara aset lain seperti Emas atau Saham Luar Negeri dihitung dari keuntungan bersih.",
                
                headerAsset: "1. Jenis Aset & Transaksi",
                labelAssetType: "Jenis Aset Investasi",
                descAssetType: "Pilih jenis aset untuk menentukan tarif pajak yang berlaku di Indonesia.",
                labelBuyPrice: "Total Modal / Harga Beli",
                labelSellPrice: "Total Penjualan / Harga Jual",
                
                // Tax Rate Info
                taxInfoStock: "<b>Saham (Bursa Efek Indonesia):</b> Dikenakan PPh Final 0,1% dari Nilai Transaksi Penjualan (bukan dari keuntungan).",
                taxInfoCrypto: "<b>Kripto (Exchanger Terdaftar):</b> Dikenakan PPh Final 0,1% dari Nilai Transaksi Penjualan (PPh 22).",
                taxInfoProperty: "<b>Properti:</b> Dikenakan PPh Final 2,5% dari Nilai Transaksi Penjualan (bukan dari keuntungan).",
                taxInfoMutualFund: "<b>Reksa Dana:</b> Bukan objek pajak. Keuntungan yang dicairkan tidak dikenakan pajak lagi (Tax Free).",
                taxInfoBonds: "<b>Obligasi/SBN:</b> Dikenakan PPh Final 10% dari keuntungan (Capital Gain) atau Kupon.",
                taxInfoOther: "<b>Aset Lain (Emas/Saham Luar):</b> Keuntungan dianggap sebagai penghasilan biasa dan dikenakan tarif progresif PPh 17 (5% - 35%) dalam SPT Tahunan.",
                taxRateTitle: "Informasi Tarif Pajak",

                calculateButton: "Hitung Pajak",
                inputError: "Mohon masukkan nilai yang valid.",
                
                resultHeader: "Hasil Perhitungan",
                labelCapitalGain: "Keuntungan Kotor (Capital Gain)",
                descCapitalGain: "Selisih Jual - Beli (Sebelum Pajak)",
                labelEstimatedTax: "Estimasi Pajak Terutang",
                descEstimatedTax: "Total pajak yang harus dibayar/dipotong",
                labelNetProfit: "Keuntungan Bersih (Setelah Pajak)",
                
                headerInterpretation: "Analisis",
                interpFinal: "<b>Pajak Final:</b> Pajak untuk aset ini dihitung berdasarkan <b>Nilai Total Penjualan</b> (Omzet), bukan keuntungan. Artinya, meskipun Anda rugi (Jual < Beli), Anda tetap harus membayar pajak ini saat transaksi penjualan.",
                interpGain: "<b>Pajak atas Keuntungan:</b> Pajak untuk aset ini dihitung hanya dari <b>Keuntungan Bersih (Gain)</b>. Jika Anda rugi, tidak ada pajak yang harus dibayar.",
                interpExempt: "<b>Bebas Pajak:</b> Aset ini bukan merupakan objek pajak penghasilan. Seluruh keuntungan menjadi milik Anda sepenuhnya.",
                
                detailHeader: "Rincian Perhitungan",
                labelTaxBase: "Dasar Pengenaan Pajak (DPP)",
                labelAppliedRate: "Tarif Pajak yang Berlaku",
                labelFinalTax: "Kewajiban Pajak",
                
                sectionHeader1: "Memahami Pajak Investasi di Indonesia",
                content1: "Indonesia menganut sistem perpajakan yang unik untuk investasi. Sebagian besar aset pasar modal (Saham, Obligasi) dan Properti menggunakan skema <b>PPh Final</b>. Artinya, pajak dipotong langsung saat transaksi atau saat menerima bunga, dan kewajiban pajaknya dianggap 'selesai'.",
                sectionHeader2: "Pajak Final vs. Non-Final",
                content2: "Perbedaan utamanya adalah pada basis perhitungan. <b>Pajak Final</b> (seperti Saham 0,1% atau Properti 2,5%) dihitung dari <i>Nilai Bruto Transaksi</i>. Ini sederhana tapi bisa merugikan jika Anda mengalami kerugian investasi (karena tetap bayar pajak). Sebaliknya, aset Non-Final (seperti Emas atau Crypto di exchanger luar negeri) pajaknya dihitung dari <i>Keuntungan Bersih</i>.",
                sectionHeader3: "Tips Pelaporan Pajak",
                content3: "Agar terhindar dari masalah di kemudian hari:",
                tip1: "<b>Simpan Bukti Potong:</b> Untuk aset dengan PPh Final (Saham/Obligasi), sekuritas akan memberikan bukti potong.",
                tip2: "<b>Lapor di Kolom yang Tepat:</b> Di SPT Tahunan, pastikan Anda memasukkan harta investasi di kolom 'Harta' dan keuntungan di kolom 'Penghasilan yang Dikenakan PPh Final' atau 'Penghasilan Lainnya'.",
                tip3: "<b>Reksa Dana:</b> Meskipun bukan objek pajak, tetap harus dilaporkan dalam daftar harta SPT Tahunan.",
                sectionHeader4: "Disclaimer",
                content4: "Kalkulator ini menggunakan tarif pajak yang berlaku di Indonesia per tahun 2025 (UU HPP). Perhitungan untuk 'Aset Lainnya' menggunakan asumsi tarif pajak rata-rata 15% untuk estimasi, namun realisasinya bergantung pada total penghasilan tahunan Anda (Tarif Progresif)."
            },
            en: {
                appTitle: "Capital Gains Tax Calculator",
                headerTitle: "Capital Gains Tax Calculator",
                toolSubtitle: "How much tax do you owe on your investment profits? In Indonesia, tax rules vary by asset type. Stocks and property are subject to a Final Tax on the transaction value (not profit), while other assets like Gold or Foreign Stocks are taxed on net gains.",
                
                headerAsset: "1. Asset Type & Transaction",
                labelAssetType: "Investment Asset Type",
                descAssetType: "Select asset type to determine the applicable Indonesian tax rate.",
                labelBuyPrice: "Total Capital / Buy Price",
                labelSellPrice: "Total Revenue / Sell Price",
                
                taxInfoStock: "<b>Stocks (IDX):</b> Subject to 0.1% Final Tax on the Gross Sales Value (not on profit).",
                taxInfoCrypto: "<b>Crypto (Registered Exchanger):</b> Subject to 0.1% Final Tax on Gross Sales Value (PPh 22).",
                taxInfoProperty: "<b>Property:</b> Subject to 2.5% Final Tax on Gross Sales Value (not on profit).",
                taxInfoMutualFund: "<b>Mutual Funds:</b> Not a tax object. Profits realized are Tax-Free.",
                taxInfoBonds: "<b>Bonds/SBN:</b> Subject to 10% Final Tax on Capital Gains or Coupons.",
                taxInfoOther: "<b>Other Assets (Gold/Foreign Stocks):</b> Profits are treated as regular income and subject to progressive tax rates (5% - 35%) in the Annual Tax Return.",
                taxRateTitle: "Tax Rate Information",

                calculateButton: "Calculate Tax",
                inputError: "Please enter valid numeric values.",
                
                resultHeader: "Calculation Result",
                labelCapitalGain: "Gross Capital Gain",
                descCapitalGain: "Sell Price - Buy Price (Pre-Tax)",
                labelEstimatedTax: "Estimated Tax Due",
                descEstimatedTax: "Total tax to be paid/withheld",
                labelNetProfit: "Net Profit (After Tax)",
                
                headerInterpretation: "Analysis",
                interpFinal: "<b>Final Tax:</b> Tax for this asset is calculated based on the <b>Total Sales Value</b> (Revenue), not the profit. This means even if you sell at a loss, you still have to pay this tax upon transaction.",
                interpGain: "<b>Tax on Gain:</b> Tax for this asset is calculated only on the <b>Net Profit (Gain)</b>. If you sell at a loss, no tax is due.",
                interpExempt: "<b>Tax Exempt:</b> This asset is not a subject of income tax. The entire profit belongs to you.",
                
                detailHeader: "Calculation Details",
                labelTaxBase: "Tax Base (DPP)",
                labelAppliedRate: "Applied Tax Rate",
                labelFinalTax: "Tax Liability",
                
                sectionHeader1: "Understanding Investment Taxes in Indonesia",
                content1: "Indonesia has a unique tax system for investments. Most capital market assets (Stocks, Bonds) and Property use a <b>Final Tax</b> scheme. This means the tax is withheld immediately upon transaction or payout, and the tax obligation is considered 'final'.",
                sectionHeader2: "Final vs. Non-Final Tax",
                content2: "The main difference lies in the calculation basis. <b>Final Tax</b> (like Stock 0.1% or Property 2.5%) is calculated from the <i>Gross Transaction Value</i>. This is simple but can be disadvantageous if you sell at a loss. Conversely, Non-Final assets are taxed on <i>Net Profit</i>.",
                sectionHeader3: "Tax Reporting Tips",
                content3: "To avoid future issues:",
                tip1: "<b>Keep Withholding Slips:</b> For Final Tax assets (Stocks/Bonds), the securities firm will provide a withholding slip.",
                tip2: "<b>Report Correctly:</b> In your Annual Tax Return, ensure you list investment assets under 'Assets' and profits under 'Income Subject to Final Tax' or 'Other Income'.",
                tip3: "<b>Mutual Funds:</b> Even though tax-free, they must still be reported in the Assets list of your tax return.",
                sectionHeader4: "Disclaimer",
                content4: "This calculator uses Indonesian tax rates effective as of 2025 (UU HPP). Calculations for 'Other Assets' use an assumed average tax rate of 15% for estimation, but actual liability depends on your total annual income (Progressive Rate)."
            }
        };

        let currentLang = 'en'; 

        // Tax Configuration
        const TaxConfig = {
            stock: { type: 'final_revenue', rate: 0.001 },      // 0.1% dari Nilai Jual
            crypto: { type: 'final_revenue', rate: 0.001 },     // 0.1% dari Nilai Jual
            property: { type: 'final_revenue', rate: 0.025 },   // 2.5% dari Nilai Jual
            mutualFund: { type: 'exempt', rate: 0 },            // Bebas Pajak
            bonds: { type: 'final_gain', rate: 0.10 },          // 10% dari Keuntungan
            other: { type: 'progressive_gain', rate: 0.15 }     // Asumsi 15% dari Keuntungan
        };

        function formatNumber(amount, decimalPlaces = 0) {
            const locale = currentLang === 'id' ? 'id-ID' : 'en-US';
            return new Intl.NumberFormat(locale, {
                minimumFractionDigits: decimalPlaces,
                maximumFractionDigits: decimalPlaces,
            }).format(amount);
        }

        function formatInput(inputElement) {
            let rawValue = inputElement.value.replace(/\D/g, '');
            if (rawValue) {
                const numericValue = parseInt(rawValue, 10);
                inputElement.value = formatNumber(numericValue);
            } else {
                inputElement.value = '';
            }
        }
        
        function cleanInput(formattedValue) {
            return parseFloat(formattedValue.replace(/\D/g, '')) || 0;
        }

        function updateTaxRateInfo() {
            const assetType = document.getElementById('assetType').value;
            const infoBox = document.getElementById('taxRateDesc');
            const t = translations[currentLang];
            
            let infoKey = 'taxInfo' + assetType.charAt(0).toUpperCase() + assetType.slice(1);
            if (t[infoKey]) {
                infoBox.innerHTML = t[infoKey];
            }
            
            // Refresh calc if visible
            if(document.getElementById('resultBox').classList.contains('visible')){
                calculateTax({preventDefault:()=>{}});
            }
        }

        function calculateTax(event) {
            event.preventDefault();
            // 1. Inputs
            const assetType = document.getElementById('assetType').value;
            const buyPrice = cleanInput(document.getElementById('buyPrice').value);
            const sellPrice = cleanInput(document.getElementById('sellPrice').value);

            // 2. Validasi
            if (buyPrice < 0 || sellPrice < 0) {
                document.getElementById('errorAlert').classList.remove('hidden');
                document.getElementById('errorText').textContent = translations[currentLang].inputError;
                return;
            }
            document.getElementById('errorAlert').classList.add('hidden');

            // 3. Perhitungan
            const capitalGain = sellPrice - buyPrice;
            const config = TaxConfig[assetType];
            let taxAmount = 0;
            let taxBase = 0;
            let interpretationType = '';

            if (config.type === 'final_revenue') {
                taxBase = sellPrice;
                taxAmount = sellPrice * config.rate;
                interpretationType = 'interpFinal';
            } else if (config.type === 'final_gain' || config.type === 'progressive_gain') {
                taxBase = Math.max(0, capitalGain);
                taxAmount = taxBase * config.rate;
                interpretationType = 'interpGain';
            } else if (config.type === 'exempt') {
                taxBase = 0;
                taxAmount = 0;
                interpretationType = 'interpExempt';
            }
            
            const netProfit = capitalGain - taxAmount;

            // 4. Tampilkan Hasil
            document.getElementById('resultCapitalGain').textContent = formatNumber(Math.round(capitalGain));
            document.getElementById('resultEstimatedTax').textContent = formatNumber(Math.round(taxAmount));
            document.getElementById('resultNetProfit').textContent = formatNumber(Math.round(netProfit));
            
            // Details
            document.getElementById('valTaxBase').textContent = formatNumber(Math.round(taxBase));
            document.getElementById('valAppliedRate').textContent = (config.rate * 100).toFixed(1) + "%";
            document.getElementById('valFinalTax').textContent = formatNumber(Math.round(taxAmount));
            
            // Interpretation
            document.getElementById('textInterpretation').innerHTML = translations[currentLang][interpretationType];
            
            // Styling for Gain/Loss (Capital Gain)
            const gainElem = document.getElementById('resultCapitalGain');
            if (capitalGain >= 0) {
                gainElem.classList.remove('text-red-600');
                gainElem.classList.add('text-green-700');
            } else {
                gainElem.classList.remove('text-green-700');
                gainElem.classList.add('text-red-600');
            }

            // Styling for Net Profit (Dinamis: Merah jika Rugi, Hijau jika Untung)
            const netProfitElem = document.getElementById('resultNetProfit');
            if (netProfit >= 0) {
                netProfitElem.classList.remove('text-red-600');
                netProfitElem.classList.add('text-green-600');
            } else {
                netProfitElem.classList.remove('text-green-600');
                netProfitElem.classList.add('text-red-600');
            }

            document.getElementById('resultBox').classList.add('visible');
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            // Simpan values
            const buyVal = document.getElementById('buyPrice').value;
            const sellVal = document.getElementById('sellPrice').value;

            // Update Text
            const elements = [
                'appTitle', 'headerTitle', 'toolSubtitle', 'headerAsset', 'labelAssetType', 
                'descAssetType', 'labelBuyPrice', 'labelSellPrice', 'taxRateTitle', 'calculateButton',
                'resultHeader', 'labelCapitalGain', 'descCapitalGain', 'labelEstimatedTax', 
                'descEstimatedTax', 'labelNetProfit', 'headerInterpretation', 'detailHeader', 
                'labelTaxBase', 'labelAppliedRate', 'labelFinalTax', 'sectionHeader1', 'content1',
                'sectionHeader2', 'content2', 'sectionHeader3', 'content3', 'tip1', 'tip2', 'tip3',
                'sectionHeader4', 'content4'
            ];
            
            elements.forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                     if(['content1','content2','content3','toolSubtitle'].includes(id)) el.innerHTML = t[id]; // innerHTML for paragraphs with tags
                     else if (['tip1','tip2','tip3'].includes(id)) el.innerHTML = t[id];
                     else el.textContent = t[id];
                }
            });

            // Re-format Inputs
            document.getElementById('buyPrice').value = formatNumber(cleanInput(buyVal));
            document.getElementById('sellPrice').value = formatNumber(cleanInput(sellVal));
            
            // Update Info Box Content
            updateTaxRateInfo();
            
            // Update Related Content Language
            updateRelatedContent(lang);

            // Refresh Calc if visible
            if(document.getElementById('resultBox').classList.contains('visible')){
                calculateTax({preventDefault:()=>{}});
            }
        }

        function updateRelatedContent(lang) {
            const translatableElements = document.querySelectorAll('#related-tools-section [data-en]');
            translatableElements.forEach(el => {
                const newText = el.getAttribute(`data-${lang}`);
                if (newText) {
                    el.textContent = newText;
                }
            });
        }

        // Observer
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'lang') {
                    const currentLang = document.documentElement.lang || 'en';
                    setLanguage(currentLang);
                }
            });
        });
        observer.observe(document.documentElement, { attributes: true });

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            const buyInput = document.getElementById('buyPrice');
            const sellInput = document.getElementById('sellPrice');
            if(buyInput.value) buyInput.value = formatNumber(cleanInput(buyInput.value));
            if(sellInput.value) sellInput.value = formatNumber(cleanInput(sellInput.value));
            
            setLanguage('en'); 
            updateTaxRateInfo();
        });
    </script>
</body>
</html>