<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-anggaran-bulanan/" />
    <meta name="description" content="Kalkulator Anggaran Bulanan Cepat dan Akurat. Gunakan metode 50/30/20 untuk membagi pendapatan Anda ke dalam Kebutuhan, Keinginan, dan Tabungan/Investasi. Kelola keuangan Anda dengan mudah." />
    <title id="appTitle">Kalkulator Anggaran Bulanan (Metode 50/30/20)</title>
    
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>

    <style>
        /* --- CSS LOKAL SPESIFIK HALAMAN INI --- */
        
        /* Definisi Warna Grafik (Manual agar aman tanpa regenerasi output.css) */
        .bg-finance-color { background-color: #27ae60; }
        .text-finance-color { color: #27ae60; }
        
        .bg-needs-color { background-color: #3498db; } /* Biru */
        .text-needs-color { color: #3498db; }
        .border-needs-color { border-color: #3498db; }

        .bg-wants-color { background-color: #f39c12; } /* Kuning/Orange */
        .text-wants-color { color: #f39c12; }
        .border-wants-color { border-color: #f39c12; }

        .bg-savings-color { background-color: #27ae60; } /* Hijau */
        .text-savings-color { color: #27ae60; }
        .border-savings-color { border-color: #27ae60; }
        
        .text-success-color { color: #27ae60; }
        .text-danger-color { color: #e74c3c; }
        .text-warning-color { color: #f39c12; }
        
        /* Background transparansi untuk alert */
        .bg-needs-color\/5 { background-color: rgba(52, 152, 219, 0.05); }
        .bg-wants-color\/5 { background-color: rgba(243, 156, 18, 0.05); }
        .bg-savings-color\/5 { background-color: rgba(39, 174, 96, 0.05); }
        .bg-success-color\/5 { background-color: rgba(39, 174, 96, 0.05); }
        .bg-danger-color\/5 { background-color: rgba(231, 76, 60, 0.05); }
        .bg-warning-color\/5 { background-color: rgba(243, 156, 18, 0.05); }


        /* Gaya Hasil */
        .result-box { 
            transition: all 0.5s ease-in-out;
            transform-origin: top center; 
            opacity: 0; 
            max-height: 0; 
            overflow: hidden; 
        }
        .result-box.visible { 
            opacity: 1;
            max-height: 3000px; 
            padding: 1.5rem; 
            margin-top: 1.5rem; 
        }

        /* Gaya Tombol */
        .calculate-button {
            box-shadow: 0 4px #1e8449; /* Warna hijau gelap */
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px #1e8449;
        }
        .calculate-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #1e8449;
        }

        /* Gaya untuk deskripsi input */
        .input-description {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        /* Gaya Progress Bar */
        .budget-bar {
            height: 10px;
            border-radius: 9999px;
            display: flex;
            overflow: hidden;
            margin-top: 10px;
        }
        .bar-segment {
            height: 100%;
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex justify-center">
        <div class="w-full max-w-lg bg-white shadow-xl rounded-xl p-6 sm:p-8">

            <h1 id="headerTitle" class="text-3xl font-extrabold text-primary-dark mb-3">Kalkulator Anggaran Bulanan</h1>
            <p id="toolSubtitle" class="text-base text-gray-700 font-medium mb-6">Kelola uang Anda secara efektif menggunakan metode <strong>50/30/20</strong> yang teruji: 50% untuk Kebutuhan, 30% untuk Keinginan, dan 20% untuk Tabungan/Investasi.</p>

            <form id="budgetForm" onsubmit="calculateBudget(event)" class="space-y-6">

                <div class="border-b pb-4 border-gray-200">
                    <h2 class="text-xl font-bold text-finance-color mb-3" id="sectionIncomeHeader">1. Pendapatan Bersih Bulanan</h2>
                    <div class="space-y-4">
                        <div class="relative">
                            <label for="monthlyIncome" class="block text-sm font-medium text-gray-700 mb-1" id="labelMonthlyIncome">Total Pendapatan Bersih (Setelah Pajak)</label>
                            <input type="text" id="monthlyIncome" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-secondary focus:border-secondary" placeholder="Contoh: 10.000.000" value="10000000">
                            <p class="input-description" id="descMonthlyIncome">Pendapatan yang masuk ke rekening Anda setiap bulan.</p>
                        </div>
                    </div>
                </div>

                <div class="pb-4">
                    <h2 class="text-xl font-bold text-finance-color mb-3" id="sectionSpendingHeader">2. Pengeluaran yang Dianggarkan</h2>
                    <div class="space-y-4">
                        
                        <div class="relative">
                            <label for="needsSpending" class="block text-sm font-medium text-gray-700 mb-1" id="labelNeedsSpending">Anggaran Kebutuhan (Needs)</label>
                            <input type="text" id="needsSpending" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-needs-color focus:border-needs-color" placeholder="Contoh: 4.500.000" value="4500000">
                            <p class="input-description" id="descNeedsSpending">Pengeluaran wajib bulanan: Sewa, cicilan, bahan makanan, transportasi dasar, utilitas, dan asuransi dasar.</p>
                        </div>

                        <div class="relative">
                            <label for="wantsSpending" class="block text-sm font-medium text-gray-700 mb-1" id="labelWantsSpending">Anggaran Keinginan (Wants)</label>
                            <input type="text" id="wantsSpending" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-wants-color focus:border-wants-color" placeholder="Contoh: 3.000.000" value="3000000">
                            <p class="input-description" id="descWantsSpending">Pengeluaran tidak wajib: Hiburan, makan di luar, *gadget* baru, layanan *streaming*, hobi, pakaian mahal.</p>
                        </div>

                        <div class="relative">
                            <label for="savingsInvestment" class="block text-sm font-medium text-gray-700 mb-1" id="labelSavingsInvestment">Anggaran Tabungan & Investasi (Savings & Investment)</label>
                            <input type="text" id="savingsInvestment" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-savings-color focus:border-savings-color" placeholder="Contoh: 2.000.000" value="2000000">
                            <p class="input-description" id="descSavingsInvestment">Dana darurat, dana pensiun, investasi saham/reksa dana, atau melunasi utang (selain cicilan wajib).</p>
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full bg-finance-color text-white font-semibold py-3 rounded-xl hover:bg-green-700 transition duration-300">
                    Analisis Anggaran 50/30/20
                </button>
            </form>

            <div id="errorAlert" class="hidden mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                <span id="errorText" class="block sm:inline"></span>
            </div>

            <div id="resultBox" class="result-box bg-secondary/5 border border-secondary/30 rounded-xl shadow-lg">

                <h3 id="resultTitle" class="text-2xl font-bold text-primary-dark mb-4 border-b pb-2">Hasil Analisis Anggaran</h3>

                <div class="mb-6">
                    <p class="text-sm font-medium text-gray-700 mb-2" id="visualHeader">Distribusi Anggaran vs. Pendapatan</p>
                    <div class="budget-bar bg-gray-200">
                        <div id="barNeeds" class="bar-segment bg-needs-color" style="width: 0%;"></div>
                        <div id="barWants" class="bar-segment bg-wants-color" style="width: 0%;"></div>
                        <div id="barSavings" class="bar-segment bg-savings-color" style="width: 0%;"></div>
                        <div id="barRemaining" class="bar-segment bg-gray-300" style="width: 0%;"></div>
                    </div>
                    <div class="text-center mt-2 text-sm" id="barLegend"></div>
                </div>

                <div id="resultSummaryText" class="p-4 rounded-lg mb-4 bg-white border border-gray-200">
                    <p class="text-lg font-bold mb-2" id="summaryTitle"></p>
                    <p id="summaryText" class="text-gray-700 text-sm"></p>
                </div>

                <h3 id="metricsHeader" class="text-xl font-bold text-primary mb-3 border-b pb-2">Detail Pembagian Anggaran</h3>
                <div id="metricsContent" class="space-y-3">
                    <div class="flex justify-between items-center p-3 rounded-lg border border-needs-color/30 bg-needs-color/5">
                        <p class="text-sm font-medium text-needs-color" id="resultNeeds">Kebutuhan (50%)</p>
                        <p class="text-lg font-bold" id="needsResult">--</p>
                    </div>
                    <div class="flex justify-between items-center p-3 rounded-lg border border-wants-color/30 bg-wants-color/5">
                        <p class="text-sm font-medium text-wants-color" id="resultWants">Keinginan (30%)</p>
                        <p class="text-lg font-bold" id="wantsResult">--</p>
                    </div>
                    <div class="flex justify-between items-center p-3 rounded-lg border border-savings-color/30 bg-savings-color/5">
                        <p class="text-sm font-medium text-savings-color" id="resultSavings">Tabungan & Investasi (20%)</p>
                        <p class="text-lg font-bold" id="savingsResult">--</p>
                    </div>
                    <div class="flex justify-between items-center p-3 rounded-lg border border-gray-300 bg-gray-100 mt-4">
                        <p class="text-base font-semibold text-gray-700" id="resultRemaining">Sisa/Defisit Dana</p>
                        <p class="text-xl font-extrabold" id="remainingResult">--</p>
                    </div>
                </div>
            </div>

            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Apa itu Metode 50/30/20?</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-4">Metode 50/30/20 adalah aturan mudah dalam penganggaran yang dipopulerkan oleh Senator AS Elizabeth Warren. Tujuannya adalah memastikan alokasi dana yang seimbang, di mana tidak ada kategori yang melebihi batas yang disarankan, sehingga Anda dapat menabung untuk masa depan tanpa merasa terlalu terkekang.</p>

                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">Pentingnya Kepatuhan (Compliance)</h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-4">Kepatuhan terhadap persentase ini adalah kunci. Jika pengeluaran Kebutuhan Anda melebihi 50%, ini bisa menjadi tanda bahwa biaya hidup Anda terlalu tinggi dibandingkan pendapatan, dan perlu peninjauan ulang (misalnya, mencari tempat tinggal yang lebih murah). Anggaran Keinginan yang melebihi 30% berarti Anda memprioritaskan kesenangan instan di atas keamanan finansial masa depan.</p>
            </section>
        </div>
    </main>

    <div id="global-footer-container"></div>

    <script>
        // PENTING: Set Kategori Header menjadi 'finance' agar warna menjadi HIJAU
        window.headerCategory = 'finance';
    </script>
    <script src="../components.js"></script>

    <script>
        // **********************************************
        // LOGIKA KALKULATOR ANGGARAN 50/30/20
        // **********************************************

        const NEEDS_PERCENT = 0.50;
        const WANTS_PERCENT = 0.30;
        const SAVINGS_PERCENT = 0.20;

        const translations = {
            id: {
                appTitle: "Kalkulator Anggaran Bulanan (Metode 50/30/20)",
                backToCatalogText: "Kembali ke Katalog Alat",
                headerTitle: "Kalkulator Anggaran Bulanan",
                toolSubtitle: "Kelola uang Anda secara efektif menggunakan metode <strong>50/30/20</strong> yang teruji: 50% untuk Kebutuhan, 30% untuk Keinginan, dan 20% untuk Tabungan/Investasi.",
                
                sectionIncomeHeader: "1. Pendapatan Bersih Bulanan",
                labelMonthlyIncome: "Total Pendapatan Bersih (Setelah Pajak)",
                descMonthlyIncome: "Pendapatan yang masuk ke rekening Anda setiap bulan.",
                sectionSpendingHeader: "2. Pengeluaran yang Dianggarkan",
                labelNeedsSpending: "Anggaran Kebutuhan (Needs)",
                descNeedsSpending: "Pengeluaran wajib bulanan: Sewa, cicilan, bahan makanan, transportasi dasar, utilitas, dan asuransi dasar.",
                labelWantsSpending: "Anggaran Keinginan (Wants)",
                descWantsSpending: "Pengeluaran tidak wajib: Hiburan, makan di luar, gadget baru, layanan streaming, hobi, pakaian mahal.",
                labelSavingsInvestment: "Anggaran Tabungan & Investasi (Savings & Investment)",
                descSavingsInvestment: "Dana darurat, dana pensiun, investasi saham/reksa dana, atau melunasi utang (selain cicilan wajib).",
                calculateButton: "Analisis Anggaran 50/30/20",
                
                resultTitle: "Hasil Analisis Anggaran",
                visualHeader: "Distribusi Anggaran vs. Pendapatan",
                metricsHeader: "Detail Pembagian Anggaran",
                resultNeeds: `Kebutuhan (Target ${NEEDS_PERCENT*100}%)`,
                resultWants: `Keinginan (Target ${WANTS_PERCENT*100}%)`,
                resultSavings: `Tabungan & Investasi (Target ${SAVINGS_PERCENT*100}%)`,
                resultRemaining: "Sisa/Defisit Dana",
                
                summaryTitle_Good: "Status: Anggaran Sehat dan Efisien",
                summaryTitle_Warning: "Status: Perlu Penyesuaian Kategori",
                summaryTitle_Danger: "Status: Anggaran Berisiko Defisit",

                summaryText_Good: (surplus, needsP, wantsP, savingsP) => `Anggaran Anda sangat baik. Semua kategori (Kebutuhan: ${needsP}%, Keinginan: ${wantsP}%, Tabungan: ${savingsP}%) mendekati pedoman 50/30/20 dan Anda memiliki surplus ${surplus}. Pertahankan manajemen ini!`,
                summaryText_Warning: (needsP, wantsP) => `Terdapat penyimpangan signifikan dari pedoman 50/30/20. Kebutuhan (${needsP}%) dan/atau Keinginan (${wantsP}%) Anda melebihi batas ideal. Prioritaskan mengurangi pengeluaran Keinginan untuk meningkatkan alokasi Tabungan.`,
                summaryText_Danger: (deficit, totalP) => `Peringatan: Total pengeluaran (${totalP}%) melebihi pendapatan. Anda mengalami defisit bulanan sebesar ${deficit}. Lakukan peninjauan total dan segera kurangi pengeluaran Keinginan dan Kebutuhan yang tidak penting.`,

                errorInput: "Harap masukkan semua nilai yang valid dan pastikan Pendapatan Bersih > 0.",
                
                sectionHeader1: "Apa itu Metode 50/30/20?",
                content1: "Metode 50/30/20 adalah aturan mudah dalam penganggaran yang dipopulerkan oleh Senator AS Elizabeth Warren. Tujuannya adalah memastikan alokasi dana yang seimbang, di mana tidak ada kategori yang melebihi batas yang disarankan, sehingga Anda dapat menabung untuk masa depan tanpa merasa terlalu terkekang.",
                sectionHeader2: "Pentingnya Kepatuhan (Compliance)",
                content2: "Kepatuhan terhadap persentase ini adalah kunci. Jika pengeluaran Kebutuhan Anda melebihi 50%, ini bisa menjadi tanda bahwa biaya hidup Anda terlalu tinggi dibandingkan pendapatan, dan perlu peninjauan ulang (misalnya, mencari tempat tinggal yang lebih murah). Anggaran Keinginan yang melebihi 30% berarti Anda memprioritaskan kesenangan instan di atas keamanan finansial masa depan.",
                
                // FOOTER
                footerPrivacy: "Kebijakan Privasi",
                footerTerms: "Syarat Ketentuan",
                footerAbout: "Tentang Kami",
                footerContact: "Hubungi Kami",
                footerDev: "Dikembangkan oleh DTID Analytics.",
            },
            en: {
                appTitle: "Monthly Budget Calculator (50/30/20 Method)",
                backToCatalogText: "Back to Tools Catalog",
                headerTitle: "Monthly Budget Calculator",
                toolSubtitle: "Effectively manage your money using the proven <strong>50/30/20</strong> method: 50% for Needs, 30% for Wants, and 20% for Savings/Investment.",
                
                sectionIncomeHeader: "1. Net Monthly Income",
                labelMonthlyIncome: "Total Net Income (After Tax)",
                descMonthlyIncome: "The income that hits your bank account every month.",
                sectionSpendingHeader: "2. Budgeted Expenses",
                labelNeedsSpending: "Needs Budget",
                descNeedsSpending: "Mandatory monthly expenses: Rent, loan payments, groceries, basic transport, utilities, and basic insurance.",
                labelWantsSpending: "Wants Budget",
                descWantsSpending: "Non-essential expenses: Entertainment, dining out, new gadgets, streaming services, hobbies, expensive clothing.",
                labelSavingsInvestment: "Savings & Investment Budget",
                descSavingsInvestment: "Emergency fund, retirement fund, stock/mutual fund investments, or paying off debt (other than mandatory installments).",
                calculateButton: "Analyze 50/30/20 Budget",
                
                resultTitle: "Budget Analysis Result",
                visualHeader: "Budget Distribution vs. Income",
                metricsHeader: "Budget Allocation Details",
                resultNeeds: `Needs (Target ${NEEDS_PERCENT*100}%)`,
                resultWants: `Wants (Target ${WANTS_PERCENT*100}%)`,
                resultSavings: `Savings & Investment (Target ${SAVINGS_PERCENT*100}%)`,
                resultRemaining: "Remaining/Deficit Fund",
                
                summaryTitle_Good: "Status: Healthy and Efficient Budget",
                summaryTitle_Warning: "Status: Category Adjustment Needed",
                summaryTitle_Danger: "Status: Budget at Risk of Deficit",

                summaryText_Good: (surplus, needsP, wantsP, savingsP) => `Your budget is excellent. All categories (Needs: ${needsP}%, Wants: ${wantsP}%, Savings: ${savingsP}%) are close to the 50/30/20 guideline and you have a surplus of ${surplus}. Keep up the great management!`,
                summaryText_Warning: (needsP, wantsP) => `There is a significant deviation from the 50/30/20 guideline. Your Needs (${needsP}%) and/or Wants (${wantsP}%) exceed the ideal limits. Prioritize reducing Wants spending to increase Savings allocation.`,
                summaryText_Danger: (deficit, totalP) => `Warning: Total expenses (${totalP}%) exceed income. You have a monthly deficit of ${deficit}. Conduct a total review and immediately reduce non-essential Wants and Needs spending.`,

                errorInput: "Please enter all valid values and ensure Net Income > 0.",
                
                sectionHeader1: "What is the 50/30/20 Method?",
                content1: "The 50/30/20 method is an easy budgeting rule popularized by US Senator Elizabeth Warren. Its goal is to ensure a balanced allocation of funds, where no category exceeds the suggested limit, allowing you to save for the future without feeling overly restricted.",
                sectionHeader2: "The Importance of Compliance",
                content2: "Adherence to these percentages is key. If your Needs spending exceeds 50%, it may signal that your cost of living is too high relative to your income, requiring a review (e.g., finding cheaper housing). Wants budgets exceeding 30% mean you are prioritizing instant gratification over future financial security.",
                
                // FOOTER
                footerPrivacy: "Privacy Policy",
                footerTerms: "Terms of Service",
                footerAbout: "About Us",
                footerContact: "Contact Us",
                footerDev: "Developed by DTID Analytics.",
            }
        };

        let currentLang = 'id'; // Default Indonesia
        const resultBox = document.getElementById('resultBox');
        const errorAlert = document.getElementById('errorAlert');
        const errorText = document.getElementById('errorText');

        // **********************************************
        // FUNGSI UTILITAS (FORMAT ANGKA)
        // **********************************************

        function cleanInput(formattedValue) {
            if (typeof formattedValue !== 'string') return formattedValue;
            let cleaned = formattedValue.replace(/\D/g, '');
            return parseFloat(cleaned) || 0;
        }

        function formatNumber(num) {
            return num.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).replace('IDR', 'Rp');
        }

        function formatInput(inputElement) {
            let value = inputElement.value;
            let numericValue = value.replace(/[^0-9]/g, '');
            if (numericValue.length === 0) {
                inputElement.value = '';
                return;
            }
            let number = parseInt(numericValue, 10);
            inputElement.value = number.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', {
                maximumFractionDigits: 0,
                minimumFractionDigits: 0
            });
        }

        // **********************************************
        // FUNGSI UTAMA: MENGHITUNG ANGGARAN
        // **********************************************

        function calculateBudget(event) {
            event.preventDefault();
            const t = translations[currentLang];
            
            // 1. Ambil Input
            const monthlyIncome = cleanInput(document.getElementById('monthlyIncome').value);
            const needsSpending = cleanInput(document.getElementById('needsSpending').value);
            const wantsSpending = cleanInput(document.getElementById('wantsSpending').value);
            const savingsInvestment = cleanInput(document.getElementById('savingsInvestment').value);

            // 2. Validasi
            if (monthlyIncome <= 0 || isNaN(monthlyIncome) || isNaN(needsSpending) || isNaN(wantsSpending) || isNaN(savingsInvestment)) {
                errorText.textContent = t.errorInput;
                errorAlert.classList.remove('hidden');
                resultBox.classList.remove('visible');
                return;
            }
            
            errorAlert.classList.add('hidden');

            // --- PERHITUNGAN ---
            const totalSpending = needsSpending + wantsSpending + savingsInvestment;
            const remaining = monthlyIncome - totalSpending;
            
            // Persentase yang dianggarkan
            const needsP = (needsSpending / monthlyIncome) * 100;
            const wantsP = (wantsSpending / monthlyIncome) * 100;
            const savingsP = (savingsInvestment / monthlyIncome) * 100;
            const totalP = (totalSpending / monthlyIncome) * 100;
            
            // --- LOGIKA KESIMPULAN ---
            let summaryTitleKey;
            let summaryText;
            let summaryBgClass;
            
            // Cek Status (Defisit/Surplus)
            if (remaining < 0) {
                summaryTitleKey = 'summaryTitle_Danger';
                summaryBgClass = 'text-danger-color border-danger-color/30 bg-danger-color/5';
                summaryText = t.summaryText_Danger(formatNumber(Math.abs(remaining)), totalP.toFixed(1));
            } else if (needsP > (NEEDS_PERCENT * 100) * 1.05 || wantsP > (WANTS_PERCENT * 100) * 1.05) {
                // Warning jika Kebutuhan atau Keinginan melebihi target (toleransi 5%)
                summaryTitleKey = 'summaryTitle_Warning';
                summaryBgClass = 'text-warning-color border-warning-color/30 bg-warning-color/5';
                summaryText = t.summaryText_Warning(needsP.toFixed(1), wantsP.toFixed(1));
            } else {
                summaryTitleKey = 'summaryTitle_Good';
                summaryBgClass = 'text-success-color border-success-color/30 bg-success-color/5';
                summaryText = t.summaryText_Good(formatNumber(remaining), needsP.toFixed(1), wantsP.toFixed(1), savingsP.toFixed(1));
            }

            // 3. Tampilkan Hasil
            
            // Tampilkan Ringkasan
            document.getElementById('summaryTitle').textContent = t[summaryTitleKey];
            document.getElementById('summaryText').innerHTML = summaryText;
            document.getElementById('resultSummaryText').className = `p-4 rounded-lg mb-4 border ${summaryBgClass}`;

            // Tampilkan Detail Angka
            document.getElementById('needsResult').innerHTML = `${formatNumber(needsSpending)} <span class="text-xs text-gray-500">(${needsP.toFixed(1)}%)</span>`;
            document.getElementById('wantsResult').innerHTML = `${formatNumber(wantsSpending)} <span class="text-xs text-gray-500">(${wantsP.toFixed(1)}%)</span>`;
            document.getElementById('savingsResult').innerHTML = `${formatNumber(savingsInvestment)} <span class="text-xs text-gray-500">(${savingsP.toFixed(1)}%)</span>`;
            
            // Tampilkan Sisa Dana
            document.getElementById('remainingResult').textContent = formatNumber(remaining);
            document.getElementById('remainingResult').className = `text-xl font-extrabold ${remaining >= 0 ? 'text-success-color' : 'text-danger-color'}`;

            // Tampilkan Visualisasi Bar
            const totalWidth = totalSpending > monthlyIncome ? totalSpending : monthlyIncome; // Untuk memastikan bar tidak terpotong jika defisit
            const needsWidth = (needsSpending / totalWidth) * 100;
            const wantsWidth = (wantsSpending / totalWidth) * 100;
            const savingsWidth = (savingsInvestment / totalWidth) * 100;
            
            document.getElementById('barNeeds').style.width = `${needsWidth}%`;
            document.getElementById('barWants').style.width = `${wantsWidth}%`;
            document.getElementById('barSavings').style.width = `${savingsWidth}%`;
            
            let remainingWidth = 100 - (needsWidth + wantsWidth + savingsWidth);
            if (remainingWidth < 0) remainingWidth = 0; // Jika defisit, bar akan penuh
            document.getElementById('barRemaining').style.width = `${remainingWidth}%`;
            
            let legendText;
            if (remaining >= 0) {
                legendText = `${formatNumber(remaining)} ${t.resultRemaining.split('/')[0]}`;
            } else {
                legendText = `${formatNumber(Math.abs(remaining))} ${t.resultRemaining.split('/')[1]}`;
            }
            document.getElementById('barLegend').textContent = remaining >= 0 ? 
                `${t.resultRemaining.split('/')[0]} ${formatNumber(remaining)}` : `${t.resultRemaining.split('/')[1]} ${formatNumber(Math.abs(remaining))}`;
            
            resultBox.classList.add('visible');
        }


        // **********************************************
        // FUNGSI TRANSLATE & INISIALISASI
        // **********************************************

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            // Update Header & Footer Modular
            const languageSwitcher = document.getElementById('languageSwitcher');
            if(languageSwitcher) {
                languageSwitcher.classList.remove('lang-en', 'lang-id');
                languageSwitcher.classList.add(`lang-${lang}`);
            }

            const backBtn = document.getElementById('backToCatalogText');
            if(backBtn) backBtn.textContent = t.backToCatalogText;
            
            // Update Footer Global (Jika ada)
            if(document.getElementById('footerPrivacy')) {
                document.getElementById('footerPrivacy').textContent = t.footerPrivacy;
                document.getElementById('footerTerms').textContent = t.footerTerms;
                document.getElementById('footerAbout').textContent = t.footerAbout;
                document.getElementById('footerContact').textContent = t.footerContact;
                const devSpan = document.getElementById('footerDev');
                if(devSpan) devSpan.textContent = t.footerDev;
            }

            document.documentElement.lang = lang;
            
            // Daftar ID elemen dan kunci terjemahan
            const elements = [
                'appTitle', 'backToCatalogText', 'headerTitle', 'toolSubtitle',
                'sectionIncomeHeader', 'labelMonthlyIncome', 'descMonthlyIncome',
                'sectionSpendingHeader', 
                'labelNeedsSpending', 'descNeedsSpending', 
                'labelWantsSpending', 'descWantsSpending', 
                'labelSavingsInvestment', 'descSavingsInvestment',
                'calculateButton',
                'resultTitle', 'visualHeader', 'metricsHeader',
                'resultNeeds', 'resultWants', 'resultSavings', 'resultRemaining',
                'sectionHeader1', 'content1', 'sectionHeader2', 'content2'
            ];

            elements.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    if (id === 'toolSubtitle') {
                         el.innerHTML = t[id];
                    } else {
                        el.textContent = t[id];
                    }
                }
            });

            // Re-format input values based on new language settings
            ['monthlyIncome', 'needsSpending', 'wantsSpending', 'savingsInvestment'].forEach(id => {
                const input = document.getElementById(id);
                if (input.value) {
                    const cleanedValue = cleanInput(input.value);
                    input.value = cleanedValue.toLocaleString(lang === 'id' ? 'id-ID' : 'en-US', {
                        maximumFractionDigits: 0,
                        minimumFractionDigits: 0
                    });
                }
            });

            // Sembunyikan hasil saat ganti bahasa
            resultBox.classList.remove('visible');
            errorAlert.classList.add('hidden');
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Inisialisasi input dengan format ribuan
            ['monthlyIncome', 'needsSpending', 'wantsSpending', 'savingsInvestment'].forEach(id => {
                const input = document.getElementById(id);
                if (input.value) {
                    input.value = cleanInput(input.value).toLocaleString('id-ID', {
                        maximumFractionDigits: 0,
                        minimumFractionDigits: 0
                    });
                }
            });

            // Logika Deteksi Bahasa Awal
            let defaultLang = 'id'; 
            const browserLang = (navigator.language || navigator.userLanguage).toLowerCase();
            if (browserLang.startsWith('en')) {
                defaultLang = 'en';
            }
            setLanguage(defaultLang);
        });
    </script>
</body>
</html>