<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-penarikan-dana-pensiun/" />
    <!-- Judul akan di-set oleh JS -->
 
    <meta name="description" content="Kalkulator Penarikan Dana Pensiun. Hitung berapa lama tabungan pensiun Anda akan bertahan dengan memperhitungkan penarikan bulanan, inflasi, dan hasil investasi." />
 
    <title id="appTitle">Retirement Withdrawal Calculator</title>
    <link rel="alternate" hreflang="id" href="https://digitaltoolsid.github.io/retirement-withdrawal-calculator/index.html" />
    <link rel="alternate" hreflang="en" href="https://digitaltoolsid.github.io/retirement-withdrawal-calculator/index.html" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Kode Google Analytic dan Adsense -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4885884866232864"
         crossorigin="anonymous"></script>
    
    <!-- Konfigurasi Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary': '#2c3e50', 
                        'secondary': '#3498db', 
                        'primary-dark': '#1e3a8a', 
                        'finance-color': '#27ae60', // Hijau untuk Keuangan
                        'retirement-color': '#d35400', // Oranye bata untuk Pensiun
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Gaya kustom untuk tampilan hasil */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 3000px; 
            padding: 1.5rem; 
        }
        
        /* Gaya Toggle Bahasa */
        .lang-toggle-container {
            position: relative;
            display: inline-flex;
            background-color: #e5e7eb; 
            border-radius: 9999px; 
            padding: 4px;
        }
        .lang-toggle-btn {
            padding: 6px 14px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            z-index: 10;
            color: #6b7280; 
            transition: color 0.3s ease;
            position: relative;
        }
        .lang-toggle-slider {
            position: absolute;
            top: 4px;
            left: 4px;
            height: calc(100% - 8px);
            width: calc(50% - 4px); 
            background-color: #1e3a8a; /* Primary-dark */
            border-radius: 9999px;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 5;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .lang-toggle-container.lang-en .lang-toggle-slider { transform: translateX(0%); }
        .lang-toggle-container.lang-id .lang-toggle-slider { transform: translateX(100%); }
        .lang-toggle-container.lang-en #lang-en { color: white; }
        .lang-toggle-container.lang-id #lang-id { color: white; }
        
        /* Gaya kustom untuk input dan tombol */
        .calculate-button {
            box-shadow: 0 4px #a04000; /* Warna oranye gelap */
            background-color: #d35400; /* retirement-color */
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px #a04000;
            background-color: #e67e22;
        }
        .calculate-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #a04000;
        }

        /* Gaya untuk deskripsi input */
        .input-description {
            font-size: 0.75rem; /* text-xs */
            color: #6b7280; /* text-gray-500 */
            margin-top: 0.25rem;
        }

        /* Gaya Kartu Hasil Utama */
        .result-card-main {
            background-color: #fff3e0; /* Orange 50 */
            border: 2px solid #ffb74d; /* Orange 300 */
        }
        .text-retirement-color { color: #d35400; }
        
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen font-sans" oncontextmenu="return false;" oncopy="return false;" oncut="return false;">

    <!-- Header -->
    <header class="bg-primary-dark text-white py-4 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <a href="../index.html" class="text-lg font-semibold tracking-tight text-gray-200 hover:text-white transition duration-150">
                &larr; <span id="backToCatalogText">Back to Tools Catalog</span>
            </a>
            <div id="languageSwitcher" class="lang-toggle-container lang-en">
                <div id="langToggleSlider" class="lang-toggle-slider"></div>
                <button id="lang-en" onclick="setLanguage('en')" class="lang-toggle-btn">EN</button>
                <button id="lang-id" onclick="setLanguage('id')" class="lang-toggle-btn">ID</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow p-4 sm:p-8 flex justify-center">
        <div class="w-full max-w-4xl bg-white shadow-xl rounded-xl p-6 sm:p-8">
            
            <h1 id="headerTitle" class="text-3xl font-extrabold text-primary-dark mb-3">Retirement Withdrawal Calculator</h1>
            <p id="toolSubtitle" class="text-base text-gray-700 font-medium mb-6 leading-relaxed text-justify">
               <!-- Konten Subtitle akan diisi oleh JS -->
            </p>
            
            <!-- Form Input -->
            <form id="withdrawalForm" onsubmit="calculateWithdrawal(event)" class="space-y-6">
                
                <!-- Bagian 1: Dana & Penarikan -->
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="relative">
                            <label for="currentSavings" class="block text-sm font-medium text-gray-700 mb-1" id="labelCurrentSavings">Current Retirement Savings</label>
                            <input type="text" id="currentSavings" inputmode="numeric" value="1.000.000.000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-retirement-color focus:border-retirement-color" required>
                            <p class="input-description" id="descCurrentSavings">Total dana pensiun yang Anda miliki saat ini.</p>
                        </div>
                        <div class="relative">
                            <label for="monthlyWithdrawal" class="block text-sm font-medium text-gray-700 mb-1" id="labelMonthlyWithdrawal">Monthly Withdrawal Amount</label>
                            <input type="text" id="monthlyWithdrawal" inputmode="numeric" value="8.000.000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-retirement-color focus:border-retirement-color" required>
                            <p class="input-description" id="descMonthlyWithdrawal">Jumlah uang yang ingin Anda tarik setiap bulan untuk biaya hidup.</p>
                        </div>
                    </div>
                </div>

                <!-- Bagian 2: Asumsi Pertumbuhan -->
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="relative">
                            <label for="annualReturn" class="block text-sm font-medium text-gray-700 mb-1" id="labelAnnualReturn">Annual Investment Return (%)</label>
                            <input type="number" id="annualReturn" min="0" step="0.1" value="6" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-retirement-color focus:border-retirement-color" required>
                            <p class="input-description" id="descAnnualReturn">Estimasi keuntungan investasi tahunan (neto).</p>
                        </div>
                        <div class="relative">
                            <label for="inflationRate" class="block text-sm font-medium text-gray-700 mb-1" id="labelInflationRate">Annual Inflation Rate (%)</label>
                            <input type="number" id="inflationRate" min="0" step="0.1" value="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-retirement-color focus:border-retirement-color" required>
                            <p class="input-description" id="descInflationRate">Estimasi kenaikan biaya hidup tahunan (penarikan akan naik sesuai inflasi).</p>
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full text-white font-semibold py-3 rounded-xl hover:bg-orange-700 transition duration-300 ease-in-out transform focus:outline-none focus:ring-4 focus:ring-orange-500 focus:ring-opacity-50">
                    Calculate Duration
                </button>
                
                <!-- Error Alert -->
                <div id="errorAlert" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                    <span id="errorText" class="block sm:inline"></span>
                </div>
            </form>

            <!-- Result Box -->
            <div id="resultBox" class="result-box mt-8 p-6 rounded-xl shadow-lg result-card-main">
                
                <h3 id="resultHeader" class="text-2xl font-bold mb-6 text-primary border-b pb-2 border-orange-300">Calculation Results</h3>
                
                <!-- Hasil Utama -->
                <div class="text-center mb-8">
                    <p id="labelDuration" class="text-lg font-bold text-gray-700 mb-1">Your Savings Will Last For</p>
                    <p id="resultDuration" class="text-4xl font-extrabold text-retirement-color">0 Years 0 Months</p>
                    <p id="resultUntilAge" class="text-sm text-gray-600 mt-2 italic hidden">Until you are approximately <span id="valAge" class="font-bold"></span> years old.</p>
                </div>

                <!-- Interpretasi Hasil -->
                <div class="mb-8 bg-white p-4 rounded-lg border border-orange-200">
                    <h4 id="headerInterpretation" class="text-md font-bold text-primary mb-2">Analysis</h4>
                    <p id="textInterpretation" class="text-sm text-gray-700 leading-relaxed">
                        <!-- Teks interpretasi dinamis akan muncul di sini -->
                    </p>
                </div>

                <!-- Metrics -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-center">
                    <div class="bg-white p-3 rounded shadow-sm">
                        <p class="text-xs text-gray-500 uppercase tracking-wide" id="labelTotalWithdrawn">Total Withdrawn</p>
                        <p class="text-xl font-bold text-primary" id="valTotalWithdrawn">0</p>
                    </div>
                    <div class="bg-white p-3 rounded shadow-sm">
                        <p class="text-xs text-gray-500 uppercase tracking-wide" id="labelFinalMonthly">Final Monthly Withdrawal</p>
                        <p class="text-xl font-bold text-primary" id="valFinalMonthly">0</p>
                        <p class="text-[10px] text-gray-400" id="labelInflationAdjusted">(Inflation Adjusted)</p>
                    </div>
                </div>

            </div>
            
            <!-- Konten Edukasi -->
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Understanding Safe Withdrawal Rates</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>

                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">Inflation: The Silent Killer</h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>

                <h3 id="sectionHeader3" class="text-lg font-bold text-gray-800 mb-2">Wealth Management Tips</h3>
                <!-- Perbaikan di sini: Memisahkan paragraf pengantar dari list -->
                <p id="content3" class="text-gray-600 text-sm leading-relaxed text-justify mb-2"></p> 
                
                <!-- List hanya berisi tips -->
                <ul class="text-gray-600 text-sm leading-relaxed text-justify mb-6 list-disc ml-6 space-y-1">
                    <li id="tip1"></li>
                    <li id="tip2"></li>
                    <li id="tip3"></li>
                </ul>

                <h3 id="sectionHeader4" class="text-lg font-bold text-gray-800 mb-2">Disclaimer</h3>
                <p id="content4" class="text-gray-600 text-sm leading-relaxed text-justify mb-6"></p>
            </section>

        </div>
    </main>
    
    <!-- Footer -->
    <footer class="mt-12 py-6 border-t border-gray-200 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div id="footerLinks" class="flex flex-wrap justify-center space-x-4 sm:space-x-8 text-sm font-medium text-gray-600">
                <a href="../privacy-policy.html" id="linkPrivacy" class="hover:text-secondary transition duration-150 ease-in-out">Privacy Policy</a>
                <span aria-hidden="true" class="hidden sm:inline">|</span>
                <a href="../terms-of-service.html" id="linkTerms" class="hover:text-secondary transition duration-150 ease-in-out">Terms of Service</a>
                <span aria-hidden="true" class="hidden sm:inline">|</span>
                <a href="../about-us.html" id="linkAbout" class="hover:text-secondary transition duration-150 ease-in-out">About Us</a>
                <span aria-hidden="true" class="hidden sm:inline">|</span>
                <a href="../contact-us.html" id="linkContact" class="hover:text-secondary transition duration-150 ease-in-out">Contact Us</a>
            </div>
            <div class="mt-6 text-center text-xs text-gray-500">
                <span id="footerCopyright">&copy; 2025 Digital Tools ID. All rights reserved. Developed by DTID Analytics.</span>
            </div>
        </div>
    </footer>
    
    <script>
        // **********************************************
        // LOGIKA KALKULATOR PENARIKAN DANA PENSIUN
        // **********************************************

        const translations = {
            id: {
                appTitle: "Kalkulator Penarikan Pensiun",
                headerTitle: "Kalkulator Penarikan Dana Pensiun",
                toolSubtitle: "Alat ini dirancang untuk Anda yang sedang merencanakan masa pensiun atau sudah pensiun. Pertanyaan terbesar saat pensiun adalah: <b>'Berapa lama uang saya akan bertahan?'</b>. Kalkulator ini membantu Anda mensimulasikan umur simpanan Anda dengan mempertimbangkan penarikan bulanan untuk biaya hidup, pertumbuhan investasi, dan gerusan inflasi.",
                backToCatalogText: "Kembali ke Katalog Alat",
                // Input
                labelCurrentSavings: "Dana Pensiun Saat Ini",
                descCurrentSavings: "Total aset likuid atau tabungan yang disiapkan untuk pensiun.",
                labelMonthlyWithdrawal: "Penarikan Bulanan Awal",
                descMonthlyWithdrawal: "Jumlah uang yang Anda butuhkan bulan ini untuk biaya hidup.",
                labelAnnualReturn: "Imbal Hasil Investasi Tahunan (%)",
                descAnnualReturn: "Rata-rata keuntungan investasi portofolio Anda per tahun.",
                labelInflationRate: "Tingkat Inflasi Tahunan (%)",
                descInflationRate: "Persentase kenaikan biaya hidup. Penarikan Anda akan dinaikkan setiap tahun sebesar angka ini untuk menjaga daya beli.",
                calculateButton: "Hitung Durasi Dana",
                inputError: "Mohon masukkan semua nilai input yang valid.",
                
                // Result Header
                resultHeader: "Hasil Perhitungan",
                labelDuration: "Dana Anda Akan Bertahan Selama",
                
                // Interpretation
                headerInterpretation: "Analisis Ketahanan Dana",
                // Dynamic strings for analysis
                interpSustainable: "<b>Dana Anda Sangat Berkelanjutan.</b> Tingkat penarikan Anda lebih rendah daripada pertumbuhan investasi (setelah disesuaikan inflasi). Secara teoritis, dana pokok Anda mungkin tidak akan pernah habis, atau akan bertahan sangat lama (> 50 tahun). Ini kondisi ideal untuk mewariskan kekayaan.",
                interpFinite: "<b>Dana Anda Terbatas.</b> Dengan pola pengeluaran saat ini, dana Anda diperkirakan habis dalam waktu <b>[YEARS] tahun [MONTHS] bulan</b>. Pastikan periode ini mencakup estimasi usia harapan hidup Anda. Jika tidak, pertimbangkan untuk mengurangi penarikan bulanan atau mencari instrumen investasi dengan imbal hasil lebih baik (namun hati-hati dengan risiko).",
                interpWarning: "<b>Peringatan: Dana Cepat Habis.</b> Tingkat penarikan Anda terlalu tinggi dibandingkan saldo dan pertumbuhan investasi. Dana diprediksi habis dalam waktu kurang dari 5 tahun. Segera evaluasi ulang anggaran pensiun Anda.",
                
                // Metrics
                labelTotalWithdrawn: "Total Dana Ditarik",
                labelFinalMonthly: "Penarikan Bulanan Terakhir",
                labelInflationAdjusted: "(Disesuaikan Inflasi)",
                
                // Edukasi
                sectionHeader1: "Memahami 'Safe Withdrawal Rate'",
                content1: "Salah satu aturan umum dalam perencanaan pensiun adalah <b>'The 4% Rule'</b>. Aturan ini menyarankan Anda menarik tidak lebih dari 4% dari total dana pensiun Anda di tahun pertama, lalu menyesuaikan nominal tersebut dengan inflasi di tahun-tahun berikutnya. Jika tingkat penarikan Anda jauh di atas 4%, risiko kehabisan uang di usia tua meningkat drastis.",
                sectionHeader2: "Inflasi: Musuh Tersembunyi",
                content2: "Jangan remehkan inflasi. Uang Rp 10 juta hari ini mungkin hanya setara dengan daya beli Rp 5 juta dalam 15-20 tahun ke depan. Kalkulator ini secara otomatis menaikkan jumlah penarikan Anda setiap tahun sebesar tingkat inflasi yang Anda masukkan, sehingga gaya hidup Anda tidak turun meskipun harga barang naik.",
                sectionHeader3: "Tips Manajemen Kekayaan",
                content3: "Strategi agar dana bertahan lebih lama:",
                tip1: "<b>Turunkan Tingkat Penarikan:</b> Mengurangi gaya hidup sedikit saja bisa menambah umur dana pensiun bertahun-tahun. Pertimbangkan untuk memotong pengeluaran yang tidak esensial.",
                tip2: "<b>Diversifikasi Aset:</b> Pastikan portofolio investasi Anda terdiversifikasi. Portofolio yang terlalu konservatif (hanya uang tunai/deposito) mungkin kalah oleh inflasi, sedangkan portofolio yang terlalu agresif (saham berisiko tinggi) berisiko kehilangan modal saat pasar turun.",
                tip3: "<b>Penghasilan Tambahan:</b> Memiliki penghasilan kecil dari hobi, kerja paruh waktu, atau konsultasi di masa pensiun dapat secara drastis mengurangi beban penarikan dana pokok Anda, memberikan 'napas' tambahan bagi aset Anda untuk tumbuh.",
                sectionHeader4: "Disclaimer",
                content4: "Kalkulator ini adalah alat simulasi matematis dengan asumsi imbal hasil investasi dan inflasi yang konstan. Pasar nyata berfluktuasi (sequence of returns risk). Hasil ini bukan saran investasi profesional. Selalu konsultasikan dengan perencana keuangan untuk strategi pensiun yang komprehensif.",

                // Footer
                linkPrivacy: "Kebijakan Privasi",
                linkTerms: "Ketentuan Layanan",
                linkAbout: "Tentang Kami",
                linkContact: "Hubungi Kami",
                footerCopyright: "&copy; 2025 Digital Tools ID. Semua hak dilindungi. Dikembangkan oleh DTID Analytics."
            },
            en: {
                appTitle: "Retirement Withdrawal Calculator",
                headerTitle: "Retirement Withdrawal Calculator",
                toolSubtitle: "This tool is designed for those planning for or currently in retirement. The biggest question is: <b>'How long will my money last?'</b>. This calculator helps simulate the lifespan of your savings by factoring in monthly withdrawals for living expenses, investment growth, and the eroding effect of inflation.",
                backToCatalogText: "Back to Tools Catalog",
                // Input
                labelCurrentSavings: "Current Retirement Savings",
                descCurrentSavings: "Total liquid assets or savings set aside for retirement.",
                labelMonthlyWithdrawal: "Initial Monthly Withdrawal",
                descMonthlyWithdrawal: "The amount you need this month for living expenses.",
                labelAnnualReturn: "Annual Investment Return (%)",
                descAnnualReturn: "Average annual net return on your investment portfolio.",
                labelInflationRate: "Annual Inflation Rate (%)",
                descInflationRate: "Percentage increase in cost of living. Your withdrawals will increase annually by this rate to maintain purchasing power.",
                calculateButton: "Calculate Duration",
                inputError: "Please enter all valid input values.",
                
                // Result Header
                resultHeader: "Calculation Results",
                labelDuration: "Your Savings Will Last For",
                
                // Interpretation
                headerInterpretation: "Sustainability Analysis",
                interpSustainable: "<b>Your Fund is Highly Sustainable.</b> Your withdrawal rate is lower than your investment growth (inflation-adjusted). Theoretically, your principal may never run out, or will last a very long time (> 50 years). This is ideal for legacy planning.",
                interpFinite: "<b>Your Fund is Finite.</b> At current spending levels, your savings are projected to run out in <b>[YEARS] years [MONTHS] months</b>. Ensure this period covers your life expectancy. If not, consider reducing monthly withdrawals or seeking better investment returns (mind the risk).",
                interpWarning: "<b>Warning: Rapid Depletion.</b> Your withdrawal rate is too high compared to your balance and growth. Funds are predicted to run out in less than 5 years. Re-evaluate your retirement budget immediately.",
                
                // Metrics
                labelTotalWithdrawn: "Total Amount Withdrawn",
                labelFinalMonthly: "Final Monthly Withdrawal",
                labelInflationAdjusted: "(Inflation Adjusted)",
                
                // Edukasi
                sectionHeader1: "Understanding Safe Withdrawal Rates",
                content1: "A common rule in retirement planning is <b>'The 4% Rule'</b>. It suggests withdrawing no more than 4% of your total portfolio in the first year, then adjusting that amount for inflation in subsequent years. If your withdrawal rate is significantly above 4%, the risk of outliving your money increases drastically.",
                sectionHeader2: "Inflation: The Silent Killer",
                content2: "Never underestimate inflation. $1,000 today might only have the purchasing power of $500 in 15-20 years. This calculator automatically increases your withdrawal amount annually by the inflation rate you input, ensuring your lifestyle doesn't degrade even as prices rise.",
                sectionHeader3: "Wealth Management Tips",
                content3: "Strategies to extend your fund's life:",
                tip1: "<b>Lower Withdrawals:</b> Reducing lifestyle costs slightly can extend your fund's life by years. Consider cutting non-essential expenses.",
                tip2: "<b>Asset Allocation:</b> Ensure a diversified portfolio. Being too conservative (cash only) might lose to inflation; being too aggressive risks capital loss during market downturns.",
                tip3: "<b>Part-time Work:</b> Having a small income from a hobby, part-time job, or consulting during retirement can drastically reduce the burden on your principal withdrawals, giving your assets more room to grow.",
                sectionHeader4: "Disclaimer",
                content4: "This calculator is a mathematical simulation assuming constant investment returns and inflation. Real markets fluctuate (sequence of returns risk). This result is not professional investment advice. Always consult a financial planner for a comprehensive retirement strategy.",

                // Footer
                linkPrivacy: "Privacy Policy",
                linkTerms: "Terms of Service",
                linkAbout: "About Us",
                linkContact: "Contact Us",
                footerCopyright: "&copy; 2025 Digital Tools ID. All rights reserved. Developed by DTID Analytics."
            }
        };

        let currentLang = 'en'; // Default language

        function formatNumber(amount, decimalPlaces = 0) {
            const locale = currentLang === 'id' ? 'id-ID' : 'en-US';
            return new Intl.NumberFormat(locale, {
                minimumFractionDigits: decimalPlaces,
                maximumFractionDigits: decimalPlaces,
            }).format(amount);
        }

        function formatInput(inputElement) {
            let rawValue = inputElement.value.replace(/\D/g, ''); 
            if (rawValue) {
                const numericValue = parseInt(rawValue, 10);
                inputElement.value = formatNumber(numericValue);
            } else {
                inputElement.value = ''; 
            }
        }
        
        function cleanInput(formattedValue) {
            return parseFloat(formattedValue.replace(/\D/g, '')) || 0;
        }

        function calculateWithdrawal(event) {
            event.preventDefault();

            // 1. Inputs
            const currentSavings = cleanInput(document.getElementById('currentSavings').value);
            const initialMonthlyWithdrawal = cleanInput(document.getElementById('monthlyWithdrawal').value);
            const annualReturn = parseFloat(document.getElementById('annualReturn').value) / 100;
            const annualInflation = parseFloat(document.getElementById('inflationRate').value) / 100;

            // 2. Validasi
            if (currentSavings <= 0 || initialMonthlyWithdrawal <= 0) {
                document.getElementById('errorAlert').classList.remove('hidden');
                document.getElementById('errorText').textContent = translations[currentLang].inputError;
                return;
            }
            document.getElementById('errorAlert').classList.add('hidden');

            // 3. Simulasi Bulan demi Bulan
            let balance = currentSavings;
            let monthlyWithdrawal = initialMonthlyWithdrawal;
            let monthsPassed = 0;
            let totalWithdrawn = 0;
            
            const monthlyReturnRate = Math.pow(1 + annualReturn, 1/12) - 1;
            // Inflasi biasanya disesuaikan tahunan, tapi untuk simulasi halus kita bisa pakai bulanan atau penyesuaian tahunan.
            // Di sini kita gunakan penyesuaian withdrawal setiap 12 bulan (tahunan) agar lebih realistis dengan pola pensiun.
            
            const maxMonths = 1200; // Cap at 100 years to prevent infinite loop
            let infinite = false;

            while (balance > 0 && monthsPassed < maxMonths) {
                // Tambahkan return investasi bulanan
                const investmentGain = balance * monthlyReturnRate;
                balance += investmentGain;
                
                // Kurangi penarikan
                // Cek apakah balance cukup
                if (balance < monthlyWithdrawal) {
                    totalWithdrawn += balance;
                    balance = 0;
                } else {
                    balance -= monthlyWithdrawal;
                    totalWithdrawn += monthlyWithdrawal;
                }
                
                monthsPassed++;

                // Setiap 12 bulan, sesuaikan penarikan dengan inflasi
                if (monthsPassed % 12 === 0) {
                    monthlyWithdrawal *= (1 + annualInflation);
                }
                
                // Cek jika saldo malah bertambah terus (Sustainable indefinitely)
                // Jika setelah 50 tahun saldo masih > 2x saldo awal, kita asumsikan infinite
                if (monthsPassed > 600 && balance > currentSavings * 2) {
                    infinite = true;
                    break;
                }
            }

            // 4. Format Hasil
            const years = Math.floor(monthsPassed / 12);
            const remainingMonths = monthsPassed % 12;
            
            const t = translations[currentLang];
            
            let durationText = "";
            let analysisText = "";
            let textColorClass = "text-retirement-color";

            if (infinite) {
                durationText = "> 50 Years"; // Atau "Forever"
                analysisText = t.interpSustainable;
                textColorClass = "text-finance-color"; // Hijau karena bagus
            } else {
                durationText = `${years} ${currentLang === 'id' ? 'Tahun' : 'Years'} ${remainingMonths} ${currentLang === 'id' ? 'Bulan' : 'Months'}`;
                
                if (years < 5) {
                    analysisText = t.interpWarning;
                    textColorClass = "text-red-600";
                } else {
                    analysisText = t.interpFinite
                        .replace('[YEARS]', years)
                        .replace('[MONTHS]', remainingMonths);
                }
            }

            // 5. Tampilkan ke DOM
            const resultDurationElem = document.getElementById('resultDuration');
            resultDurationElem.textContent = durationText;
            resultDurationElem.className = `text-4xl font-extrabold ${textColorClass}`;
            
            document.getElementById('textInterpretation').innerHTML = analysisText;
            document.getElementById('valTotalWithdrawn').textContent = formatNumber(Math.round(totalWithdrawn));
            document.getElementById('valFinalMonthly').textContent = formatNumber(Math.round(monthlyWithdrawal));

            document.getElementById('resultBox').classList.add('visible');
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            const switcher = document.getElementById('languageSwitcher');
            switcher.classList.remove('lang-en', 'lang-id');
            switcher.classList.add(`lang-${lang}`);

            // Get values
            const savingsVal = document.getElementById('currentSavings').value;
            const withdrawVal = document.getElementById('monthlyWithdrawal').value;

            // Update Text
            document.getElementById('appTitle').textContent = t.appTitle;
            document.getElementById('headerTitle').textContent = t.headerTitle;
            document.getElementById('toolSubtitle').innerHTML = t.toolSubtitle;
            document.getElementById('backToCatalogText').textContent = t.backToCatalogText;
            
            document.getElementById('labelCurrentSavings').textContent = t.labelCurrentSavings;
            document.getElementById('descCurrentSavings').textContent = t.descCurrentSavings;
            document.getElementById('labelMonthlyWithdrawal').textContent = t.labelMonthlyWithdrawal;
            document.getElementById('descMonthlyWithdrawal').textContent = t.descMonthlyWithdrawal;
            document.getElementById('labelAnnualReturn').textContent = t.labelAnnualReturn;
            document.getElementById('descAnnualReturn').textContent = t.descAnnualReturn;
            document.getElementById('labelInflationRate').textContent = t.labelInflationRate;
            document.getElementById('descInflationRate').textContent = t.descInflationRate;
            document.getElementById('calculateButton').textContent = t.calculateButton;
            
            // Re-format Inputs
            document.getElementById('currentSavings').value = formatNumber(cleanInput(savingsVal));
            document.getElementById('monthlyWithdrawal').value = formatNumber(cleanInput(withdrawVal));
            
            // Results
            document.getElementById('resultHeader').textContent = t.resultHeader;
            document.getElementById('labelDuration').textContent = t.labelDuration;
            document.getElementById('headerInterpretation').textContent = t.headerInterpretation;
            document.getElementById('labelTotalWithdrawn').textContent = t.labelTotalWithdrawn;
            document.getElementById('labelFinalMonthly').textContent = t.labelFinalMonthly;
            document.getElementById('labelInflationAdjusted').textContent = t.labelInflationAdjusted;
            
            // Edukasi
            document.getElementById('sectionHeader1').textContent = t.sectionHeader1;
            document.getElementById('content1').innerHTML = t.content1;
            document.getElementById('sectionHeader2').textContent = t.sectionHeader2;
            document.getElementById('content2').textContent = t.content2;
            document.getElementById('sectionHeader3').textContent = t.sectionHeader3;
            document.getElementById('content3').textContent = t.content3; // list header in separate P
            document.getElementById('tip1').innerHTML = t.tip1;
            document.getElementById('tip2').innerHTML = t.tip2;
            document.getElementById('tip3').innerHTML = t.tip3;
            document.getElementById('sectionHeader4').textContent = t.sectionHeader4;
            document.getElementById('content4').textContent = t.content4;
            
            // Footer
            document.getElementById('linkPrivacy').textContent = t.linkPrivacy;
            document.getElementById('linkTerms').textContent = t.linkTerms;
            document.getElementById('linkAbout').textContent = t.linkAbout;
            document.getElementById('linkContact').textContent = t.linkContact;
            document.getElementById('footerCopyright').innerHTML = t.footerCopyright;
            
            // Refresh Calc if visible
            if(document.getElementById('resultBox').classList.contains('visible')){
                calculateWithdrawal({preventDefault:()=>{}});
            }
        }

        document.getElementById('languageSwitcher').addEventListener('click', (event) => {
            if (event.target.tagName === 'BUTTON') {
                const newLang = event.target.id === 'lang-en' ? 'en' : 'id';
                if (newLang !== currentLang) setLanguage(newLang);
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            let defaultLang = 'en'; 
            const browserLang = (navigator.language || navigator.userLanguage).toLowerCase();
            if (browserLang.startsWith('id')) defaultLang = 'id';
            setLanguage(defaultLang); 
        });
    </script>
</body>
</html>