<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-npv-irr-bep/" />

    <meta name="description" content="Kalkulator Kelayakan Bisnis. Hitung BEP, NPV, dan IRR sekaligus. Dapatkan Laporan Manajemen yang mengungkap risiko dan potensi Nilai Masa Depan investasi Anda." />

    <title id="appTitle">Kalkulator Analisis Kelayakan Bisnis (BEP, NPV, IRR)</title>
    <link rel="alternate" hreflang="id" href="https://digitaltoolsid.github.io/kalkulator-npv-irr-bep/index.html" />
    <link rel="alternate" hreflang="en" href="https://digitaltoolsid.github.io/kalkulator-npv-irr-bep/index.html" />

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary': '#2c3e50', 
                        'secondary': '#3498db', 
                        'primary-dark': '#1e3a8a', 
                        'finance-color': '#27ae60', // Hijau Keuangan
                        'success-color': '#27ae60',
                        'danger-color': '#e74c3c',
                        'warning-color': '#f39c12',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Gaya Tambahan Minimal */
        
        /* Input khusus untuk Arus Kas */
        .cashflow-input {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .cashflow-input label {
            flex-shrink: 0;
            width: 4.5rem; 
            text-align: right;
            font-size: 0.875rem;
        }

        /* Animasi Hasil */
        .result-box { transition: all 0.5s ease-in-out; transform-origin: top center; opacity: 0; max-height: 0; overflow: hidden; }
        .result-box.visible { opacity: 1; max-height: 2500px; padding: 1.5rem; }

        /* Gaya Tombol Hitung */
        .calculate-button {
            box-shadow: 0 4px #1e8449;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px #1e8449;
        }
        .calculate-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #1e8449;
        }

        /* Referensi Artikel */
        .article-reference {
            padding: 1.5rem;
            background-color: #ecfdf5; 
            border: 1px solid #a7f3d0; 
            border-radius: 0.75rem;
            margin-top: 2rem;
            text-align: center;
        }
        .input-description { font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem; }
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen font-sans" oncontextmenu="return false;" oncopy="return false;" oncut="return false;">

    <header class="sticky top-0 z-50 bg-primary-dark text-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex justify-between items-center">
            
            <a href="../index.html" class="flex items-center text-gray-200 hover:text-white transition duration-150 group">
                <span class="mr-2 text-xl group-hover:-translate-x-1 transition-transform duration-200">&larr;</span>
                <span id="backToCatalogText" class="font-medium">Back to Tools Catalog</span>
            </a>
            
            <div id="languageSwitcher" class="relative flex bg-white rounded-full p-1 shadow-sm cursor-pointer select-none w-24 h-9">
                <div id="langToggleSlider" class="absolute top-1 left-1 bottom-1 w-[calc(50%-4px)] bg-primary-dark rounded-full transition-all duration-300 ease-in-out z-0"></div>
                
                <button id="lang-en" onclick="setLanguage('en')" class="relative z-10 w-1/2 text-center text-xs font-bold transition-colors duration-300 rounded-full focus:outline-none text-white">EN</button>
                <button id="lang-id" onclick="setLanguage('id')" class="relative z-10 w-1/2 text-center text-xs font-bold transition-colors duration-300 rounded-full focus:outline-none text-gray-700">ID</button>
            </div>

        </div>
    </header>

    <main class="flex-grow p-4 sm:p-8 flex justify-center">
        <div class="w-full max-w-lg bg-white shadow-xl rounded-xl p-6 sm:p-8 mt-4">
            
            <h1 id="headerTitle" class="text-3xl font-extrabold text-primary-dark mb-3">Kalkulator Analisis Kelayakan Bisnis</h1>
            <p id="toolSubtitle" class="text-base text-gray-700 font-medium mb-6">Hitung BEP, NPV, dan IRR secara simultan untuk mendapatkan <strong>Laporan Kesimpulan Manajemen</strong> (Executive Summary) yang jelas dan ringkas.</p>
            
            <form id="viabilityForm" onsubmit="calculateAllMetrics(event)" class="space-y-6">

                <div class="border-b pb-4 border-gray-200">
                    <h2 class="text-xl font-bold text-finance-color mb-3" id="sectionBepHeader">1. Data Operasional (BEP)</h2>
                    <div class="space-y-4">
                        <div class="relative">
                            <label for="fixedCosts" class="block text-sm font-medium text-gray-700 mb-1" id="labelFixedCosts">Total Biaya Tetap (Per Tahun)</label>
                            <input type="text" id="fixedCosts" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-secondary focus:border-secondary" placeholder="Contoh: 100.000.000" value="100000000">
                        </div>
                        <div class="relative">
                            <label for="variableCost" class="block text-sm font-medium text-gray-700 mb-1" id="labelVariableCost">Biaya Variabel (Per Unit)</label>
                            <input type="text" id="variableCost" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-secondary focus:border-secondary" placeholder="Contoh: 50.000" value="50000">
                        </div>
                        <div class="relative">
                            <label for="salePrice" class="block text-sm font-medium text-gray-700 mb-1" id="labelSalePrice">Harga Jual (Per Unit)</label>
                            <input type="text" id="salePrice" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-secondary focus:border-secondary" placeholder="Contoh: 150.000" value="150000">
                        </div>
                    </div>
                </div>

                <div class="border-b pb-4 border-gray-200">
                    <h2 class="text-xl font-bold text-finance-color mb-3" id="sectionNpvIrrHeader">2. Data Investasi & Proyeksi Arus Kas</h2>
                    
                    <div class="relative mb-4">
                        <label for="initialInvestment" class="block text-sm font-medium text-gray-700 mb-1" id="labelInitialInvestment">Investasi Awal (Tahun 0)</label>
                        <input type="text" id="initialInvestment" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-secondary focus:border-secondary" placeholder="Contoh: 500.000.000" value="500000000">
                    </div>

                    <div class="relative mb-4">
                        <label for="discountRate" class="block text-sm font-medium text-gray-700 mb-1" id="labelDiscountRate">Tingkat Diskonto (WACC) (% Per Tahun)</label>
                        <input type="number" id="discountRate" step="0.1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-secondary focus:border-secondary" placeholder="Contoh: 10" value="10">
                        <p class="input-description" id="descDiscountRate">Persentase tingkat pengembalian minimum yang Anda harapkan dari investasi. Ini adalah tolok ukur risiko (WACC).</p>
                    </div>

                    <div class="space-y-2">
                        <p class="block text-sm font-medium text-gray-700" id="labelCashFlows">Proyeksi Arus Kas Bersih (Per Tahun)</p>
                        <div class="cashflow-input">
                            <label for="cf1" id="labelCF1">Tahun 1</label>
                            <input type="text" id="cf1" inputmode="numeric" oninput="formatInput(this)" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="150.000.000" value="150000000">
                        </div>
                        <div class="cashflow-input">
                            <label for="cf2" id="labelCF2">Tahun 2</label>
                            <input type="text" id="cf2" inputmode="numeric" oninput="formatInput(this)" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="200.000.000" value="200000000">
                        </div>
                        <div class="cashflow-input">
                            <label for="cf3" id="labelCF3">Tahun 3</label>
                            <input type="text" id="cf3" inputmode="numeric" oninput="formatInput(this)" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="250.000.000" value="250000000">
                        </div>
                        <div class="cashflow-input">
                            <label for="cf4" id="labelCF4">Tahun 4</label>
                            <input type="text" id="cf4" inputmode="numeric" oninput="formatInput(this)" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="300.000.000" value="300000000">
                        </div>
                        <div class="cashflow-input">
                            <label for="cf5" id="labelCF5">Tahun 5</label>
                            <input type="text" id="cf5" inputmode="numeric" oninput="formatInput(this)" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="350.000.000" value="350000000">
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full bg-finance-color text-white font-semibold py-3 rounded-xl hover:bg-green-700 transition duration-300">
                    Hitung & Buat Laporan Manajemen
                </button>
            </form>

            <div id="errorAlert" class="hidden mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                <span id="errorText" class="block sm:inline"></span>
            </div>

            <div id="resultBox" class="result-box mt-6 bg-secondary/5 border border-secondary/30 rounded-xl shadow-lg">
                <h3 id="resultTitle" class="text-2xl font-bold text-finance-color mb-4 border-b pb-2">Laporan Kesimpulan Manajemen</h3>
                
                <div id="executiveSummary" class="p-4 rounded-lg mb-4">
                    <p class="text-lg font-bold mb-2" id="summaryTitle"></p>
                    <p id="summaryText" class="text-gray-700 text-sm"></p>
                </div>

                <h3 id="metricsHeader" class="text-xl font-bold text-primary mb-3 border-b pb-2">Metrik Kunci Kelayakan</h3>
                <div id="metricsContent" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    
                    <div class="p-3 rounded-lg border border-gray-200">
                        <p class="text-sm text-gray-600" id="resultNPV">Net Present Value (NPV)</p>
                        <p class="text-lg sm:text-2xl break-words font-bold mt-1" id="npvResult">--</p>
                    </div>
                    
                    <div class="p-3 rounded-lg border border-gray-200">
                        <p class="text-sm text-gray-600" id="resultIRR">Internal Rate of Return (IRR)</p>
                        <p class="text-lg sm:text-2xl break-words font-bold mt-1" id="irrResult">--</p>
                    </div>
                    
                    <div class="p-3 rounded-lg border border-gray-200">
                        <p class="text-sm text-gray-600" id="resultBEPUnits">BEP (Unit)</p>
                        <p class="text-lg sm:text-2xl break-words font-bold mt-1" id="bepUnitResult">--</p>
                    </div>
                    
                    <div class="p-3 rounded-lg border border-gray-200">
                        <p class="text-sm text-gray-600" id="resultBEPRevenue">BEP (Pendapatan)</p>
                        <p class="text-lg sm:text-2xl break-words font-bold mt-1" id="bepRevenueResult">--</p>
                    </div>
                </div>
            </div>
            
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Ringkasan Analisis Kelayakan</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2"></h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
                <h3 id="sectionHeader3" class="text-lg font-bold text-gray-800 mb-2"></h3>
                <p id="content3" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
                <h3 id="sectionHeader4" class="text-lg font-bold text-gray-800 mb-2"></h3>
                <p id="content4" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
            </section>

            <div class="article-reference">
                <p id="articleReferenceTitle" class="text-base font-semibold text-gray-800 mb-2">Perlu pemahaman lebih lanjut mengenai BEP, NPV, dan IRR?</p>
                <a href="../articles/analisis-titik-impas-bisnis.html" id="articleReferenceLink" class="text-finance-color hover:text-green-700 font-medium underline transition duration-150">Baca Artikel: Tiga Metrik Penting untuk Kelayakan Bisnis →</a>
            </div>

        </div>
    </main>
    
    <footer class="mt-12 py-6 border-t border-gray-200 bg-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div id="footerLinks" class="flex flex-wrap justify-center space-x-4 sm:space-x-8 text-sm font-medium text-gray-600">
                <a href="../privacy-policy.html" id="linkPrivacy" class="hover:text-secondary">Privacy Policy</a>
                <span class="hidden sm:inline">|</span>
                <a href="../terms-of-service.html" id="linkTerms" class="hover:text-secondary">Terms of Service</a>
                <span class="hidden sm:inline">|</span>
                <a href="../about-us.html" id="linkAbout" class="hover:text-secondary">About Us</a>
                <span class="hidden sm:inline">|</span>
                <a href="../contact-us.html" id="linkContact" class="hover:text-secondary">Contact Us</a>
            </div>
            <div class="mt-6 text-center text-xs text-gray-500">
                <span id="footerCopyright">&copy; 2025 Digital Tools ID. All rights reserved. Developed by DTID Analytics.</span>
            </div>
        </div>
    </footer>
    
    <script>
        // **********************************************
        // LOGIKA UTAMA (Sama seperti sebelumnya)
        // **********************************************

        const translations = {
            id: {
                appTitle: "Kalkulator Analisis Kelayakan Bisnis (BEP, NPV, IRR)",
                backToCatalogText: "Kembali ke Katalog Alat",
                headerTitle: "Kalkulator Analisis Kelayakan Bisnis",
                toolSubtitle: "Apakah rencana bisnis Anda layak? Hitung BEP, NPV, dan IRR secara simultan.",
                // LABELS INPUT
                sectionBepHeader: "1. Data Operasional (BEP)",
                labelFixedCosts: "Total Biaya Tetap (Per Tahun)",
                labelVariableCost: "Biaya Variabel (Per Unit)",
                labelSalePrice: "Harga Jual (Per Unit)",
                sectionNpvIrrHeader: "2. Data Investasi & Proyeksi Arus Kas",
                labelInitialInvestment: "Investasi Awal (Tahun 0)",
                labelDiscountRate: "Tingkat Diskonto (WACC) (% Per Tahun)",
                descDiscountRate: "Persentase tingkat pengembalian minimum yang Anda harapkan dari investasi. Ini adalah tolok ukur risiko (WACC).",
                labelCashFlows: "Proyeksi Arus Kas Bersih (Per Tahun)",
                labelCF1: "Tahun 1",
                labelCF2: "Tahun 2",
                labelCF3: "Tahun 3",
                labelCF4: "Tahun 4",
                labelCF5: "Tahun 5",
                calculateButton: "Hitung & Buat Laporan Manajemen",
                // HASIL
                resultTitle: "Laporan Kesimpulan Manajemen",
                metricsHeader: "Metrik Kunci Kelayakan",
                resultNPV: "Net Present Value (NPV)",
                resultIRR: "Internal Rate of Return (IRR)",
                resultBEPUnits: "BEP (Unit)",
                resultBEPRevenue: "BEP (Pendapatan)",
                // RINGKASAN
                summaryTitle_Accept: "Status Proyek: Direkomendasikan DITERIMA",
                summaryTitle_Reject: "Status Proyek: Direkomendasikan DITOLAK/TINJAU ULANG",
                summaryTitle_Warning: "Status Proyek: DITERIMA DENGAN PERINGATAN RISIKO OPERASIONAL",

                summaryNPV_Accept: (npv, irr) => `Proyek ini <strong>layak secara finansial</strong>. Tingkat pengembalian internal (IRR) sebesar <strong>${irr}%</strong> melebihi biaya modal. Secara nilai, proyek ini diperkirakan menambah nilai sebesar <strong>${npv}</strong> hari ini.`,
                summaryNPV_Reject: (npv, irr) => `Proyek ini <strong>tidak layak secara finansial</strong>. IRR proyek hanya <strong>${irr}%</strong>, di bawah biaya modal yang dibutuhkan. Diperkirakan proyek akan menghapus nilai sebesar <strong>${npv}</strong> hari ini.`,
                summaryBEP_LowRisk: (units, revenue) => `Dari sisi operasional, Titik Impas (BEP) berada di <strong>${units} unit</strong> atau <strong>${revenue}</strong>. Ini mengindikasikan <strong>margin keamanan yang baik</strong>, dan risiko operasional dianggap rendah.`,
                summaryBEP_HighRisk: (units, revenue) => `<strong>PERINGATAN RISIKO BEP TINGGI:</strong> Titik Impas (BEP) berada di <strong>${units} unit</strong> atau <strong>${revenue}</strong>. Angka ini mungkin <strong>terlalu tinggi</strong>, menuntut volume penjualan yang sulit dicapai.`,

                // ERRORS
                errorInput: "Harap masukkan semua nilai yang valid. Pastikan Harga Jual lebih tinggi dari Biaya Variabel, dan Arus Kas tidak semuanya negatif.",
                // KONTEN EDUKASI
                sectionHeader1: "Ringkasan Analisis Kelayakan",
                content1: "Menggunakan ketiga metrik ini secara bersamaan memberi Anda gambaran lengkap. BEP menilai keamanan operasional, sementara NPV dan IRR menilai profitabilitas jangka panjang.",
                sectionHeader2: "Memahami BEP (Break-Even Point)",
                content2: "BEP adalah metrik keamanan Anda. Ini menunjukkan volume penjualan minimum yang diperlukan untuk menutupi semua biaya. Menjual di atas BEP berarti untung.",
                sectionHeader3: "Memahami NPV (Net Present Value)",
                content3: "NPV adalah metrik nilai. Ia menghitung nilai hari ini dari semua keuntungan masa depan, dikurangi investasi awal Anda. Jika NPV positif, proyek tersebut 'Layak'.",
                sectionHeader4: "Memahami IRR (Internal Rate of Return)",
                content4: "IRR adalah metrik efisiensi. Ini adalah tingkat pengembalian (profit) tahunan yang dihasilkan oleh investasi Anda. Bandingkan dengan bunga bank atau biaya modal.",
                // FOOTER
                articleRefTitle: "Perlu pemahaman lebih lanjut?",
                articleRefLinkText: "Baca Artikel: Tiga Metrik Penting untuk Kelayakan Bisnis →",
                articleRefLinkPath: "../articles/analisis-titik-impas-bisnis.html",
                linkPrivacy: "Kebijakan Privasi",
                linkTerms: "Ketentuan Layanan",
                linkAbout: "Tentang Kami",
                linkContact: "Hubungi Kami",
                footerCopyright: "&copy; 2025 Digital Tools ID. Semua hak dilindungi. Dikembangkan oleh DTID Analytics."
            },
            en: {
                appTitle: "Business Viability Analyzer (BEP, NPV, IRR)",
                backToCatalogText: "Back to Tools Catalog",
                headerTitle: "Business Viability Analyzer",
                toolSubtitle: "Is your business plan viable? Calculate BEP, NPV, and IRR simultaneously.",
                sectionBepHeader: "1. Operational Data (BEP)",
                labelFixedCosts: "Total Fixed Costs (Per Year)",
                labelVariableCost: "Variable Cost (Per Unit)",
                labelSalePrice: "Sale Price (Per Unit)",
                sectionNpvIrrHeader: "2. Investment & Cash Flow Projection",
                labelInitialInvestment: "Initial Investment (Year 0)",
                labelDiscountRate: "Discount Rate (WACC) (% Per Year)",
                descDiscountRate: "The minimum rate of return you expect from the investment (WACC).",
                labelCashFlows: "Projected Net Cash Flows (Per Year)",
                labelCF1: "Year 1",
                labelCF2: "Year 2",
                labelCF3: "Year 3",
                labelCF4: "Year 4",
                labelCF5: "Year 5",
                calculateButton: "Calculate & Generate Management Report",
                resultTitle: "Executive Summary Report",
                metricsHeader: "Key Viability Metrics",
                resultNPV: "Net Present Value (NPV)",
                resultIRR: "Internal Rate of Return (IRR)",
                resultBEPUnits: "BEP (Units)",
                resultBEPRevenue: "BEP (Revenue)",
                summaryTitle_Accept: "Project Status: Recommended ACCEPT",
                summaryTitle_Reject: "Project Status: Recommended REJECT/REVIEW",
                summaryTitle_Warning: "Project Status: ACCEPT WITH OPERATIONAL RISK WARNING",
                summaryNPV_Accept: (npv, irr) => `The project is <strong>financially viable</strong>. The IRR of <strong>${irr}%</strong> exceeds the cost of capital. The project is expected to add <strong>${npv}</strong> in value today.`,
                summaryNPV_Reject: (npv, irr) => `The project is <strong>not financially viable</strong>. The IRR is only <strong>${irr}%</strong>, below the cost of capital. The project is expected to lose <strong>${npv}</strong> in value.`,
                summaryBEP_LowRisk: (units, revenue) => `From an operational standpoint, the BEP is at <strong>${units} units</strong> or <strong>${revenue}</strong>. This indicates a <strong>good safety margin</strong>.`,
                summaryBEP_HighRisk: (units, revenue) => `<strong>HIGH BEP RISK WARNING:</strong> The BEP is at <strong>${units} units</strong> or <strong>${revenue}</strong>. This figure may be <strong>too high</strong>.`,
                errorInput: "Please enter all valid values. Ensure Sale Price is higher than Variable Cost, and Cash Flows are not all negative.",
                sectionHeader1: "Viability Analysis Summary",
                content1: "Using these three metrics together gives you a complete picture. BEP assesses operational safety, while NPV and IRR assess long-term profitability.",
                sectionHeader2: "Understanding BEP",
                content2: "BEP is your safety metric. It shows the minimum sales volume needed to cover all costs.",
                sectionHeader3: "Understanding NPV",
                content3: "NPV is the value metric. It calculates the present-day value of all future profits minus your initial investment.",
                sectionHeader4: "Understanding IRR",
                content4: "IRR is the efficiency metric. It is the annual rate of return generated by your investment.",
                articleRefTitle: "Need a deeper understanding?",
                articleRefLinkText: "Read Article: Three Essential Metrics for Business Viability →",
                articleRefLinkPath: "../articles/analisis-titik-impas-bisnis.html",
                linkPrivacy: "Privacy Policy",
                linkTerms: "Terms of Service",
                linkAbout: "About Us",
                linkContact: "Contact Us",
                footerCopyright: "&copy; 2025 Digital Tools ID. All rights reserved. Developed by DTID Analytics."
            }
        };

        let currentLang = 'en'; 

        // Fungsi Format Angka
        function cleanInput(formattedValue) {
            if (typeof formattedValue !== 'string') return formattedValue;
            let cleaned = formattedValue.replace(/\D/g, '');
            return parseFloat(cleaned) || 0;
        }
        function formatNumber(num) {
            return num.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', { maximumFractionDigits: 0, minimumFractionDigits: 0 });
        }
        function formatDecimal(num) {
            return num.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', { maximumFractionDigits: 2, minimumFractionDigits: 2 });
        }
        function formatInput(inputElement) {
            let value = inputElement.value;
            let numericValue = value.replace(/[^0-9]/g, '');
            if (numericValue.length === 0) { inputElement.value = ''; return; }
            inputElement.value = formatNumber(parseInt(numericValue, 10));
        }

        // Fungsi Hitung NPV Helper
        function calculateNPV_for_IRR(rate, cfs) {
            let npv = cfs[0];
            for (let i = 1; i < cfs.length; i++) { npv += cfs[i] / Math.pow(1 + rate, i); }
            return npv;
        }

        // Fungsi Utama Hitung
        function calculateAllMetrics(event) {
            event.preventDefault();
            const t = translations[currentLang];
            const resultBox = document.getElementById('resultBox');
            const errorAlert = document.getElementById('errorAlert');

            const fixedCosts = cleanInput(document.getElementById('fixedCosts').value);
            const variableCost = cleanInput(document.getElementById('variableCost').value);
            const salePrice = cleanInput(document.getElementById('salePrice').value);
            const initialInvestment = cleanInput(document.getElementById('initialInvestment').value);
            const discountRate = parseFloat(document.getElementById('discountRate').value) / 100;
            const cashFlowsInputs = [
                cleanInput(document.getElementById('cf1').value), cleanInput(document.getElementById('cf2').value),
                cleanInput(document.getElementById('cf3').value), cleanInput(document.getElementById('cf4').value),
                cleanInput(document.getElementById('cf5').value)
            ];

            // Validasi
            const contributionMargin = salePrice - variableCost;
            if (fixedCosts <= 0 || variableCost < 0 || salePrice <= 0 || initialInvestment <= 0 || discountRate <= 0 || contributionMargin <= 0 || cashFlowsInputs.every(cf => cf <= 0)) {
                document.getElementById('errorText').textContent = t.errorInput;
                errorAlert.classList.remove('hidden');
                resultBox.classList.remove('visible');
                return;
            }
            errorAlert.classList.add('hidden');

            // Hitung BEP
            const bepUnits = fixedCosts / contributionMargin;
            const bepRevenue = bepUnits * salePrice;
            const minCashFlow = Math.min(...cashFlowsInputs.filter(cf => cf > 0)); 
            const isHighBEPRisk = bepUnits > ((minCashFlow / salePrice) * 2);

            // Hitung NPV
            let totalPV = 0;
            cashFlowsInputs.forEach((cf, index) => { totalPV += cf / Math.pow(1 + discountRate, index + 1); });
            const npv = totalPV - initialInvestment;

            // Hitung IRR
            const cfs_irr = [-initialInvestment, ...cashFlowsInputs];
            let irr = 0, low = 0, high = 1, iter = 0;
            if (calculateNPV_for_IRR(0, cfs_irr) * calculateNPV_for_IRR(1, cfs_irr) > 0) { irr = 0; } 
            else {
                while (iter < 100) {
                    let guess = (low + high) / 2;
                    let npv_val = calculateNPV_for_IRR(guess, cfs_irr);
                    if (Math.abs(npv_val) < 0.0001) { irr = guess; break; }
                    if (npv_val > 0) low = guess; else high = guess;
                    iter++;
                }
            }

            // Tampilkan Hasil
            const npvFormatted = formatNumber(npv);
            const irrFormatted = formatDecimal(irr * 100);
            const bepUnitFormatted = formatDecimal(bepUnits);
            const bepRevFormatted = formatNumber(bepRevenue);

            // Tentukan Pesan Summary
            let summaryTitleKey, summaryBgClass, summaryText;
            if (npv > 0 && irr > discountRate) {
                summaryTitleKey = 'summaryTitle_Accept';
                summaryBgClass = 'bg-success-color/10 border-success-color/30';
                summaryText = t.summaryNPV_Accept(npvFormatted, irrFormatted);
            } else {
                summaryTitleKey = 'summaryTitle_Reject';
                summaryBgClass = 'bg-danger-color/10 border-danger-color/30';
                summaryText = t.summaryNPV_Reject(npvFormatted, irrFormatted);
            }
            let bepSummaryText = isHighBEPRisk ? t.summaryBEP_HighRisk(bepUnitFormatted, bepRevFormatted) : t.summaryBEP_LowRisk(bepUnitFormatted, bepRevFormatted);
            if (isHighBEPRisk && summaryTitleKey === 'summaryTitle_Accept') {
                summaryTitleKey = 'summaryTitle_Warning';
                summaryBgClass = 'bg-warning-color/10 border-warning-color/30';
            }

            document.getElementById('summaryTitle').textContent = t[summaryTitleKey];
            document.getElementById('summaryText').innerHTML = summaryText + '<br><br><strong>Analisis Operasional (BEP):</strong> ' + bepSummaryText;
            document.getElementById('executiveSummary').className = `p-4 rounded-lg mb-4 border ${summaryBgClass}`;
            
            // Isi Metrik Angka
            const npvEl = document.getElementById('npvResult');
            const irrEl = document.getElementById('irrResult');
            npvEl.textContent = npvFormatted;
            npvEl.className = `text-lg sm:text-2xl break-words font-bold mt-1 ${npv > 0 ? 'text-success-color' : 'text-danger-color'}`;
            irrEl.textContent = irrFormatted + '%';
            irrEl.className = `text-lg sm:text-2xl break-words font-bold mt-1 ${irr > discountRate ? 'text-success-color' : 'text-danger-color'}`;
            document.getElementById('bepUnitResult').textContent = bepUnitFormatted;
            document.getElementById('bepRevenueResult').textContent = bepRevFormatted;

            resultBox.classList.add('visible');
        }

        // Fungsi Ganti Bahasa & Slider
        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            document.documentElement.lang = lang; 

            // LOGIKA SLIDER & WARNA TOMBOL
            const slider = document.getElementById('langToggleSlider');
            const btnEn = document.getElementById('lang-en');
            const btnId = document.getElementById('lang-id');

            if (lang === 'id') {
                // Geser Kanan (ID Aktif)
                slider.classList.add('translate-x-full'); 
                btnId.classList.replace('text-gray-700', 'text-white');
                btnEn.classList.replace('text-white', 'text-gray-700');
            } else {
                // Geser Kiri (EN Aktif)
                slider.classList.remove('translate-x-full');
                btnEn.classList.replace('text-gray-700', 'text-white');
                btnId.classList.replace('text-white', 'text-gray-700');
            }

            // Ganti Teks Halaman
            const elements = [
                'appTitle', 'backToCatalogText', 'headerTitle', 'toolSubtitle', 
                'sectionBepHeader', 'labelFixedCosts', 'labelVariableCost', 'labelSalePrice',
                'sectionNpvIrrHeader', 'labelInitialInvestment', 'labelDiscountRate', 
                'labelCashFlows', 'labelCF1', 'labelCF2', 'labelCF3', 'labelCF4', 'labelCF5', 
                'calculateButton', 'resultTitle', 'metricsHeader', 'resultNPV', 'resultIRR', 
                'resultBEPUnits', 'resultBEPRevenue', 'sectionHeader1', 'content1', 
                'sectionHeader2', 'content2', 'sectionHeader3', 'content3', 
                'sectionHeader4', 'content4', 'linkPrivacy', 'linkTerms', 'linkAbout', 
                'linkContact', 'footerCopyright', 'articleReferenceTitle'
            ];
            elements.forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                    if(['content1','content2','content3','content4','toolSubtitle','footerCopyright'].includes(id)) el.innerHTML = t[id];
                    else el.textContent = t[id];
                }
            });

            // Update Link Artikel & Deskripsi
            document.getElementById('articleReferenceLink').textContent = t.articleRefLinkText;
            document.getElementById('articleReferenceLink').href = t.articleRefLinkPath;
            document.getElementById('descDiscountRate').textContent = t.descDiscountRate;
            
            // Sembunyikan Hasil saat ganti bahasa
            document.getElementById('resultBox').classList.remove('visible');
            document.getElementById('errorAlert').classList.add('hidden');
        }

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', () => {
            ['fixedCosts', 'variableCost', 'salePrice', 'initialInvestment', 'cf1', 'cf2', 'cf3', 'cf4', 'cf5'].forEach(id => {
                const el = document.getElementById(id);
                if(el.value) el.value = formatNumber(cleanInput(el.value));
            });
            const browserLang = (navigator.language || navigator.userLanguage).toLowerCase();
            setLanguage(browserLang.startsWith('id') ? 'id' : 'en');
        });
    </script>
</body>
</html>