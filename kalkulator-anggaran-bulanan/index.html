<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">

    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-anggaran-bulanan/" />
    <meta name="description" content="Kalkulator Anggaran Bulanan Cepat dan Akurat. Gunakan metode 50/30/20 untuk membagi pendapatan Anda ke dalam Kebutuhan, Keinginan, dan Tabungan/Investasi.">
    
    <title id="appTitle">Kalkulator Anggaran Bulanan (Metode 50/30/20)</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>

    <style>
        /* CSS LOKAL (Hanya untuk halaman ini) */
        
        /* --- PERBAIKAN WARNA GRAFIK (PATCH LOKAL) --- */
        /* Definisi warna manual agar grafik muncul tanpa rebuild CSS */
        .bg-needs-color { background-color: #3498db; } /* Biru */
        .bg-wants-color { background-color: #f39c12; } /* Kuning/Orange */
        .bg-savings-color { background-color: #27ae60; } /* Hijau */

        /* Transisi Slide Down untuk Hasil */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 2000px; 
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        /* Progress Bar Animation */
        .bar-segment {
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex justify-center">
        <div class="w-full max-w-lg bg-white shadow-xl rounded-xl p-6 sm:p-8">

            <h1 id="headerTitle" class="text-3xl font-extrabold text-gray-900 mb-3">Kalkulator Anggaran Bulanan</h1>
            
            <p id="toolSubtitle" class="text-base text-gray-700 font-medium mb-6">
                Kelola uang Anda secara efektif menggunakan metode <strong>50/30/20</strong> yang teruji: 50% untuk Kebutuhan, 30% untuk Keinginan, dan 20% untuk Tabungan/Investasi.
            </p>

            <form id="budgetForm" onsubmit="calculateBudget(event)" class="space-y-6">

                <div class="border-b pb-4 border-gray-200">
                    <h2 class="text-xl font-bold dynamic-text mb-3" id="sectionIncomeHeader">1. Pendapatan Bersih Bulanan</h2>
                    <div class="space-y-4">
                        <div class="relative">
                            <label for="monthlyIncome" class="block text-sm font-medium text-gray-700 mb-1" id="labelMonthlyIncome">Total Pendapatan Bersih (Setelah Pajak)</label>
                            <input type="text" id="monthlyIncome" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150" placeholder="Contoh: 10.000.000" required>
                            <p class="text-xs text-gray-500 mt-1" id="descMonthlyIncome">Pendapatan yang masuk ke rekening Anda setiap bulan.</p>
                        </div>
                    </div>
                </div>

                <div class="pb-4">
                    <h2 class="text-xl font-bold dynamic-text mb-3" id="sectionSpendingHeader">2. Pengeluaran yang Dianggarkan</h2>
                    <div class="space-y-4">
                        
                        <div class="relative">
                            <label for="needsSpending" class="block text-sm font-medium text-gray-700 mb-1" id="labelNeedsSpending">Anggaran Kebutuhan (Needs)</label>
                            <input type="text" id="needsSpending" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150" placeholder="Contoh: 4.500.000">
                            <p class="text-xs text-gray-500 mt-1" id="descNeedsSpending">Pengeluaran wajib: Sewa, cicilan, makan, listrik.</p>
                        </div>

                        <div class="relative">
                            <label for="wantsSpending" class="block text-sm font-medium text-gray-700 mb-1" id="labelWantsSpending">Anggaran Keinginan (Wants)</label>
                            <input type="text" id="wantsSpending" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 transition duration-150" placeholder="Contoh: 3.000.000">
                            <p class="text-xs text-gray-500 mt-1" id="descWantsSpending">Hiburan, jajan, hobi, belanja impulsif.</p>
                        </div>

                        <div class="relative">
                            <label for="savingsInvestment" class="block text-sm font-medium text-gray-700 mb-1" id="labelSavingsInvestment">Anggaran Tabungan & Investasi</label>
                            <input type="text" id="savingsInvestment" inputmode="numeric" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150" placeholder="Contoh: 2.000.000">
                            <p class="text-xs text-gray-500 mt-1" id="descSavingsInvestment">Dana darurat, pensiun, investasi, pelunasan utang.</p>
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="w-full bg-green-600 text-white font-semibold py-3 rounded-xl shadow-md hover:bg-green-700 transition duration-300 ease-in-out transform hover:scale-[1.01]">
                    Analisis Anggaran 50/30/20
                </button>
            </form>

            <div id="errorAlert" class="hidden mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                <span id="errorText" class="block sm:inline"></span>
            </div>

            <div id="resultBox" class="result-box bg-white border border-gray-200 rounded-xl shadow-lg">

                <h3 id="resultTitle" class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Hasil Analisis Anggaran</h3>

                <div class="mb-6">
                    <p class="text-sm font-medium text-gray-700 mb-2" id="visualHeader">Distribusi Anggaran vs. Pendapatan</p>
                    <div class="h-4 rounded-full flex overflow-hidden bg-gray-200 w-full">
                        <div id="barNeeds" class="bar-segment bg-needs-color h-full" style="width: 0%;"></div>
                        <div id="barWants" class="bar-segment bg-wants-color h-full" style="width: 0%;"></div>
                        <div id="barSavings" class="bar-segment bg-savings-color h-full" style="width: 0%;"></div>
                        <div id="barRemaining" class="bar-segment bg-gray-300 h-full" style="width: 0%;"></div>
                    </div>
                    <div class="text-center mt-2 text-sm font-medium text-gray-600" id="barLegend"></div>
                </div>

                <div id="resultSummaryText" class="p-4 rounded-lg mb-4 border transition-colors duration-300">
                    <p class="text-lg font-bold mb-2" id="summaryTitle"></p>
                    <p id="summaryText" class="text-gray-700 text-sm"></p>
                </div>

                <h3 id="metricsHeader" class="text-xl font-bold text-gray-800 mb-3 border-b pb-2">Detail Pembagian Anggaran</h3>
                <div id="metricsContent" class="space-y-3">
                    
                    <div class="flex justify-between items-center p-3 rounded-lg border border-blue-200 bg-blue-50">
                        <p class="text-sm font-bold text-blue-700" id="resultNeeds">Kebutuhan (50%)</p>
                        <p class="text-lg font-bold text-gray-800" id="needsResult">--</p>
                    </div>
                    
                    <div class="flex justify-between items-center p-3 rounded-lg border border-yellow-200 bg-yellow-50">
                        <p class="text-sm font-bold text-yellow-700" id="resultWants">Keinginan (30%)</p>
                        <p class="text-lg font-bold text-gray-800" id="wantsResult">--</p>
                    </div>
                    
                    <div class="flex justify-between items-center p-3 rounded-lg border border-green-200 bg-green-50">
                        <p class="text-sm font-bold text-green-700" id="resultSavings">Tabungan & Investasi (20%)</p>
                        <p class="text-lg font-bold text-gray-800" id="savingsResult">--</p>
                    </div>

                    <div class="flex justify-between items-center p-3 rounded-lg border border-gray-300 bg-gray-100 mt-4">
                        <p class="text-base font-semibold text-gray-700" id="resultRemaining">Sisa/Defisit Dana</p>
                        <p class="text-xl font-extrabold" id="remainingResult">--</p>
                    </div>
                </div>
            </div>

            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Apa itu Metode 50/30/20?</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>

                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">Pentingnya Kepatuhan (Compliance)</h3>
                <p id="content2" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
            </section>
        </div>
    </main>

    <section id="related-tools-section" class="max-w-4xl mx-auto px-4 py-8 mb-4">
        <div class="flex items-center mb-5">
            <div class="w-1 h-7 mr-3 dynamic-bg"></div> 
            <h2 class="text-xl font-bold text-gray-800" 
                data-en="Financial Planning Tools" 
                data-id="Alat Perencanaan Keuangan">
                Financial Planning Tools
            </h2>
        </div>
    
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
            
            <a href="../kalkulator-dana-darurat/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 dynamic-border">
                <h3 class="text-base font-bold mb-1 dynamic-text dynamic-hover-text"
                    data-en="Emergency Fund Calculator"
                    data-id="Kalkulator Dana Darurat">
                    Emergency Fund Calculator
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Calculate how much you need to save for unexpected events."
                    data-id="Hitung berapa banyak yang perlu Anda tabung untuk kejadian tak terduga.">
                    Calculate how much you need to save for unexpected events.
                </p>
            </a>
    
            <a href="../kalkulator-kpr/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 dynamic-border">
                <h3 class="text-base font-bold mb-1 dynamic-text dynamic-hover-text"
                    data-en="Mortgage Simulator (KPR)"
                    data-id="Simulasi KPR & Bunga">
                    Mortgage Simulator (KPR)
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Estimate monthly mortgage payments and interest."
                    data-id="Estimasi cicilan KPR bulanan dan total bunga.">
                    Estimate monthly mortgage payments and interest.
                </p>
            </a>
    
            <a href="../kalkulator-networth/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 dynamic-border">
                <h3 class="text-base font-bold mb-1 dynamic-text dynamic-hover-text"
                    data-en="Net Worth Calculator"
                    data-id="Kalkulator Kekayaan Bersih">
                    Net Worth Calculator
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Track your total assets minus liabilities."
                    data-id="Lacak total aset dikurangi kewajiban hutang Anda.">
                    Track your total assets minus liabilities.
                </p>
            </a>
        </div>
    
        <div class="border-t border-gray-100 pt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4" data-en="Related Articles:" data-id="Artikel Terkait:">Related Articles:</h3>
            <ul class="space-y-3">
                <li>
                    <a href="../articles/strategi-mempercepat-pelunasan-utang.html" class="flex items-center text-sm hover:underline group dynamic-text">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 dynamic-bg-group"></span>
                        <span data-en="Debt Repayment Strategies: Snowball vs Avalanche" 
                              data-id="Strategi Pelunasan Utang: Snowball vs Avalanche">
                            Debt Repayment Strategies: Snowball vs Avalanche
                        </span>
                    </a>
                </li>
                <li>
                    <a href="../articles/klausul-perpajakan-kontrak.html" class="flex items-center text-sm hover:underline group dynamic-text">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 dynamic-bg-group"></span>
                        <span data-en="Understanding Tax Clauses in Contracts" 
                              data-id="Memahami Klausul Perpajakan dalam Kontrak">
                            Understanding Tax Clauses in Contracts
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </section>

    <div id="global-footer-container"></div>

    <script>
        // Set kategori ke 'finance' agar Header & Elemen Dinamis menjadi HIJAU
        window.headerCategory = 'finance';
    </script>
    
    <script src="../components.js"></script>

    <script>
        // **********************************************
        // LOGIKA KALKULATOR (JS LOKAL)
        // **********************************************

        const NEEDS_PERCENT = 0.50;
        const WANTS_PERCENT = 0.30;
        const SAVINGS_PERCENT = 0.20;

        const translations = {
            id: {
                appTitle: "Kalkulator Anggaran Bulanan (Metode 50/30/20)",
                backToCatalogText: "Kembali ke Katalog Alat",
                headerTitle: "Kalkulator Anggaran Bulanan",
                toolSubtitle: "Kelola uang Anda secara efektif menggunakan metode <strong>50/30/20</strong> yang teruji: 50% untuk Kebutuhan, 30% untuk Keinginan, dan 20% untuk Tabungan/Investasi.",
                
                sectionIncomeHeader: "1. Pendapatan Bersih Bulanan",
                labelMonthlyIncome: "Total Pendapatan Bersih (Setelah Pajak)",
                descMonthlyIncome: "Pendapatan yang masuk ke rekening Anda setiap bulan.",
                sectionSpendingHeader: "2. Pengeluaran yang Dianggarkan",
                labelNeedsSpending: "Anggaran Kebutuhan (Needs)",
                descNeedsSpending: "Pengeluaran wajib bulanan: Sewa, cicilan, bahan makanan, transportasi dasar, utilitas, dan asuransi dasar.",
                labelWantsSpending: "Anggaran Keinginan (Wants)",
                descWantsSpending: "Pengeluaran tidak wajib: Hiburan, makan di luar, gadget baru, layanan streaming, hobi, pakaian mahal.",
                labelSavingsInvestment: "Anggaran Tabungan & Investasi",
                descSavingsInvestment: "Dana darurat, dana pensiun, investasi saham/reksa dana, atau melunasi utang (selain cicilan wajib).",
                calculateButton: "Analisis Anggaran 50/30/20",
                
                resultTitle: "Hasil Analisis Anggaran",
                visualHeader: "Distribusi Anggaran vs. Pendapatan",
                metricsHeader: "Detail Pembagian Anggaran",
                resultNeeds: `Kebutuhan (Target ${NEEDS_PERCENT*100}%)`,
                resultWants: `Keinginan (Target ${WANTS_PERCENT*100}%)`,
                resultSavings: `Tabungan & Investasi (Target ${SAVINGS_PERCENT*100}%)`,
                resultRemaining: "Sisa/Defisit Dana",
                
                summaryTitle_Good: "Status: Anggaran Sehat dan Efisien",
                summaryTitle_Warning: "Status: Perlu Penyesuaian Kategori",
                summaryTitle_Danger: "Status: Anggaran Berisiko Defisit",

                summaryText_Good: (surplus, needsP, wantsP, savingsP) => `Anggaran Anda sangat baik. Semua kategori (Kebutuhan: ${needsP}%, Keinginan: ${wantsP}%, Tabungan: ${savingsP}%) mendekati pedoman 50/30/20 dan Anda memiliki surplus ${surplus}. Pertahankan manajemen ini!`,
                summaryText_Warning: (needsP, wantsP) => `Terdapat penyimpangan signifikan dari pedoman 50/30/20. Kebutuhan (${needsP}%) dan/atau Keinginan (${wantsP}%) Anda melebihi batas ideal. Prioritaskan mengurangi pengeluaran Keinginan untuk meningkatkan alokasi Tabungan.`,
                summaryText_Danger: (deficit, totalP) => `Peringatan: Total pengeluaran (${totalP}%) melebihi pendapatan. Anda mengalami defisit bulanan sebesar ${deficit}. Lakukan peninjauan total dan segera kurangi pengeluaran Keinginan dan Kebutuhan yang tidak penting.`,

                errorInput: "Harap masukkan semua nilai yang valid dan pastikan Pendapatan Bersih > 0.",
                
                sectionHeader1: "Apa itu Metode 50/30/20?",
                content1: "Metode 50/30/20 adalah aturan mudah dalam penganggaran yang dipopulerkan oleh Senator AS Elizabeth Warren. Tujuannya adalah memastikan alokasi dana yang seimbang, di mana tidak ada kategori yang melebihi batas yang disarankan, sehingga Anda dapat menabung untuk masa depan tanpa merasa terlalu terkekang.",
                sectionHeader2: "Pentingnya Kepatuhan (Compliance)",
                content2: "Kepatuhan terhadap persentase ini adalah kunci. Jika pengeluaran Kebutuhan Anda melebihi 50%, ini bisa menjadi tanda bahwa biaya hidup Anda terlalu tinggi dibandingkan pendapatan, dan perlu peninjauan ulang (misalnya, mencari tempat tinggal yang lebih murah). Anggaran Keinginan yang melebihi 30% berarti Anda memprioritaskan kesenangan instan di atas keamanan finansial masa depan.",
                
                footerPrivacy: "Kebijakan Privasi",
                footerTerms: "Syarat Ketentuan",
                footerAbout: "Tentang Kami",
                footerContact: "Hubungi Kami",
                footerDev: "Dikembangkan oleh DTID Analytics.",
            },
            en: {
                appTitle: "Monthly Budget Calculator (50/30/20 Method)",
                backToCatalogText: "Back to Tools Catalog",
                headerTitle: "Monthly Budget Calculator",
                toolSubtitle: "Effectively manage your money using the proven <strong>50/30/20</strong> method: 50% for Needs, 30% for Wants, and 20% for Savings/Investment.",
                
                sectionIncomeHeader: "1. Net Monthly Income",
                labelMonthlyIncome: "Total Net Income (After Tax)",
                descMonthlyIncome: "The income that hits your bank account every month.",
                sectionSpendingHeader: "2. Budgeted Expenses",
                labelNeedsSpending: "Needs Budget",
                descNeedsSpending: "Mandatory monthly expenses: Rent, loan payments, groceries, basic transport, utilities, and basic insurance.",
                labelWantsSpending: "Wants Budget",
                descWantsSpending: "Non-essential expenses: Entertainment, dining out, new gadgets, streaming services, hobbies, expensive clothing.",
                labelSavingsInvestment: "Savings & Investment Budget",
                descSavingsInvestment: "Emergency fund, retirement fund, stock/mutual fund investments, or paying off debt (other than mandatory installments).",
                calculateButton: "Analyze 50/30/20 Budget",
                
                resultTitle: "Budget Analysis Result",
                visualHeader: "Budget Distribution vs. Income",
                metricsHeader: "Budget Allocation Details",
                resultNeeds: `Needs (Target ${NEEDS_PERCENT*100}%)`,
                resultWants: `Wants (Target ${WANTS_PERCENT*100}%)`,
                resultSavings: `Savings & Investment (Target ${SAVINGS_PERCENT*100}%)`,
                resultRemaining: "Remaining/Deficit Fund",
                
                summaryTitle_Good: "Status: Healthy and Efficient Budget",
                summaryTitle_Warning: "Status: Category Adjustment Needed",
                summaryTitle_Danger: "Status: Budget at Risk of Deficit",

                summaryText_Good: (surplus, needsP, wantsP, savingsP) => `Your budget is excellent. All categories (Needs: ${needsP}%, Wants: ${wantsP}%, Savings: ${savingsP}%) are close to the 50/30/20 guideline and you have a surplus of ${surplus}. Keep up the great management!`,
                summaryText_Warning: (needsP, wantsP) => `There is a significant deviation from the 50/30/20 guideline. Your Needs (${needsP}%) and/or Wants (${wantsP}%) exceed the ideal limits. Prioritize reducing Wants spending to increase Savings allocation.`,
                summaryText_Danger: (deficit, totalP) => `Warning: Total expenses (${totalP}%) exceed income. You have a monthly deficit of ${deficit}. Conduct a total review and immediately reduce non-essential Wants and Needs spending.`,

                errorInput: "Please enter all valid values and ensure Net Income > 0.",
                
                sectionHeader1: "What is the 50/30/20 Method?",
                content1: "The 50/30/20 method is an easy budgeting rule popularized by US Senator Elizabeth Warren. Its goal is to ensure a balanced allocation of funds, where no category exceeds the suggested limit, allowing you to save for the future without feeling overly restricted.",
                sectionHeader2: "The Importance of Compliance",
                content2: "Adherence to these percentages is key. If your Needs spending exceeds 50%, it may signal that your cost of living is too high relative to your income, requiring a review (e.g., finding cheaper housing). Wants budgets exceeding 30% mean you are prioritizing instant gratification over future financial security.",
                
                footerPrivacy: "Privacy Policy",
                footerTerms: "Terms of Service",
                footerAbout: "About Us",
                footerContact: "Contact Us",
                footerDev: "Developed by DTID Analytics.",
            }
        };

        let currentLang = 'id';
        const resultBox = document.getElementById('resultBox');
        const errorAlert = document.getElementById('errorAlert');
        const errorText = document.getElementById('errorText');

        // --- FUNGSI FORMAT ANGKA ---
        function cleanInput(formattedValue) {
            if (typeof formattedValue !== 'string') return formattedValue;
            let cleaned = formattedValue.replace(/\D/g, '');
            return parseFloat(cleaned) || 0;
        }

        function formatNumber(num) {
            return num.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).replace('IDR', 'Rp').trim();
        }

        function formatInput(inputElement) {
            let value = inputElement.value;
            let numericValue = value.replace(/[^0-9]/g, '');
            if (numericValue.length === 0) {
                inputElement.value = '';
                return;
            }
            let number = parseInt(numericValue, 10);
            inputElement.value = number.toLocaleString(currentLang === 'id' ? 'id-ID' : 'en-US', {
                maximumFractionDigits: 0,
                minimumFractionDigits: 0
            });
        }

        // --- CORE LOGIC ---
        function calculateBudget(event) {
            event.preventDefault();
            const t = translations[currentLang];
            
            const monthlyIncome = cleanInput(document.getElementById('monthlyIncome').value);
            const needsSpending = cleanInput(document.getElementById('needsSpending').value);
            const wantsSpending = cleanInput(document.getElementById('wantsSpending').value);
            const savingsInvestment = cleanInput(document.getElementById('savingsInvestment').value);

            if (monthlyIncome <= 0 || isNaN(monthlyIncome) || isNaN(needsSpending) || isNaN(wantsSpending) || isNaN(savingsInvestment)) {
                errorText.textContent = t.errorInput;
                errorAlert.classList.remove('hidden');
                resultBox.classList.remove('visible');
                return;
            }
            
            errorAlert.classList.add('hidden');

            const totalSpending = needsSpending + wantsSpending + savingsInvestment;
            const remaining = monthlyIncome - totalSpending;
            
            const needsP = (needsSpending / monthlyIncome) * 100;
            const wantsP = (wantsSpending / monthlyIncome) * 100;
            const savingsP = (savingsInvestment / monthlyIncome) * 100;
            const totalP = (totalSpending / monthlyIncome) * 100;
            
            let summaryTitleKey;
            let summaryText;
            let summaryBgClass;
            
            if (remaining < 0) {
                summaryTitleKey = 'summaryTitle_Danger';
                summaryBgClass = 'bg-red-50 border-red-200 text-red-800';
                summaryText = t.summaryText_Danger(formatNumber(Math.abs(remaining)), totalP.toFixed(1));
            } else if (needsP > (NEEDS_PERCENT * 100) * 1.05 || wantsP > (WANTS_PERCENT * 100) * 1.05) {
                summaryTitleKey = 'summaryTitle_Warning';
                summaryBgClass = 'bg-yellow-50 border-yellow-200 text-yellow-800';
                summaryText = t.summaryText_Warning(needsP.toFixed(1), wantsP.toFixed(1));
            } else {
                summaryTitleKey = 'summaryTitle_Good';
                summaryBgClass = 'bg-green-50 border-green-200 text-green-800';
                summaryText = t.summaryText_Good(formatNumber(remaining), needsP.toFixed(1), wantsP.toFixed(1), savingsP.toFixed(1));
            }

            document.getElementById('summaryTitle').textContent = t[summaryTitleKey];
            document.getElementById('summaryText').innerHTML = summaryText;
            document.getElementById('resultSummaryText').className = `p-4 rounded-lg mb-4 border transition-colors duration-300 ${summaryBgClass}`;

            document.getElementById('needsResult').innerHTML = `${formatNumber(needsSpending)} <span class="text-xs text-gray-500 font-normal">(${needsP.toFixed(1)}%)</span>`;
            document.getElementById('wantsResult').innerHTML = `${formatNumber(wantsSpending)} <span class="text-xs text-gray-500 font-normal">(${wantsP.toFixed(1)}%)</span>`;
            document.getElementById('savingsResult').innerHTML = `${formatNumber(savingsInvestment)} <span class="text-xs text-gray-500 font-normal">(${savingsP.toFixed(1)}%)</span>`;
            
            const remainingEl = document.getElementById('remainingResult');
            remainingEl.textContent = formatNumber(remaining);
            remainingEl.className = `text-xl font-extrabold ${remaining >= 0 ? 'text-green-600' : 'text-red-600'}`;

            // Update Chart
            const totalWidth = totalSpending > monthlyIncome ? totalSpending : monthlyIncome;
            const needsWidth = (needsSpending / totalWidth) * 100;
            const wantsWidth = (wantsSpending / totalWidth) * 100;
            const savingsWidth = (savingsInvestment / totalWidth) * 100;
            
            document.getElementById('barNeeds').style.width = `${needsWidth}%`;
            document.getElementById('barWants').style.width = `${wantsWidth}%`;
            document.getElementById('barSavings').style.width = `${savingsWidth}%`;
            
            let remainingWidth = 100 - (needsWidth + wantsWidth + savingsWidth);
            if (remainingWidth < 0) remainingWidth = 0;
            document.getElementById('barRemaining').style.width = `${remainingWidth}%`;

            document.getElementById('barLegend').textContent = remaining >= 0 ?
                `${t.resultRemaining.split('/')[0]} ${formatNumber(remaining)}` : `${t.resultRemaining.split('/')[1]} ${formatNumber(Math.abs(remaining))}`;
            
            resultBox.classList.add('visible');
        }

        // --- FUNGSI TRANSLATE & OBSERVER ---
        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            const languageSwitcher = document.getElementById('languageSwitcher');
            if(languageSwitcher) {
                languageSwitcher.classList.remove('lang-en', 'lang-id');
                languageSwitcher.classList.add(`lang-${lang}`);
            }

            const backBtn = document.getElementById('backToCatalogText');
            if(backBtn) backBtn.textContent = t.backToCatalogText;

            if(document.getElementById('footerPrivacy')) {
                document.getElementById('footerPrivacy').textContent = t.footerPrivacy;
                document.getElementById('footerTerms').textContent = t.footerTerms;
                document.getElementById('footerAbout').textContent = t.footerAbout;
                document.getElementById('footerContact').textContent = t.footerContact;
                const devSpan = document.getElementById('footerDev');
                if(devSpan) devSpan.textContent = t.footerDev;
            }

            // Update Text Content Elements
            const elements = [
                'appTitle', 'headerTitle', 'sectionIncomeHeader', 'labelMonthlyIncome', 'descMonthlyIncome',
                'sectionSpendingHeader', 'labelNeedsSpending', 'descNeedsSpending', 
                'labelWantsSpending', 'descWantsSpending', 'labelSavingsInvestment', 'descSavingsInvestment',
                'calculateButton', 'resultTitle', 'visualHeader', 'metricsHeader',
                'resultNeeds', 'resultWants', 'resultSavings', 'resultRemaining',
                'sectionHeader1', 'content1', 'sectionHeader2', 'content2'
            ];

            elements.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.textContent = t[id];
            });

            // HTML Content Elements
            document.getElementById('toolSubtitle').innerHTML = t.toolSubtitle;
            document.getElementById('content1').innerHTML = t.content1;
            document.getElementById('content2').innerHTML = t.content2;

            // Re-format inputs
            ['monthlyIncome', 'needsSpending', 'wantsSpending', 'savingsInvestment'].forEach(id => {
                const input = document.getElementById(id);
                if (input.value) {
                    input.value = cleanInput(input.value).toLocaleString(lang === 'id' ? 'id-ID' : 'en-US', {
                        maximumFractionDigits: 0,
                        minimumFractionDigits: 0
                    });
                }
            });

            // Update Related Tools text
            updateRelatedContent(lang);
        }

        function updateRelatedContent(lang) {
            const translatableElements = document.querySelectorAll('#related-tools-section [data-en]');
            translatableElements.forEach(el => {
                const newText = el.getAttribute(`data-${lang}`);
                if (newText) el.textContent = newText;
            });
        }

        // Theme Manager
        function applyDynamicTheme() {
            const category = window.headerCategory || 'finance';
            const themes = {
                finance: {
                    bg: 'bg-green-600',
                    text: 'text-green-600',
                    border: 'hover:border-green-400',
                    hoverText: 'group-hover:text-green-700',
                    bgGroup: 'group-hover:bg-green-500'
                }
            };
            const theme = themes[category];
            document.querySelectorAll('.dynamic-bg').forEach(el => el.classList.add(theme.bg));
            document.querySelectorAll('.dynamic-text').forEach(el => el.classList.add(theme.text));
            document.querySelectorAll('.dynamic-border').forEach(el => el.classList.add(theme.border));
            document.querySelectorAll('.dynamic-hover-text').forEach(el => el.classList.add(theme.hoverText));
            document.querySelectorAll('.dynamic-bg-group').forEach(el => el.classList.add(theme.bgGroup));
        }

        // --- OBSERVER & INIT ---
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'lang') {
                    const currentLang = document.documentElement.lang || 'en';
                    setLanguage(currentLang);
                }
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            observer.observe(document.documentElement, { attributes: true });
            
            applyDynamicTheme();
            
            // Format awal input
            ['monthlyIncome', 'needsSpending', 'wantsSpending', 'savingsInvestment'].forEach(id => {
                const input = document.getElementById(id);
                if (input.value) {
                    input.value = cleanInput(input.value).toLocaleString('id-ID', { maximumFractionDigits: 0 });
                }
            });

            // Init language check
            const initialLang = document.documentElement.lang || 'id';
            setLanguage(initialLang);
        });

    </script>
</body>
</html>