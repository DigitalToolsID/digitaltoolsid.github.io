<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../output.css">

    <link rel="canonical" href="https://digitaltoolsid.github.io/kalkulator-pph-detil/" />
    
    <meta name="description" content="Detailed Indonesia Income Tax (PPh 21) Calculator. Calculate monthly and annual tax with a complete breakdown of progressive tax layers (UU HPP).">
    <meta name="keywords" content="Income Tax Calculator Indonesia, Tax Bracket Calculator, PPh 21 Detailed, Kalkulator PPh 21 Detil, Hitung Pajak Progresif, Lapisan Tarif Pajak, Simulasi PPh Lengkap, how to calculate tax tiers, cara hitung detail pajak penghasilan">
 
    <link rel="icon" href="data:,">

    <title id="appTitle">Indonesia Income Tax Calculator (Detailed)</title>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M8E7QRYNY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7M8E7QRYNY');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4885884866232864" crossorigin="anonymous"></script>
    
    <style>
        /* STANDAR TAMPILAN: Hard Lock 50% untuk Desktop */
        @media (min-width: 1024px) {
            .layout-article-fixed {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 50% !important;
                margin-left: auto;
                margin-right: auto;
            }
        }

        /* CSS LOKAL */
        .result-box {
            transition: all 0.5s ease-in-out;
            transform-origin: top center;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }
        .result-box.visible {
            opacity: 1;
            max-height: 2000px; 
            padding: 1.5rem; 
        }
        
        /* TOMBOL HIJAU FINANCE */
        .calculate-button {
            background-color: #16a34a !important; /* Green-600 */
            color: white !important;
            box-shadow: 0 4px #14532d;
            transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s;
        }
        .calculate-button:hover {
            background-color: #15803d !important; /* Green-700 */
            transform: translateY(-2px);
            box-shadow: 0 6px #14532d;
        }
        .calculate-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #14532d;
        }

        .input-description {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <script>window.headerCategory = 'finance';</script>
    <div id="global-header-container"></div>

    <main class="flex-grow p-4 sm:p-8 flex flex-col items-center">
        <div class="w-full layout-article-fixed bg-white shadow-xl rounded-xl p-6 sm:p-8">
            
            <h1 id="headerTitle" class="text-3xl font-extrabold text-green-700 mb-3 text-center">Indonesia PPh 21 Calculator (Detailed)</h1>
            
            <p id="toolSubtitle" class="text-sm text-gray-700 font-medium mb-6 leading-relaxed text-justify">
               Calculate your estimated monthly and annual income tax with a detailed breakdown of progressive tax layers (UU HPP).
            </p>
            
            <form id="taxForm" onsubmit="calculateTax(event)" class="space-y-6">
                
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h2 class="text-lg font-bold mb-4 text-green-800" id="headerIncome">1. Income Details</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="relative">
                            <label for="monthlySalary" class="block text-sm font-medium text-gray-700 mb-1" id="labelMonthlySalary">Monthly Gross Salary</label>
                            <input type="text" id="monthlySalary" inputmode="numeric" placeholder="e.g. 15,000,000" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150" required>
                            <p class="input-description" id="descMonthlySalary">Basic salary + fixed allowances.</p>
                        </div>
                        
                        <div class="relative">
                            <label for="otherIncome" class="block text-sm font-medium text-gray-700 mb-1" id="labelOtherIncome">Other Monthly Allowance</label>
                            <input type="text" id="otherIncome" inputmode="numeric" value="0" oninput="formatInput(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150">
                            <p class="input-description" id="descOtherIncome">Meal/Transport/Overtime (Average).</p>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h2 class="text-lg font-bold mb-4 text-green-800" id="headerStatus">2. Tax Relief Status (PTKP)</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="relative">
                            <label for="ptkpStatus" class="block text-sm font-medium text-gray-700 mb-1" id="labelPtkp">Marital Status</label>
                            <select id="ptkpStatus" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 bg-white transition duration-150">
                                <option value="54000000">TK/0 - Single, 0 Dep</option>
                                <option value="58500000">TK/1 - Single, 1 Dep</option>
                                <option value="63000000">TK/2 - Single, 2 Dep</option>
                                <option value="67500000">TK/3 - Single, 3 Dep</option>
                                <option value="58500000">K/0 - Married, 0 Dep</option>
                                <option value="63000000">K/1 - Married, 1 Dep</option>
                                <option value="67500000">K/2 - Married, 2 Dep</option>
                                <option value="72000000">K/3 - Married, 3 Dep</option>
                            </select>
                        </div>
                        <div class="relative">
                            <label for="hasNPWP" class="block text-sm font-medium text-gray-700 mb-1" id="labelNpwp">Have NPWP?</label>
                            <select id="hasNPWP" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 bg-white transition duration-150">
                                <option value="yes">Yes (Have NPWP)</option>
                                <option value="no">No (Non-NPWP +20%)</option>
                            </select>
                            <p class="input-description" id="descNpwp">+20% rate if No.</p>
                        </div>
                    </div>
                </div>

                <button type="submit" id="calculateButton" class="calculate-button w-full font-semibold py-3 rounded-xl focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                    Calculate Tax Breakdown
                </button>
            </form>

            <div id="resultBox" class="result-box mt-8 bg-white border border-gray-200 rounded-xl shadow-lg">
                
                <div class="p-6 bg-red-50 border-b border-red-200 rounded-t-xl text-center">
                    <p class="text-sm font-bold text-gray-600 uppercase tracking-wider" id="labelMonthlyTax">Estimated Monthly Tax (PPh 21)</p>
                    <p id="resultMonthlyTax" class="text-4xl font-extrabold text-red-600 mt-2">0</p>
                    <p class="text-sm text-gray-600 mt-2" id="labelTakeHome"></p>
                </div>

                <div class="p-6">
                    <h4 id="detailHeader" class="text-lg font-bold text-gray-800 mb-4">Detailed Calculation (Annual)</h4>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between border-b border-dashed border-gray-300 pb-2">
                            <span class="text-gray-600" id="labelGrossAnnual">Gross Annual Income</span>
                            <span class="font-semibold" id="valGrossAnnual">0</span>
                        </div>
                        <div class="flex justify-between border-b border-dashed border-gray-300 pb-2">
                            <span class="text-gray-600" id="labelOccCost">Occupational Cost (5%)</span>
                            <span class="text-red-500" id="valOccCost">0</span>
                        </div>
                        <div class="flex justify-between border-b border-dashed border-gray-300 pb-2 font-bold bg-gray-50 p-1 rounded">
                            <span class="text-gray-800" id="labelNetAnnual">Net Annual Income</span>
                            <span id="valNetAnnual">0</span>
                        </div>
                        <div class="flex justify-between border-b border-dashed border-gray-300 pb-2">
                            <span class="text-gray-600" id="labelPTKPVal">PTKP (Non-Taxable)</span>
                            <span class="text-green-600" id="valPTKP">0</span>
                        </div>
                        <div class="flex justify-between border-b border-gray-300 pb-2 font-bold text-base">
                            <span class="text-gray-800" id="labelPKP">Taxable Income (PKP)</span>
                            <span id="valPKP">0</span>
                        </div>
                    </div>

                    <h5 class="text-sm font-bold text-gray-700 mt-6 mb-2" id="labelLayers">Progressive Tax Layers:</h5>
                    <div id="taxLayersList" class="space-y-1 text-xs text-gray-600 bg-gray-50 p-3 rounded border border-gray-200">
                        </div>
                    
                    <div class="flex justify-between items-center mt-4 pt-4 border-t-2 border-gray-200">
                        <span class="font-bold text-gray-800" id="labelTotalAnnualTax">Total Annual Tax</span>
                        <span class="font-extrabold text-xl text-red-600" id="valTotalAnnualTax">0</span>
                    </div>
                </div>
            </div>
            
            <section class="mt-8 pt-4 border-t border-gray-200 font-sans">
                <h2 id="sectionHeader1" class="text-xl font-bold text-gray-800 mb-3">Understanding the Progressive Tax</h2>
                <p id="content1" class="text-gray-600 text-sm leading-relaxed text-justify mb-4"></p>
                <h3 id="sectionHeader2" class="text-lg font-bold text-gray-800 mb-2">Disclaimer</h3>
                
                <div class="bg-gray-50 border-l-4 border-gray-400 text-gray-700 p-4 rounded-lg text-sm leading-relaxed text-justify mb-4" id="content2"></div>
            </section>

        </div>
    </main>

    <section id="related-tools-section" class="layout-article-fixed w-full px-4 py-8 mb-4">
        <div class="flex items-center mb-5">
            <div class="w-1 h-7 mr-3 bg-green-600 dynamic-bg"></div> 
            <h2 class="text-xl font-bold text-gray-800" 
                data-en="Investment & Finance Tools" 
                data-id="Alat Investasi & Keuangan">
                Investment & Finance Tools
            </h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
            <a href="../kalkulator-pph/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Simple PPh Calculator"
                    data-id="Kalkulator PPh Simpel">
                    Simple PPh Calculator
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Quick employee/freelancer tax check."
                    data-id="Cek pajak karyawan/freelancer cepat.">
                    Quick employee/freelancer tax check.
                </p>
            </a>
            <a href="../kalkulator-konversi-gaji/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Salary Converter"
                    data-id="Konversi Gaji">
                    Salary Converter
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Hourly to monthly/annual salary."
                    data-id="Gaji per jam ke bulanan/tahunan.">
                    Hourly to monthly/annual salary.
                </p>
            </a>
            <a href="../kalkulator-anggaran-bulanan/index.html" class="tool-card group block p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 hover:border-green-400">
                <h3 class="text-base font-bold mb-1 text-green-700 group-hover:text-green-800 dynamic-text"
                    data-en="Budget Planner"
                    data-id="Perencana Anggaran">
                    Budget Planner
                </h3>
                <p class="text-xs text-gray-600 leading-relaxed"
                    data-en="Plan your monthly spending."
                    data-id="Rencanakan pengeluaran bulanan.">
                    Plan your monthly spending.
                </p>
            </a>
        </div>

        <div class="border-t border-gray-100 pt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4" 
                data-en="Related Articles:" 
                data-id="Artikel Terkait:">
                Related Articles:
            </h3>
            <ul class="space-y-3">
                <li>
                    <a href="../articles/klausul-perpajakan-kontrak.html" class="flex items-center text-sm hover:underline group text-blue-600 hover:text-blue-800">
                        <span class="w-1.5 h-1.5 bg-gray-300 rounded-full mr-3 dynamic-bg-group"></span>
                        <span data-en="Understanding Tax Clauses in Contracts" 
                              data-id="Memahami Klausul Perpajakan dalam Kontrak">
                            Understanding Tax Clauses in Contracts
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </section>

    <div id="global-footer-container"></div>
    <script src="../components.js"></script>
    
    <script>
        // **********************************************
        // LOGIKA KALKULATOR PPH 21 DETIL
        // **********************************************

        let currentLang = 'en';

        const PajakConfig = {
            PTKP: {
                // Sesuai PMK 2025/UU HPP
                TK0: 54000000,
                TK1: 58500000,
                TK2: 63000000,
                TK3: 67500000,
                K0: 58500000,
                K1: 63000000,
                K2: 67500000,
                K3: 72000000,
            },
            TARIF_PROGRESIF: [
                { limit: 60000000, rate: 0.05 },    
                { limit: 250000000, rate: 0.15 },   
                { limit: 500000000, rate: 0.25 },   
                { limit: 5000000000, rate: 0.30 },  
                { limit: Infinity, rate: 0.35 }     
            ],
            PENGURANG_KARYAWAN: {
                JABATAN_RATE: 0.05,
                JABATAN_MAX_ANNUAL: 6000000,
            }
        };

        const translations = {
            id: {
                appTitle: "Kalkulator PPh 21 Detil",
                headerTitle: "Kalkulator PPh 21 Indonesia (Detil)",
                toolSubtitle: "Hitung estimasi pajak penghasilan bulanan dan tahunan Anda dengan rincian lapisan tarif pajak progresif sesuai peraturan terbaru (UU HPP).",
                backToCatalogText: "Kembali ke Katalog Alat",
                headerIncome: "1. Rincian Penghasilan",
                labelMonthlySalary: "Gaji Pokok Bulanan (Bruto)",
                descMonthlySalary: "Gaji kotor sebulan sebelum potongan, termasuk tunjangan tetap.",
                labelOtherIncome: "Tunjangan Tidak Tetap/Lainnya",
                descOtherIncome: "Rata-rata tunjangan makan, transport, atau lembur per bulan.",
                
                headerStatus: "2. Status Pajak (PTKP)",
                labelPtkp: "Status Perkawinan",
                labelNpwp: "Memiliki NPWP?",
                descNpwp: "Jika 'Tidak', tarif pajak akan dikenakan 20% lebih tinggi.",
                calculateButton: "Hitung Rincian Pajak",
                inputError: "Mohon masukkan nilai gaji yang valid.",
                
                resultHeader: "Hasil Perhitungan Pajak",
                labelMonthlyTax: "Estimasi PPh 21 Bulanan",
                labelTakeHome: "Gaji Bersih (Take Home Pay): ",
                
                detailHeader: "Rincian Perhitungan (Tahunan)",
                labelGrossAnnual: "Penghasilan Bruto Setahun",
                labelOccCost: "Biaya Jabatan (Maks 6 Jt/th)",
                labelNetAnnual: "Penghasilan Netto Setahun",
                labelPTKPVal: "PTKP (Penghasilan Tidak Kena Pajak)",
                labelPKP: "PKP (Penghasilan Kena Pajak)",
                labelLayers: "Rincian Lapisan Tarif (Layer):",
                labelTotalAnnualTax: "Total PPh 21 Terutang Setahun",
                
                sectionHeader1: "Memahami Pajak Progresif",
                content1: "Indonesia menggunakan sistem tarif pajak progresif. Artinya, penghasilan Anda tidak dikalikan dengan satu tarif tunggal, melainkan dipecah ke dalam beberapa lapisan. Semakin tinggi penghasilan, semakin tinggi tarif yang dikenakan pada lapisan tersebut.",
                sectionHeader2: "Disclaimer",
                content2: "Kalkulator ini menggunakan metode perhitungan disetahunkan (annualized) untuk memberikan estimasi. Perhitungan real oleh HRD mungkin menggunakan metode TER (Tarif Efektif Rata-rata) untuk potongan bulanan, namun total setahun akan disesuaikan kembali di akhir tahun.",
                
                linkPrivacy: "Kebijakan Privasi",
                linkTerms: "Ketentuan Layanan",
                linkAbout: "Tentang Kami",
                linkContact: "Hubungi Kami",
                footerCopyright: "&copy; 2025 Digital Tools ID. Semua hak dilindungi."
            },
            en: {
                appTitle: "Detailed Income Tax Calculator",
                headerTitle: "Indonesia PPh 21 Calculator (Detailed)",
                toolSubtitle: "Calculate your estimated monthly and annual income tax with a detailed breakdown of progressive tax layers (UU HPP).",
                backToCatalogText: "Back to Tools Catalog",
                headerIncome: "1. Income Details",
                labelMonthlySalary: "Monthly Gross Salary",
                descMonthlySalary: "Gross monthly salary before deductions, including fixed allowances.",
                labelOtherIncome: "Other Monthly Allowances",
                descOtherIncome: "Average monthly meal, transport, or overtime allowances.",
                
                headerStatus: "2. Tax Status (PTKP)",
                labelPtkp: "Marital Status",
                labelNpwp: "Have NPWP?",
                descNpwp: "If 'No', a 20% surcharge is applied.",
                calculateButton: "Calculate Tax Breakdown",
                inputError: "Please enter a valid salary amount.",
                
                resultHeader: "Tax Calculation Result",
                labelMonthlyTax: "Estimated Monthly Tax (PPh 21)",
                labelTakeHome: "Net Take Home Pay: ",
                
                detailHeader: "Calculation Breakdown (Annual)",
                labelGrossAnnual: "Gross Annual Income",
                labelOccCost: "Occupational Cost (Max 6M/yr)",
                labelNetAnnual: "Net Annual Income",
                labelPTKPVal: "PTKP (Non-Taxable Income)",
                labelPKP: "PKP (Taxable Income)",
                labelTotalAnnualTax: "Total Annual Tax Payable",
                
                sectionHeader1: "Understanding Progressive Tax",
                content1: "Indonesia uses a progressive tax rate system. This means your income isn't taxed at a single rate but is split into layers. The higher the income, the higher the rate applied to that specific layer.",
                sectionHeader2: "Disclaimer",
                content2: "This calculator uses the annualized calculation method for estimation. Actual payroll calculations might use the TER (Average Effective Rate) method for monthly withholding, but the annual total will be adjusted at year-end.",

                linkPrivacy: "Privacy Policy",
                linkTerms: "Terms of Service",
                linkAbout: "About Us",
                linkContact: "Contact Us",
                footerCopyright: "&copy; 2025 Digital Tools ID. All rights reserved."
            }
        };

        function formatNumber(amount) {
            if (typeof amount !== 'number') return '0';
            const locale = 'id-ID'; 
            return new Intl.NumberFormat(locale, {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
            }).format(Math.round(amount));
        }

        function formatInput(inputElement) {
            let rawValue = inputElement.value.replace(/\D/g, ''); 
            if (rawValue) {
                const numericValue = parseInt(rawValue, 10);
                inputElement.value = formatNumber(numericValue);
            } else {
                inputElement.value = ''; 
            }
        }
        
        function cleanInput(formattedValue) {
            return parseFloat(formattedValue.replace(/\D/g, '')) || 0;
        }

        function calculateTax(event) {
            event.preventDefault();
            const monthlySalary = cleanInput(document.getElementById('monthlySalary').value);
            const otherIncome = cleanInput(document.getElementById('otherIncome').value);
            const ptkpVal = parseInt(document.getElementById('ptkpStatus').value);
            const hasNPWP = document.getElementById('hasNPWP').value === 'yes';

            if (monthlySalary <= 0) {
                alert(translations[currentLang].inputError);
                return;
            }

            // Annualize
            const grossMonthly = monthlySalary + otherIncome;
            const grossAnnual = grossMonthly * 12;
            
            // Biaya Jabatan
            let occupationalCost = grossAnnual * PajakConfig.PENGURANG_KARYAWAN.JABATAN_RATE;
            if (occupationalCost > PajakConfig.PENGURANG_KARYAWAN.JABATAN_MAX_ANNUAL) {
                occupationalCost = PajakConfig.PENGURANG_KARYAWAN.JABATAN_MAX_ANNUAL;
            }

            const netAnnual = grossAnnual - occupationalCost;
            let pkp = netAnnual - ptkpVal;
            // Round down to thousands
            pkp = Math.floor(pkp / 1000) * 1000;
            
            let annualTax = 0;
            let taxLayersHtml = '';
            
            if (pkp <= 0) {
                pkp = 0;
                taxLayersHtml = `<div class="flex justify-between"><span>No Taxable Income</span><span>0</span></div>`;
            } else {
                let remainingPKP = pkp;
                let prevLimit = 0;

                for (const layer of PajakConfig.TARIF_PROGRESIF) {
                    if (remainingPKP <= 0) break;
                    
                    const rangeAmount = layer.limit - prevLimit;
                    const taxableAtLayer = Math.min(remainingPKP, (layer.limit === Infinity ? remainingPKP : rangeAmount));
                    
                    const taxAtLayer = taxableAtLayer * layer.rate;
                    annualTax += taxAtLayer;
                    remainingPKP -= taxableAtLayer;
                    prevLimit = layer.limit;

                    const rateDisplay = (layer.rate * 100) + '%';
                    taxLayersHtml += `
                        <div class="flex justify-between border-b border-gray-200 pb-1 last:border-0">
                            <span>Layer ${rateDisplay} x ${formatNumber(taxableAtLayer)}</span>
                            <span>${formatNumber(taxAtLayer)}</span>
                        </div>
                    `;
                }
            }

            if (!hasNPWP) {
                const surcharge = annualTax * 0.20;
                annualTax += surcharge;
                taxLayersHtml += `
                    <div class="flex justify-between text-red-600 font-bold mt-1">
                        <span>Non-NPWP Surcharge (+20%)</span>
                        <span>${formatNumber(surcharge)}</span>
                    </div>
                `;
            }

            const monthlyTax = annualTax / 12;
            const takeHomePay = grossMonthly - monthlyTax;

            // Render
            document.getElementById('resultMonthlyTax').textContent = formatNumber(monthlyTax);
            
            // Labels updates
            const takeHomeVal = formatNumber(takeHomePay);
            const t = translations[currentLang];
            document.getElementById('labelTakeHome').innerHTML = `${t.labelTakeHome} <span class="font-bold text-green-700 text-lg">${takeHomeVal}</span>`;

            document.getElementById('valGrossAnnual').textContent = formatNumber(grossAnnual);
            document.getElementById('valOccCost').textContent = `(${formatNumber(occupationalCost)})`;
            document.getElementById('valNetAnnual').textContent = formatNumber(netAnnual);
            document.getElementById('valPTKP').textContent = `(${formatNumber(ptkpVal)})`;
            document.getElementById('valPKP').textContent = formatNumber(pkp);
            document.getElementById('valTotalAnnualTax').textContent = formatNumber(annualTax);
            
            document.getElementById('taxLayersList').innerHTML = taxLayersHtml;

            document.getElementById('resultBox').classList.add('visible');
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            const backBtn = document.getElementById('backToCatalogText');
            if(backBtn) backBtn.textContent = t.backToCatalogText;

            ['appTitle', 'headerTitle', 'toolSubtitle', 'headerIncome', 'labelMonthlySalary', 'descMonthlySalary', 
             'labelOtherIncome', 'descOtherIncome', 'headerStatus', 'labelPtkp', 'labelNpwp', 'descNpwp', 
             'calculateButton', 'resultHeader', 'labelMonthlyTax', 'detailHeader', 'labelGrossAnnual', 
             'labelOccCost', 'labelNetAnnual', 'labelPTKPVal', 'labelPKP', 'labelLayers', 'labelTotalAnnualTax',
             'sectionHeader1', 'content1', 'sectionHeader2'].forEach(id => {
                 const el = document.getElementById(id);
                 if(el) el.innerHTML = t[id]; 
            });
            
            // Handle disclaimer separately
            if(document.getElementById('content2')) {
                document.getElementById('content2').innerHTML = t.content2;
            }

            // Update footer safely
            if(document.getElementById('linkPrivacy')) document.getElementById('linkPrivacy').textContent = t.linkPrivacy;
            if(document.getElementById('linkTerms')) document.getElementById('linkTerms').textContent = t.linkTerms;
            if(document.getElementById('linkAbout')) document.getElementById('linkAbout').textContent = t.linkAbout;
            if(document.getElementById('linkContact')) document.getElementById('linkContact').textContent = t.linkContact;
            if(document.getElementById('footerCopyright')) document.getElementById('footerCopyright').innerHTML = t.footerCopyright;

            // Handle Label Take Home text base
            if(!document.getElementById('resultBox').classList.contains('visible')) {
                 document.getElementById('labelTakeHome').textContent = t.labelTakeHome;
            } else {
                 const takeHomeVal = document.getElementById('resultTakeHome') ? document.getElementById('resultTakeHome').textContent : '0';
                 document.getElementById('labelTakeHome').innerHTML = `${t.labelTakeHome} <span id="resultTakeHome" class="font-bold text-green-700 text-lg">${takeHomeVal}</span>`;
            }

            // Re-format Inputs 
            const salaryInput = document.getElementById('monthlySalary');
            const otherInput = document.getElementById('otherIncome');
            if(salaryInput.value) formatInput(salaryInput);
            if(otherInput.value) formatInput(otherInput);
            
            if(document.getElementById('resultBox').classList.contains('visible')){
                calculateTax({preventDefault:()=>{}});
            }
            updateRelatedContent(lang);
        }

        function updateRelatedContent(lang) {
            const translatableElements = document.querySelectorAll('#related-tools-section [data-en]');
            translatableElements.forEach(el => {
                const newText = el.getAttribute(`data-${lang}`);
                if (newText) {
                    el.textContent = newText;
                }
            });
        }

        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'lang') {
                    const currentLang = document.documentElement.lang || 'en';
                    setLanguage(currentLang);
                }
            });
        });
        observer.observe(document.documentElement, { attributes: true });

        document.addEventListener('DOMContentLoaded', () => {
            setLanguage('en'); 
        });
    </script>
</body>
</html>